{"ast":null,"code":"import _objectSpread from\"/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/components/NotificationBell.jsx\nimport React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const NotificationBell=()=>{const[notifications,setNotifications]=useState([]);const[unreadCount,setUnreadCount]=useState(0);const[showDropdown,setShowDropdown]=useState(false);const navigate=useNavigate();useEffect(()=>{const fetchNotifications=async()=>{try{const res=await fetch('/api/notifications',{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});if(!res.ok)throw new Error('Failed to fetch notifications');const data=await res.json();setNotifications(data);setUnreadCount(data.filter(n=>!n.read).length);}catch(err){console.error('ðŸ”” Error loading notifications:',err);}};fetchNotifications();},[]);const handleBellClick=()=>{setShowDropdown(!showDropdown);};const markAllAsRead=async()=>{try{await fetch('/api/notifications/mark-all-read',{method:'POST',headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});setNotifications(prev=>prev.map(n=>_objectSpread(_objectSpread({},n),{},{read:true})));setUnreadCount(0);}catch(err){console.error('Failed to mark notifications as read',err);}};const getIcon=type=>{switch(type){case'message':return'ðŸ’¬';case'offer':return'ðŸ’°';case'contract':return'ðŸ“„';default:return'ðŸ””';}};const formatTimestamp=timestamp=>{const date=new Date(timestamp);return date.toLocaleString();};return/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative'},children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleBellClick,style:{fontSize:'1.25rem',position:'relative'},children:[\"\\uD83D\\uDD14\",unreadCount>0&&/*#__PURE__*/_jsx(\"span\",{style:{position:'absolute',top:'-6px',right:'-6px',backgroundColor:'red',color:'white',borderRadius:'50%',padding:'2px 6px',fontSize:'0.75rem',fontWeight:'bold'},children:unreadCount})]}),showDropdown&&/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',right:0,top:'2.5rem',background:'#fff',border:'1px solid #ccc',borderRadius:'4px',width:'320px',boxShadow:'0 2px 6px rgba(0,0,0,0.1)',zIndex:1000},children:[/*#__PURE__*/_jsxs(\"div\",{style:{padding:'0.5rem',borderBottom:'1px solid #eee'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Notifications\"}),/*#__PURE__*/_jsx(\"button\",{onClick:markAllAsRead,style:{float:'right',fontSize:'0.75rem'},children:\"Mark all as read\"})]}),notifications.length===0?/*#__PURE__*/_jsx(\"div\",{style:{padding:'1rem'},children:\"No notifications\"}):notifications.map((n,i)=>/*#__PURE__*/_jsxs(\"div\",{style:{padding:'0.75rem 1rem',backgroundColor:n.read?'#f9f9f9':'#e6f7ff',borderBottom:'1px solid #eee',cursor:'pointer'},onClick:()=>navigate(\"/loan/\".concat(n.loanId)),children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{marginRight:'0.5rem'},children:getIcon(n.type)}),n.message]}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'0.75rem',color:'#666'},children:formatTimestamp(n.createdAt)})]},i))]})]});};export default NotificationBell;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","jsx","_jsx","jsxs","_jsxs","NotificationBell","notifications","setNotifications","unreadCount","setUnreadCount","showDropdown","setShowDropdown","navigate","fetchNotifications","res","fetch","headers","Authorization","concat","localStorage","getItem","ok","Error","data","json","filter","n","read","length","err","console","error","handleBellClick","markAllAsRead","method","prev","map","_objectSpread","getIcon","type","formatTimestamp","timestamp","date","Date","toLocaleString","style","position","children","onClick","fontSize","top","right","backgroundColor","color","borderRadius","padding","fontWeight","background","border","width","boxShadow","zIndex","borderBottom","float","i","cursor","loanId","marginRight","message","createdAt"],"sources":["/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/components/NotificationBell.jsx"],"sourcesContent":["// src/components/NotificationBell.jsx\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst NotificationBell = () => {\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n  const [showDropdown, setShowDropdown] = useState(false);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchNotifications = async () => {\r\n      try {\r\n        const res = await fetch('/api/notifications', {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n          },\r\n        });\r\n        if (!res.ok) throw new Error('Failed to fetch notifications');\r\n        const data = await res.json();\r\n        setNotifications(data);\r\n        setUnreadCount(data.filter(n => !n.read).length);\r\n      } catch (err) {\r\n        console.error('ðŸ”” Error loading notifications:', err);\r\n      }\r\n    };\r\n\r\n    fetchNotifications();\r\n  }, []);\r\n\r\n  const handleBellClick = () => {\r\n    setShowDropdown(!showDropdown);\r\n  };\r\n\r\n  const markAllAsRead = async () => {\r\n    try {\r\n      await fetch('/api/notifications/mark-all-read', {\r\n        method: 'POST',\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n      });\r\n      setNotifications(prev => prev.map(n => ({ ...n, read: true })));\r\n      setUnreadCount(0);\r\n    } catch (err) {\r\n      console.error('Failed to mark notifications as read', err);\r\n    }\r\n  };\r\n\r\n  const getIcon = (type) => {\r\n    switch (type) {\r\n      case 'message': return 'ðŸ’¬';\r\n      case 'offer': return 'ðŸ’°';\r\n      case 'contract': return 'ðŸ“„';\r\n      default: return 'ðŸ””';\r\n    }\r\n  };\r\n\r\n  const formatTimestamp = (timestamp) => {\r\n    const date = new Date(timestamp);\r\n    return date.toLocaleString();\r\n  };\r\n\r\n  return (\r\n    <div style={{ position: 'relative' }}>\r\n      <button onClick={handleBellClick} style={{ fontSize: '1.25rem', position: 'relative' }}>\r\n        ðŸ””\r\n        {unreadCount > 0 && (\r\n          <span style={{\r\n            position: 'absolute',\r\n            top: '-6px',\r\n            right: '-6px',\r\n            backgroundColor: 'red',\r\n            color: 'white',\r\n            borderRadius: '50%',\r\n            padding: '2px 6px',\r\n            fontSize: '0.75rem',\r\n            fontWeight: 'bold'\r\n          }}>\r\n            {unreadCount}\r\n          </span>\r\n        )}\r\n      </button>\r\n\r\n      {showDropdown && (\r\n        <div style={{\r\n          position: 'absolute',\r\n          right: 0,\r\n          top: '2.5rem',\r\n          background: '#fff',\r\n          border: '1px solid #ccc',\r\n          borderRadius: '4px',\r\n          width: '320px',\r\n          boxShadow: '0 2px 6px rgba(0,0,0,0.1)',\r\n          zIndex: 1000\r\n        }}>\r\n          <div style={{ padding: '0.5rem', borderBottom: '1px solid #eee' }}>\r\n            <strong>Notifications</strong>\r\n            <button onClick={markAllAsRead} style={{ float: 'right', fontSize: '0.75rem' }}>Mark all as read</button>\r\n          </div>\r\n          {notifications.length === 0 ? (\r\n            <div style={{ padding: '1rem' }}>No notifications</div>\r\n          ) : (\r\n            notifications.map((n, i) => (\r\n              <div\r\n                key={i}\r\n                style={{\r\n                  padding: '0.75rem 1rem',\r\n                  backgroundColor: n.read ? '#f9f9f9' : '#e6f7ff',\r\n                  borderBottom: '1px solid #eee',\r\n                  cursor: 'pointer'\r\n                }}\r\n                onClick={() => navigate(`/loan/${n.loanId}`)}\r\n              >\r\n                <div>\r\n                  <span style={{ marginRight: '0.5rem' }}>{getIcon(n.type)}</span>\r\n                  {n.message}\r\n                </div>\r\n                <div style={{ fontSize: '0.75rem', color: '#666' }}>{formatTimestamp(n.createdAt)}</div>\r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotificationBell;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}