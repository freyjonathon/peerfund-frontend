{"ast":null,"code":"// src/features/wallet/walletApi.js\n// Small helpers to normalize token & headers in one place\n\nfunction getToken() {\n  let t = localStorage.getItem('token') || '';\n  // strip wrapping quotes if token was saved like `\"....\"`\n  t = t.replace(/^\"|\"$/g, '');\n  return t || null;\n}\nfunction authHeaders() {\n  const t = getToken();\n  return t ? {\n    Authorization: `Bearer ${t}`\n  } : {};\n}\n\n/** GET /api/wallet/me */\nexport async function fetchWallet() {\n  const res = await fetch('/api/wallet/me', {\n    headers: {\n      'Content-Type': 'application/json',\n      ...authHeaders()\n    }\n  });\n  const text = await res.text();\n  let data = {};\n  try {\n    data = text ? JSON.parse(text) : {};\n  } catch {}\n  if (!res.ok) {\n    const msg = data.error || data.message || text || 'Failed to fetch wallet';\n    throw new Error(msg);\n  }\n  return data;\n}\n\n/** POST /api/wallet/deposit-intent\n * body: { amountDollars } – the backend converts to cents\n */\nexport async function createDepositIntent({\n  amountDollars\n}) {\n  const res = await fetch('/api/wallet/deposit-intent', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...authHeaders()\n    },\n    body: JSON.stringify({\n      amountDollars\n    })\n  });\n  const text = await res.text();\n  let data = {};\n  try {\n    data = text ? JSON.parse(text) : {};\n  } catch {}\n  if (!res.ok) {\n    const msg = data.error || data.message || text || 'Failed to create deposit';\n    throw new Error(msg);\n  }\n\n  // Expecting { clientSecret, simulated? }\n  return data;\n}","map":{"version":3,"names":["getToken","t","localStorage","getItem","replace","authHeaders","Authorization","fetchWallet","res","fetch","headers","text","data","JSON","parse","ok","msg","error","message","Error","createDepositIntent","amountDollars","method","body","stringify"],"sources":["/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/wallet/walletApi.js"],"sourcesContent":["// src/features/wallet/walletApi.js\n// Small helpers to normalize token & headers in one place\n\nfunction getToken() {\n  let t = localStorage.getItem('token') || '';\n  // strip wrapping quotes if token was saved like `\"....\"`\n  t = t.replace(/^\"|\"$/g, '');\n  return t || null;\n}\n\nfunction authHeaders() {\n  const t = getToken();\n  return t ? { Authorization: `Bearer ${t}` } : {};\n}\n\n/** GET /api/wallet/me */\nexport async function fetchWallet() {\n  const res = await fetch('/api/wallet/me', {\n    headers: {\n      'Content-Type': 'application/json',\n      ...authHeaders(),\n    },\n  });\n\n  const text = await res.text();\n  let data = {};\n  try { data = text ? JSON.parse(text) : {}; } catch {}\n\n  if (!res.ok) {\n    const msg = data.error || data.message || text || 'Failed to fetch wallet';\n    throw new Error(msg);\n  }\n\n  return data;\n}\n\n/** POST /api/wallet/deposit-intent\n * body: { amountDollars } – the backend converts to cents\n */\nexport async function createDepositIntent({ amountDollars }) {\n  const res = await fetch('/api/wallet/deposit-intent', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...authHeaders(),\n    },\n    body: JSON.stringify({ amountDollars }),\n  });\n\n  const text = await res.text();\n  let data = {};\n  try { data = text ? JSON.parse(text) : {}; } catch {}\n\n  if (!res.ok) {\n    const msg = data.error || data.message || text || 'Failed to create deposit';\n    throw new Error(msg);\n  }\n\n  // Expecting { clientSecret, simulated? }\n  return data;\n}\n"],"mappings":"AAAA;AACA;;AAEA,SAASA,QAAQA,CAAA,EAAG;EAClB,IAAIC,CAAC,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,IAAI,EAAE;EAC3C;EACAF,CAAC,GAAGA,CAAC,CAACG,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC;EAC3B,OAAOH,CAAC,IAAI,IAAI;AAClB;AAEA,SAASI,WAAWA,CAAA,EAAG;EACrB,MAAMJ,CAAC,GAAGD,QAAQ,CAAC,CAAC;EACpB,OAAOC,CAAC,GAAG;IAAEK,aAAa,EAAE,UAAUL,CAAC;EAAG,CAAC,GAAG,CAAC,CAAC;AAClD;;AAEA;AACA,OAAO,eAAeM,WAAWA,CAAA,EAAG;EAClC,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,gBAAgB,EAAE;IACxCC,OAAO,EAAE;MACP,cAAc,EAAE,kBAAkB;MAClC,GAAGL,WAAW,CAAC;IACjB;EACF,CAAC,CAAC;EAEF,MAAMM,IAAI,GAAG,MAAMH,GAAG,CAACG,IAAI,CAAC,CAAC;EAC7B,IAAIC,IAAI,GAAG,CAAC,CAAC;EACb,IAAI;IAAEA,IAAI,GAAGD,IAAI,GAAGE,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC,GAAG,CAAC,CAAC;EAAE,CAAC,CAAC,MAAM,CAAC;EAEpD,IAAI,CAACH,GAAG,CAACO,EAAE,EAAE;IACX,MAAMC,GAAG,GAAGJ,IAAI,CAACK,KAAK,IAAIL,IAAI,CAACM,OAAO,IAAIP,IAAI,IAAI,wBAAwB;IAC1E,MAAM,IAAIQ,KAAK,CAACH,GAAG,CAAC;EACtB;EAEA,OAAOJ,IAAI;AACb;;AAEA;AACA;AACA;AACA,OAAO,eAAeQ,mBAAmBA,CAAC;EAAEC;AAAc,CAAC,EAAE;EAC3D,MAAMb,GAAG,GAAG,MAAMC,KAAK,CAAC,4BAA4B,EAAE;IACpDa,MAAM,EAAE,MAAM;IACdZ,OAAO,EAAE;MACP,cAAc,EAAE,kBAAkB;MAClC,GAAGL,WAAW,CAAC;IACjB,CAAC;IACDkB,IAAI,EAAEV,IAAI,CAACW,SAAS,CAAC;MAAEH;IAAc,CAAC;EACxC,CAAC,CAAC;EAEF,MAAMV,IAAI,GAAG,MAAMH,GAAG,CAACG,IAAI,CAAC,CAAC;EAC7B,IAAIC,IAAI,GAAG,CAAC,CAAC;EACb,IAAI;IAAEA,IAAI,GAAGD,IAAI,GAAGE,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC,GAAG,CAAC,CAAC;EAAE,CAAC,CAAC,MAAM,CAAC;EAEpD,IAAI,CAACH,GAAG,CAACO,EAAE,EAAE;IACX,MAAMC,GAAG,GAAGJ,IAAI,CAACK,KAAK,IAAIL,IAAI,CAACM,OAAO,IAAIP,IAAI,IAAI,0BAA0B;IAC5E,MAAM,IAAIQ,KAAK,CAACH,GAAG,CAAC;EACtB;;EAEA;EACA,OAAOJ,IAAI;AACb","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}