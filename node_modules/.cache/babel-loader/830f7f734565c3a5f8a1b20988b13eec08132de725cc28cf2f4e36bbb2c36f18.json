{"ast":null,"code":"var _jsxFileName = \"/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/messaging/Messaging.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Messaging = () => {\n  _s();\n  const {\n    loanId\n  } = useParams();\n  const navigate = useNavigate();\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  useEffect(() => {\n    if (!loanId || loanId === 'undefined') {\n      console.warn('Loan ID is undefined. Skipping fetch.');\n      return;\n    }\n    const fetchMessages = async () => {\n      try {\n        const res = await fetch(`/api/loans/${loanId}/messages`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('token')}`\n          }\n        });\n        if (!res.ok) throw new Error('Failed to load messages');\n        const data = await res.json();\n        setMessages(data);\n      } catch (err) {\n        console.error('Error loading messages:', err.message);\n      }\n    };\n    fetchMessages();\n  }, [loanId]);\n  const handleSend = async () => {\n    if (!newMessage.trim() || !loanId || loanId === 'undefined') return;\n    try {\n      const res = await fetch(`/api/loans/${loanId}/messages`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        },\n        body: JSON.stringify({\n          text: newMessage\n        })\n      });\n      if (!res.ok) throw new Error('Failed to send message');\n      const updated = await res.json();\n      setMessages(prev => [...prev, updated]);\n      setNewMessage('');\n    } catch (err) {\n      console.error('Error sending message:', err.message);\n      alert('Failed to send message.');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: '2rem'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: '1rem'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/create-loan'),\n        children: \"Request a Loan\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/loan-marketplace'),\n        children: \"View Open Loans\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/money-summary'),\n        children: \"My Money Summary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/messages'),\n        children: \"My Messages\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/history'),\n        children: \"History\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/profile'),\n        children: \"Edit Profile\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/payment-method'),\n        children: \"My Payment Method\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/documents'),\n        children: \"My Documents\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [\"\\uD83D\\uDCE8 Direct Messaging \", loanId ? `for Loan #${loanId}` : '(No Loan Selected)']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        border: '1px solid #ccc',\n        padding: '1rem',\n        height: '300px',\n        overflowY: 'scroll'\n      },\n      children: messages.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"No messages yet.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }, this) : messages.map((msg, index) => {\n        var _msg$sender;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '1rem'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: [((_msg$sender = msg.sender) === null || _msg$sender === void 0 ? void 0 : _msg$sender.name) || 'Unknown', \":\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 15\n          }, this), \" \", msg.text]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: '1rem'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Type your message...\",\n        value: newMessage,\n        onChange: e => setNewMessage(e.target.value),\n        style: {\n          width: '70%'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSend,\n        style: {\n          marginLeft: '1rem'\n        },\n        disabled: !loanId || loanId === 'undefined',\n        children: \"Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n};\n_s(Messaging, \"RrUoc/DmDjB1122HnEBhLazZ0T0=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = Messaging;\nexport default Messaging;\nvar _c;\n$RefreshReg$(_c, \"Messaging\");","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","jsxDEV","_jsxDEV","Messaging","_s","loanId","navigate","messages","setMessages","newMessage","setNewMessage","console","warn","fetchMessages","res","fetch","headers","Authorization","localStorage","getItem","ok","Error","data","json","err","error","message","handleSend","trim","method","body","JSON","stringify","text","updated","prev","alert","style","padding","children","marginBottom","onClick","fileName","_jsxFileName","lineNumber","columnNumber","border","height","overflowY","length","map","msg","index","_msg$sender","sender","name","marginTop","type","placeholder","value","onChange","e","target","width","marginLeft","disabled","_c","$RefreshReg$"],"sources":["/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/messaging/Messaging.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\n\nconst Messaging = () => {\n  const { loanId } = useParams();\n  const navigate = useNavigate();\n\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n\n  useEffect(() => {\n    if (!loanId || loanId === 'undefined') {\n      console.warn('Loan ID is undefined. Skipping fetch.');\n      return;\n    }\n\n    const fetchMessages = async () => {\n      try {\n        const res = await fetch(`/api/loans/${loanId}/messages`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\n          },\n        });\n        if (!res.ok) throw new Error('Failed to load messages');\n        const data = await res.json();\n        setMessages(data);\n      } catch (err) {\n        console.error('Error loading messages:', err.message);\n      }\n    };\n\n    fetchMessages();\n  }, [loanId]);\n\n  const handleSend = async () => {\n    if (!newMessage.trim() || !loanId || loanId === 'undefined') return;\n\n    try {\n      const res = await fetch(`/api/loans/${loanId}/messages`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n        body: JSON.stringify({ text: newMessage }),\n      });\n\n      if (!res.ok) throw new Error('Failed to send message');\n      const updated = await res.json();\n      setMessages((prev) => [...prev, updated]);\n      setNewMessage('');\n    } catch (err) {\n      console.error('Error sending message:', err.message);\n      alert('Failed to send message.');\n    }\n  };\n\n  return (\n    <div style={{ padding: '2rem' }}>\n      {/* Navigation */}\n      <div style={{ marginBottom: '1rem' }}>\n        <button onClick={() => navigate('/create-loan')}>Request a Loan</button>\n        <button onClick={() => navigate('/loan-marketplace')}>View Open Loans</button>\n        <button onClick={() => navigate('/money-summary')}>My Money Summary</button>\n        <button onClick={() => navigate('/messages')}>My Messages</button>\n        <button onClick={() => navigate('/history')}>History</button>\n        <button onClick={() => navigate('/profile')}>Edit Profile</button>\n        <button onClick={() => navigate('/payment-method')}>My Payment Method</button>\n        <button onClick={() => navigate('/documents')}>My Documents</button>\n      </div>\n\n      <h2>ðŸ“¨ Direct Messaging {loanId ? `for Loan #${loanId}` : '(No Loan Selected)'}</h2>\n\n      <div style={{ border: '1px solid #ccc', padding: '1rem', height: '300px', overflowY: 'scroll' }}>\n        {messages.length === 0 ? (\n          <p>No messages yet.</p>\n        ) : (\n          messages.map((msg, index) => (\n            <div key={index} style={{ marginBottom: '1rem' }}>\n              <strong>{msg.sender?.name || 'Unknown'}:</strong> {msg.text}\n            </div>\n          ))\n        )}\n      </div>\n\n      <div style={{ marginTop: '1rem' }}>\n        <input\n          type=\"text\"\n          placeholder=\"Type your message...\"\n          value={newMessage}\n          onChange={(e) => setNewMessage(e.target.value)}\n          style={{ width: '70%' }}\n        />\n        <button onClick={handleSend} style={{ marginLeft: '1rem' }} disabled={!loanId || loanId === 'undefined'}>\n          Send\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default Messaging;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}