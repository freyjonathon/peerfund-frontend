{"ast":null,"code":"import _objectSpread from\"/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/features/loans/LoanMarketplace.jsx\nimport React,{useEffect,useMemo,useState}from'react';import axios from'axios';import'./LoanMarketplace.css';import InlineDiscussion from'./InlineDiscussion';import UserProfileModal from'../../components/UserProfileModal';import OfferModal from'../../components/OfferModal';// âœ… new import\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const fmtMoney=n=>typeof n==='number'&&!Number.isNaN(n)?\"$\".concat(n.toFixed(2)):'â€”';// Decode JWT to get the current user id (so we can hide their own requests)\nfunction getCurrentUserId(){const t=localStorage.getItem('token');if(!t)return null;try{var _payload$userId;const payload=JSON.parse(atob(t.split('.')[1]||''));return(_payload$userId=payload===null||payload===void 0?void 0:payload.userId)!==null&&_payload$userId!==void 0?_payload$userId:null;}catch(_unused){return null;}}export default function LoanMarketplace(){const[loans,setLoans]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[filters,setFilters]=useState({amount:'',purpose:'',duration:''});// expanded state per loan id\nconst[expanded,setExpanded]=useState({});// which user profile to show in the modal\nconst[profileUserId,setProfileUserId]=useState(null);// NEW: track which loanâ€™s offer modal is open\nconst[selectedLoanId,setSelectedLoanId]=useState(null);const currentUserId=getCurrentUserId();const toggle=id=>setExpanded(prev=>{const collapsed=Object.keys(prev).reduce((acc,k)=>_objectSpread(_objectSpread({},acc),{},{[k]:false}),{});return _objectSpread(_objectSpread({},collapsed),{},{[id]:!prev[id]});});useEffect(()=>{const fetchLoans=async()=>{try{var _res$data;setLoading(true);setError('');const res=await axios.get('/api/loans/open',{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});const data=Array.isArray(res.data)?res.data:((_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.items)||[];setLoans(data);}catch(err){console.error('Error fetching loan requests:',err);setError('Failed to load open loan requests. Please try again.');setLoans([]);}finally{setLoading(false);}};fetchLoans();},[]);const handleFilterChange=e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{[e.target.name]:e.target.value}));// Exclude the viewer's own requests first, then apply filters\nconst visible=useMemo(()=>{const notMine=loans.filter(loan=>{var _loan$borrower;const borrowerId=((_loan$borrower=loan.borrower)===null||_loan$borrower===void 0?void 0:_loan$borrower.id)||loan.borrowerId;return!currentUserId||!borrowerId||borrowerId!==currentUserId;});return notMine.filter(loan=>{const amount=Number(loan.amount);const matchesAmount=!filters.amount||Number.isFinite(amount)&&amount>=Number(filters.amount);const matchesPurpose=!filters.purpose||(loan.purpose||'').toLowerCase().includes(filters.purpose.toLowerCase());const matchesDuration=!filters.duration||Number(loan.duration)===Number(filters.duration);return matchesAmount&&matchesPurpose&&matchesDuration;});},[loans,filters,currentUserId]);return/*#__PURE__*/_jsxs(\"div\",{className:\"lm-container\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"lm-heading\",children:\"Open Loan Marketplace\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"lm-filters\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"lm-filter\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Min Amount\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"amount\",value:filters.amount,onChange:handleFilterChange,placeholder:\"e.g. 75\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"lm-filter\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Duration (months)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"duration\",value:filters.duration,onChange:handleFilterChange,placeholder:\"e.g. 2\"})]})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"lm-error\",children:error}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"lm-skeleton-grid\",children:[...Array(6)].map((_,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"lm-card lm-skeleton\"},i))}):visible.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"lm-empty\",children:\"No open loan requests match your filters.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"lm-grid\",children:visible.map(loan=>{var _ref,_loan$_count$loanOffe,_loan$_count;const borrower=loan.borrower||{};const borrowerId=borrower.id||borrower._id||loan.borrowerId;const name=borrower.name||borrower.fullName||'Unknown';const duration=Number(loan.duration);const interest=loan.interestRate!=null?\"\".concat(loan.interestRate,\"%\"):'â€”';const amount=Number(loan.amount)||0;const isOpen=!!expanded[loan.id];// robust offer count\nconst offerCount=(_ref=typeof loan.offerCount==='number'&&loan.offerCount)!==null&&_ref!==void 0?_ref:(_loan$_count$loanOffe=(_loan$_count=loan._count)===null||_loan$_count===void 0?void 0:_loan$_count.loanOffers)!==null&&_loan$_count$loanOffe!==void 0?_loan$_count$loanOffe:Array.isArray(loan.loanOffers)?loan.loanOffers.length:0;return/*#__PURE__*/_jsxs(\"div\",{className:\"lm-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lm-card-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lm-header-left\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"pf-linklike\",onClick:()=>borrowerId&&setProfileUserId(borrowerId),title:\"View profile\",children:/*#__PURE__*/_jsx(\"div\",{className:\"lm-title\",children:name})}),/*#__PURE__*/_jsx(\"div\",{className:\"lm-subtitle\",children:\"Borrower\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lm-header-right\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"lm-amount-label\",children:\"Amount\"}),/*#__PURE__*/_jsx(\"div\",{className:\"lm-amount-value\",children:fmtMoney(amount)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lm-header-right\",children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'.75rem',color:'#64748b'},children:\"Duration\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:600},children:Number.isFinite(duration)?\"\".concat(duration,\" months\"):'â€”'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lm-header-right\",children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'.75rem',color:'#64748b'},children:\"Interest\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:600},children:interest})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lm-header-right\",children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'.75rem',color:'#64748b'},children:\"Offers\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:600},children:offerCount})]}),/*#__PURE__*/_jsx(\"div\",{className:\"lm-actions-top\",style:{gap:'.5rem',flexWrap:'wrap'},children:/*#__PURE__*/_jsx(\"button\",{className:\"action-btn primary\",onClick:()=>setSelectedLoanId(loan.id),children:\"\\uD83D\\uDCAC View Convo / \\uD83D\\uDCB5 Make Offer\"})})]}),isOpen&&/*#__PURE__*/_jsxs(\"div\",{id:\"loan-details-\".concat(loan.id),className:\"lm-details\",role:\"region\",\"aria-label\":\"Loan details for \".concat(name),children:[/*#__PURE__*/_jsx(\"div\",{className:\"lm-details-grid\"}),/*#__PURE__*/_jsx(InlineDiscussion,{threadId:loan.id,limit:5,compact:true,showHeader:false})]})]},loan.id);})}),profileUserId&&/*#__PURE__*/_jsx(UserProfileModal,{userId:profileUserId,onClose:()=>setProfileUserId(null)}),selectedLoanId&&/*#__PURE__*/_jsx(OfferModal,{loanId:selectedLoanId,onClose:()=>setSelectedLoanId(null)})]});}","map":{"version":3,"names":["React","useEffect","useMemo","useState","axios","InlineDiscussion","UserProfileModal","OfferModal","jsx","_jsx","jsxs","_jsxs","fmtMoney","n","Number","isNaN","concat","toFixed","getCurrentUserId","t","localStorage","getItem","_payload$userId","payload","JSON","parse","atob","split","userId","_unused","LoanMarketplace","loans","setLoans","loading","setLoading","error","setError","filters","setFilters","amount","purpose","duration","expanded","setExpanded","profileUserId","setProfileUserId","selectedLoanId","setSelectedLoanId","currentUserId","toggle","id","prev","collapsed","Object","keys","reduce","acc","k","_objectSpread","fetchLoans","_res$data","res","get","headers","Authorization","data","Array","isArray","items","err","console","handleFilterChange","e","f","target","name","value","visible","notMine","filter","loan","_loan$borrower","borrowerId","borrower","matchesAmount","isFinite","matchesPurpose","toLowerCase","includes","matchesDuration","className","children","type","onChange","placeholder","map","_","i","length","_ref","_loan$_count$loanOffe","_loan$_count","_id","fullName","interest","interestRate","isOpen","offerCount","_count","loanOffers","onClick","title","style","fontSize","color","fontWeight","gap","flexWrap","role","threadId","limit","compact","showHeader","onClose","loanId"],"sources":["/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/loans/LoanMarketplace.jsx"],"sourcesContent":["// src/features/loans/LoanMarketplace.jsx\nimport React, { useEffect, useMemo, useState } from 'react';\nimport axios from 'axios';\nimport './LoanMarketplace.css';\nimport InlineDiscussion from './InlineDiscussion';\nimport UserProfileModal from '../../components/UserProfileModal';\nimport OfferModal from '../../components/OfferModal'; // âœ… new import\n\nconst fmtMoney = (n) =>\n  typeof n === 'number' && !Number.isNaN(n) ? `$${n.toFixed(2)}` : 'â€”';\n\n// Decode JWT to get the current user id (so we can hide their own requests)\nfunction getCurrentUserId() {\n  const t = localStorage.getItem('token');\n  if (!t) return null;\n  try {\n    const payload = JSON.parse(atob(t.split('.')[1] || ''));\n    return payload?.userId ?? null;\n  } catch {\n    return null;\n  }\n}\n\nexport default function LoanMarketplace() {\n  const [loans, setLoans] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [filters, setFilters] = useState({ amount: '', purpose: '', duration: '' });\n\n  // expanded state per loan id\n  const [expanded, setExpanded] = useState({});\n  // which user profile to show in the modal\n  const [profileUserId, setProfileUserId] = useState(null);\n  // NEW: track which loanâ€™s offer modal is open\n  const [selectedLoanId, setSelectedLoanId] = useState(null);\n\n  const currentUserId = getCurrentUserId();\n\n  const toggle = (id) =>\n    setExpanded((prev) => {\n      const collapsed = Object.keys(prev).reduce((acc, k) => ({ ...acc, [k]: false }), {});\n      return { ...collapsed, [id]: !prev[id] };\n    });\n\n  useEffect(() => {\n    const fetchLoans = async () => {\n      try {\n        setLoading(true);\n        setError('');\n        const res = await axios.get('/api/loans/open', {\n          headers: { Authorization: `Bearer ${localStorage.getItem('token')}` },\n        });\n        const data = Array.isArray(res.data) ? res.data : res.data?.items || [];\n        setLoans(data);\n      } catch (err) {\n        console.error('Error fetching loan requests:', err);\n        setError('Failed to load open loan requests. Please try again.');\n        setLoans([]);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchLoans();\n  }, []);\n\n  const handleFilterChange = (e) =>\n    setFilters((f) => ({ ...f, [e.target.name]: e.target.value }));\n\n  // Exclude the viewer's own requests first, then apply filters\n  const visible = useMemo(() => {\n    const notMine = loans.filter((loan) => {\n      const borrowerId = loan.borrower?.id || loan.borrowerId;\n      return !currentUserId || !borrowerId || borrowerId !== currentUserId;\n    });\n\n    return notMine.filter((loan) => {\n      const amount = Number(loan.amount);\n      const matchesAmount =\n        !filters.amount || (Number.isFinite(amount) && amount >= Number(filters.amount));\n      const matchesPurpose =\n        !filters.purpose ||\n        (loan.purpose || '').toLowerCase().includes(filters.purpose.toLowerCase());\n      const matchesDuration =\n        !filters.duration || Number(loan.duration) === Number(filters.duration);\n      return matchesAmount && matchesPurpose && matchesDuration;\n    });\n  }, [loans, filters, currentUserId]);\n\n  return (\n    <div className=\"lm-container\">\n      <h2 className=\"lm-heading\">Open Loan Marketplace</h2>\n\n      {/* Filter bar */}\n      <div className=\"lm-filters\">\n        <label className=\"lm-filter\">\n          <span>Min Amount</span>\n          <input\n            type=\"number\"\n            name=\"amount\"\n            value={filters.amount}\n            onChange={handleFilterChange}\n            placeholder=\"e.g. 75\"\n          />\n        </label>\n        <label className=\"lm-filter\">\n          <span>Duration (months)</span>\n          <input\n            type=\"number\"\n            name=\"duration\"\n            value={filters.duration}\n            onChange={handleFilterChange}\n            placeholder=\"e.g. 2\"\n          />\n        </label>\n      </div>\n\n      {error && <div className=\"lm-error\">{error}</div>}\n\n      {loading ? (\n        <div className=\"lm-skeleton-grid\">\n          {[...Array(6)].map((_, i) => (\n            <div className=\"lm-card lm-skeleton\" key={i} />\n          ))}\n        </div>\n      ) : visible.length === 0 ? (\n        <p className=\"lm-empty\">No open loan requests match your filters.</p>\n      ) : (\n        <div className=\"lm-grid\">\n          {visible.map((loan) => {\n            const borrower = loan.borrower || {};\n            const borrowerId = borrower.id || borrower._id || loan.borrowerId;\n            const name = borrower.name || borrower.fullName || 'Unknown';\n            const duration = Number(loan.duration);\n            const interest = loan.interestRate != null ? `${loan.interestRate}%` : 'â€”';\n            const amount = Number(loan.amount) || 0;\n            const isOpen = !!expanded[loan.id];\n\n            // robust offer count\n            const offerCount =\n              (typeof loan.offerCount === 'number' && loan.offerCount) ??\n              (loan._count?.loanOffers ??\n                (Array.isArray(loan.loanOffers) ? loan.loanOffers.length : 0));\n\n            return (\n              <div className=\"lm-card\" key={loan.id}>\n                {/* Header row */}\n                <div className=\"lm-card-header\">\n                  <div className=\"lm-header-left\">\n                    <button\n                      type=\"button\"\n                      className=\"pf-linklike\"\n                      onClick={() => borrowerId && setProfileUserId(borrowerId)}\n                      title=\"View profile\"\n                    >\n                      <div className=\"lm-title\">{name}</div>\n                    </button>\n                    <div className=\"lm-subtitle\">Borrower</div>\n                  </div>\n\n                  <div className=\"lm-header-right\">\n                    <div className=\"lm-amount-label\">Amount</div>\n                    <div className=\"lm-amount-value\">{fmtMoney(amount)}</div>\n                  </div>\n\n                  <div className=\"lm-header-right\">\n                    <div style={{ fontSize: '.75rem', color: '#64748b' }}>Duration</div>\n                    <div style={{ fontWeight: 600 }}>\n                      {Number.isFinite(duration) ? `${duration} months` : 'â€”'}\n                    </div>\n                  </div>\n\n                  <div className=\"lm-header-right\">\n                    <div style={{ fontSize: '.75rem', color: '#64748b' }}>Interest</div>\n                    <div style={{ fontWeight: 600 }}>{interest}</div>\n                  </div>\n\n                  {/* Offers count */}\n                  <div className=\"lm-header-right\">\n                    <div style={{ fontSize: '.75rem', color: '#64748b' }}>Offers</div>\n                    <div style={{ fontWeight: 600 }}>{offerCount}</div>\n                  </div>\n\n                  {/* Actions */}\n                  <div className=\"lm-actions-top\" style={{ gap: '.5rem', flexWrap: 'wrap' }}>\n                    {/* UPDATED: instead of Link, open modal */}\n                    <button\n                      className=\"action-btn primary\"\n                      onClick={() => setSelectedLoanId(loan.id)}\n                    >\n                      ðŸ’¬ View Convo / ðŸ’µ Make Offer\n                    </button>\n \n                  </div>\n                </div>\n\n                {/* Collapsible details */}\n                {isOpen && (\n                  <div\n                    id={`loan-details-${loan.id}`}\n                    className=\"lm-details\"\n                    role=\"region\"\n                    aria-label={`Loan details for ${name}`}\n                  >\n                    <div className=\"lm-details-grid\" />\n                    {/* Inline public discussion */}\n                    <InlineDiscussion threadId={loan.id} limit={5} compact showHeader={false} />\n                  </div>\n                )}\n              </div>\n            );\n          })}\n        </div>\n      )}\n\n      {/* Profile modal */}\n      {profileUserId && (\n        <UserProfileModal userId={profileUserId} onClose={() => setProfileUserId(null)} />\n      )}\n\n      {/* Offer modal */}\n      {selectedLoanId && (\n        <OfferModal loanId={selectedLoanId} onClose={() => setSelectedLoanId(null)} />\n      )}\n    </div>\n  );\n}\n\n"],"mappings":"+IAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,OAAO,CAAEC,QAAQ,KAAQ,OAAO,CAC3D,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,uBAAuB,CAC9B,MAAO,CAAAC,gBAAgB,KAAM,oBAAoB,CACjD,MAAO,CAAAC,gBAAgB,KAAM,mCAAmC,CAChE,MAAO,CAAAC,UAAU,KAAM,6BAA6B,CAAE;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEtD,KAAM,CAAAC,QAAQ,CAAIC,CAAC,EACjB,MAAO,CAAAA,CAAC,GAAK,QAAQ,EAAI,CAACC,MAAM,CAACC,KAAK,CAACF,CAAC,CAAC,KAAAG,MAAA,CAAOH,CAAC,CAACI,OAAO,CAAC,CAAC,CAAC,EAAK,GAAG,CAEtE;AACA,QAAS,CAAAC,gBAAgBA,CAAA,CAAG,CAC1B,KAAM,CAAAC,CAAC,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CACvC,GAAI,CAACF,CAAC,CAAE,MAAO,KAAI,CACnB,GAAI,KAAAG,eAAA,CACF,KAAM,CAAAC,OAAO,CAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACP,CAAC,CAACQ,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAI,EAAE,CAAC,CAAC,CACvD,OAAAL,eAAA,CAAOC,OAAO,SAAPA,OAAO,iBAAPA,OAAO,CAAEK,MAAM,UAAAN,eAAA,UAAAA,eAAA,CAAI,IAAI,CAChC,CAAE,MAAAO,OAAA,CAAM,CACN,MAAO,KAAI,CACb,CACF,CAEA,cAAe,SAAS,CAAAC,eAAeA,CAAA,CAAG,CACxC,KAAM,CAACC,KAAK,CAAEC,QAAQ,CAAC,CAAG7B,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAAC8B,OAAO,CAAEC,UAAU,CAAC,CAAG/B,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACgC,KAAK,CAAEC,QAAQ,CAAC,CAAGjC,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACkC,OAAO,CAAEC,UAAU,CAAC,CAAGnC,QAAQ,CAAC,CAAEoC,MAAM,CAAE,EAAE,CAAEC,OAAO,CAAE,EAAE,CAAEC,QAAQ,CAAE,EAAG,CAAC,CAAC,CAEjF;AACA,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGxC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAC5C;AACA,KAAM,CAACyC,aAAa,CAAEC,gBAAgB,CAAC,CAAG1C,QAAQ,CAAC,IAAI,CAAC,CACxD;AACA,KAAM,CAAC2C,cAAc,CAAEC,iBAAiB,CAAC,CAAG5C,QAAQ,CAAC,IAAI,CAAC,CAE1D,KAAM,CAAA6C,aAAa,CAAG9B,gBAAgB,CAAC,CAAC,CAExC,KAAM,CAAA+B,MAAM,CAAIC,EAAE,EAChBP,WAAW,CAAEQ,IAAI,EAAK,CACpB,KAAM,CAAAC,SAAS,CAAGC,MAAM,CAACC,IAAI,CAACH,IAAI,CAAC,CAACI,MAAM,CAAC,CAACC,GAAG,CAAEC,CAAC,GAAAC,aAAA,CAAAA,aAAA,IAAWF,GAAG,MAAE,CAACC,CAAC,EAAG,KAAK,EAAG,CAAE,CAAC,CAAC,CAAC,CACpF,OAAAC,aAAA,CAAAA,aAAA,IAAYN,SAAS,MAAE,CAACF,EAAE,EAAG,CAACC,IAAI,CAACD,EAAE,CAAC,GACxC,CAAC,CAAC,CAEJjD,SAAS,CAAC,IAAM,CACd,KAAM,CAAA0D,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,KAAAC,SAAA,CACF1B,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,EAAE,CAAC,CACZ,KAAM,CAAAyB,GAAG,CAAG,KAAM,CAAAzD,KAAK,CAAC0D,GAAG,CAAC,iBAAiB,CAAE,CAC7CC,OAAO,CAAE,CAAEC,aAAa,WAAAhD,MAAA,CAAYI,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAG,CACtE,CAAC,CAAC,CACF,KAAM,CAAA4C,IAAI,CAAGC,KAAK,CAACC,OAAO,CAACN,GAAG,CAACI,IAAI,CAAC,CAAGJ,GAAG,CAACI,IAAI,CAAG,EAAAL,SAAA,CAAAC,GAAG,CAACI,IAAI,UAAAL,SAAA,iBAARA,SAAA,CAAUQ,KAAK,GAAI,EAAE,CACvEpC,QAAQ,CAACiC,IAAI,CAAC,CAChB,CAAE,MAAOI,GAAG,CAAE,CACZC,OAAO,CAACnC,KAAK,CAAC,+BAA+B,CAAEkC,GAAG,CAAC,CACnDjC,QAAQ,CAAC,sDAAsD,CAAC,CAChEJ,QAAQ,CAAC,EAAE,CAAC,CACd,CAAC,OAAS,CACRE,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CACDyB,UAAU,CAAC,CAAC,CACd,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAY,kBAAkB,CAAIC,CAAC,EAC3BlC,UAAU,CAAEmC,CAAC,EAAAf,aAAA,CAAAA,aAAA,IAAWe,CAAC,MAAE,CAACD,CAAC,CAACE,MAAM,CAACC,IAAI,EAAGH,CAAC,CAACE,MAAM,CAACE,KAAK,EAAG,CAAC,CAEhE;AACA,KAAM,CAAAC,OAAO,CAAG3E,OAAO,CAAC,IAAM,CAC5B,KAAM,CAAA4E,OAAO,CAAG/C,KAAK,CAACgD,MAAM,CAAEC,IAAI,EAAK,KAAAC,cAAA,CACrC,KAAM,CAAAC,UAAU,CAAG,EAAAD,cAAA,CAAAD,IAAI,CAACG,QAAQ,UAAAF,cAAA,iBAAbA,cAAA,CAAe/B,EAAE,GAAI8B,IAAI,CAACE,UAAU,CACvD,MAAO,CAAClC,aAAa,EAAI,CAACkC,UAAU,EAAIA,UAAU,GAAKlC,aAAa,CACtE,CAAC,CAAC,CAEF,MAAO,CAAA8B,OAAO,CAACC,MAAM,CAAEC,IAAI,EAAK,CAC9B,KAAM,CAAAzC,MAAM,CAAGzB,MAAM,CAACkE,IAAI,CAACzC,MAAM,CAAC,CAClC,KAAM,CAAA6C,aAAa,CACjB,CAAC/C,OAAO,CAACE,MAAM,EAAKzB,MAAM,CAACuE,QAAQ,CAAC9C,MAAM,CAAC,EAAIA,MAAM,EAAIzB,MAAM,CAACuB,OAAO,CAACE,MAAM,CAAE,CAClF,KAAM,CAAA+C,cAAc,CAClB,CAACjD,OAAO,CAACG,OAAO,EAChB,CAACwC,IAAI,CAACxC,OAAO,EAAI,EAAE,EAAE+C,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACnD,OAAO,CAACG,OAAO,CAAC+C,WAAW,CAAC,CAAC,CAAC,CAC5E,KAAM,CAAAE,eAAe,CACnB,CAACpD,OAAO,CAACI,QAAQ,EAAI3B,MAAM,CAACkE,IAAI,CAACvC,QAAQ,CAAC,GAAK3B,MAAM,CAACuB,OAAO,CAACI,QAAQ,CAAC,CACzE,MAAO,CAAA2C,aAAa,EAAIE,cAAc,EAAIG,eAAe,CAC3D,CAAC,CAAC,CACJ,CAAC,CAAE,CAAC1D,KAAK,CAAEM,OAAO,CAAEW,aAAa,CAAC,CAAC,CAEnC,mBACErC,KAAA,QAAK+E,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BlF,IAAA,OAAIiF,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,uBAAqB,CAAI,CAAC,cAGrDhF,KAAA,QAAK+E,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBhF,KAAA,UAAO+E,SAAS,CAAC,WAAW,CAAAC,QAAA,eAC1BlF,IAAA,SAAAkF,QAAA,CAAM,YAAU,CAAM,CAAC,cACvBlF,IAAA,UACEmF,IAAI,CAAC,QAAQ,CACbjB,IAAI,CAAC,QAAQ,CACbC,KAAK,CAAEvC,OAAO,CAACE,MAAO,CACtBsD,QAAQ,CAAEtB,kBAAmB,CAC7BuB,WAAW,CAAC,SAAS,CACtB,CAAC,EACG,CAAC,cACRnF,KAAA,UAAO+E,SAAS,CAAC,WAAW,CAAAC,QAAA,eAC1BlF,IAAA,SAAAkF,QAAA,CAAM,mBAAiB,CAAM,CAAC,cAC9BlF,IAAA,UACEmF,IAAI,CAAC,QAAQ,CACbjB,IAAI,CAAC,UAAU,CACfC,KAAK,CAAEvC,OAAO,CAACI,QAAS,CACxBoD,QAAQ,CAAEtB,kBAAmB,CAC7BuB,WAAW,CAAC,QAAQ,CACrB,CAAC,EACG,CAAC,EACL,CAAC,CAEL3D,KAAK,eAAI1B,IAAA,QAAKiF,SAAS,CAAC,UAAU,CAAAC,QAAA,CAAExD,KAAK,CAAM,CAAC,CAEhDF,OAAO,cACNxB,IAAA,QAAKiF,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAC9B,CAAC,GAAGzB,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC6B,GAAG,CAAC,CAACC,CAAC,CAAEC,CAAC,gBACtBxF,IAAA,QAAKiF,SAAS,CAAC,qBAAqB,EAAMO,CAAI,CAC/C,CAAC,CACC,CAAC,CACJpB,OAAO,CAACqB,MAAM,GAAK,CAAC,cACtBzF,IAAA,MAAGiF,SAAS,CAAC,UAAU,CAAAC,QAAA,CAAC,2CAAyC,CAAG,CAAC,cAErElF,IAAA,QAAKiF,SAAS,CAAC,SAAS,CAAAC,QAAA,CACrBd,OAAO,CAACkB,GAAG,CAAEf,IAAI,EAAK,KAAAmB,IAAA,CAAAC,qBAAA,CAAAC,YAAA,CACrB,KAAM,CAAAlB,QAAQ,CAAGH,IAAI,CAACG,QAAQ,EAAI,CAAC,CAAC,CACpC,KAAM,CAAAD,UAAU,CAAGC,QAAQ,CAACjC,EAAE,EAAIiC,QAAQ,CAACmB,GAAG,EAAItB,IAAI,CAACE,UAAU,CACjE,KAAM,CAAAP,IAAI,CAAGQ,QAAQ,CAACR,IAAI,EAAIQ,QAAQ,CAACoB,QAAQ,EAAI,SAAS,CAC5D,KAAM,CAAA9D,QAAQ,CAAG3B,MAAM,CAACkE,IAAI,CAACvC,QAAQ,CAAC,CACtC,KAAM,CAAA+D,QAAQ,CAAGxB,IAAI,CAACyB,YAAY,EAAI,IAAI,IAAAzF,MAAA,CAAMgE,IAAI,CAACyB,YAAY,MAAM,GAAG,CAC1E,KAAM,CAAAlE,MAAM,CAAGzB,MAAM,CAACkE,IAAI,CAACzC,MAAM,CAAC,EAAI,CAAC,CACvC,KAAM,CAAAmE,MAAM,CAAG,CAAC,CAAChE,QAAQ,CAACsC,IAAI,CAAC9B,EAAE,CAAC,CAElC;AACA,KAAM,CAAAyD,UAAU,EAAAR,IAAA,CACb,MAAO,CAAAnB,IAAI,CAAC2B,UAAU,GAAK,QAAQ,EAAI3B,IAAI,CAAC2B,UAAU,UAAAR,IAAA,UAAAA,IAAA,EAAAC,qBAAA,EAAAC,YAAA,CACtDrB,IAAI,CAAC4B,MAAM,UAAAP,YAAA,iBAAXA,YAAA,CAAaQ,UAAU,UAAAT,qBAAA,UAAAA,qBAAA,CACrBlC,KAAK,CAACC,OAAO,CAACa,IAAI,CAAC6B,UAAU,CAAC,CAAG7B,IAAI,CAAC6B,UAAU,CAACX,MAAM,CAAG,CAAG,CAElE,mBACEvF,KAAA,QAAK+E,SAAS,CAAC,SAAS,CAAAC,QAAA,eAEtBhF,KAAA,QAAK+E,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BhF,KAAA,QAAK+E,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BlF,IAAA,WACEmF,IAAI,CAAC,QAAQ,CACbF,SAAS,CAAC,aAAa,CACvBoB,OAAO,CAAEA,CAAA,GAAM5B,UAAU,EAAIrC,gBAAgB,CAACqC,UAAU,CAAE,CAC1D6B,KAAK,CAAC,cAAc,CAAApB,QAAA,cAEpBlF,IAAA,QAAKiF,SAAS,CAAC,UAAU,CAAAC,QAAA,CAAEhB,IAAI,CAAM,CAAC,CAChC,CAAC,cACTlE,IAAA,QAAKiF,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAC,UAAQ,CAAK,CAAC,EACxC,CAAC,cAENhF,KAAA,QAAK+E,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9BlF,IAAA,QAAKiF,SAAS,CAAC,iBAAiB,CAAAC,QAAA,CAAC,QAAM,CAAK,CAAC,cAC7ClF,IAAA,QAAKiF,SAAS,CAAC,iBAAiB,CAAAC,QAAA,CAAE/E,QAAQ,CAAC2B,MAAM,CAAC,CAAM,CAAC,EACtD,CAAC,cAEN5B,KAAA,QAAK+E,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9BlF,IAAA,QAAKuG,KAAK,CAAE,CAAEC,QAAQ,CAAE,QAAQ,CAAEC,KAAK,CAAE,SAAU,CAAE,CAAAvB,QAAA,CAAC,UAAQ,CAAK,CAAC,cACpElF,IAAA,QAAKuG,KAAK,CAAE,CAAEG,UAAU,CAAE,GAAI,CAAE,CAAAxB,QAAA,CAC7B7E,MAAM,CAACuE,QAAQ,CAAC5C,QAAQ,CAAC,IAAAzB,MAAA,CAAMyB,QAAQ,YAAY,GAAG,CACpD,CAAC,EACH,CAAC,cAEN9B,KAAA,QAAK+E,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9BlF,IAAA,QAAKuG,KAAK,CAAE,CAAEC,QAAQ,CAAE,QAAQ,CAAEC,KAAK,CAAE,SAAU,CAAE,CAAAvB,QAAA,CAAC,UAAQ,CAAK,CAAC,cACpElF,IAAA,QAAKuG,KAAK,CAAE,CAAEG,UAAU,CAAE,GAAI,CAAE,CAAAxB,QAAA,CAAEa,QAAQ,CAAM,CAAC,EAC9C,CAAC,cAGN7F,KAAA,QAAK+E,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9BlF,IAAA,QAAKuG,KAAK,CAAE,CAAEC,QAAQ,CAAE,QAAQ,CAAEC,KAAK,CAAE,SAAU,CAAE,CAAAvB,QAAA,CAAC,QAAM,CAAK,CAAC,cAClElF,IAAA,QAAKuG,KAAK,CAAE,CAAEG,UAAU,CAAE,GAAI,CAAE,CAAAxB,QAAA,CAAEgB,UAAU,CAAM,CAAC,EAChD,CAAC,cAGNlG,IAAA,QAAKiF,SAAS,CAAC,gBAAgB,CAACsB,KAAK,CAAE,CAAEI,GAAG,CAAE,OAAO,CAAEC,QAAQ,CAAE,MAAO,CAAE,CAAA1B,QAAA,cAExElF,IAAA,WACEiF,SAAS,CAAC,oBAAoB,CAC9BoB,OAAO,CAAEA,CAAA,GAAM/D,iBAAiB,CAACiC,IAAI,CAAC9B,EAAE,CAAE,CAAAyC,QAAA,CAC3C,mDAED,CAAQ,CAAC,CAEN,CAAC,EACH,CAAC,CAGLe,MAAM,eACL/F,KAAA,QACEuC,EAAE,iBAAAlC,MAAA,CAAkBgE,IAAI,CAAC9B,EAAE,CAAG,CAC9BwC,SAAS,CAAC,YAAY,CACtB4B,IAAI,CAAC,QAAQ,CACb,iCAAAtG,MAAA,CAAgC2D,IAAI,CAAG,CAAAgB,QAAA,eAEvClF,IAAA,QAAKiF,SAAS,CAAC,iBAAiB,CAAE,CAAC,cAEnCjF,IAAA,CAACJ,gBAAgB,EAACkH,QAAQ,CAAEvC,IAAI,CAAC9B,EAAG,CAACsE,KAAK,CAAE,CAAE,CAACC,OAAO,MAACC,UAAU,CAAE,KAAM,CAAE,CAAC,EACzE,CACN,GA/D2B1C,IAAI,CAAC9B,EAgE9B,CAAC,CAEV,CAAC,CAAC,CACC,CACN,CAGAN,aAAa,eACZnC,IAAA,CAACH,gBAAgB,EAACsB,MAAM,CAAEgB,aAAc,CAAC+E,OAAO,CAAEA,CAAA,GAAM9E,gBAAgB,CAAC,IAAI,CAAE,CAAE,CAClF,CAGAC,cAAc,eACbrC,IAAA,CAACF,UAAU,EAACqH,MAAM,CAAE9E,cAAe,CAAC6E,OAAO,CAAEA,CAAA,GAAM5E,iBAAiB,CAAC,IAAI,CAAE,CAAE,CAC9E,EACE,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}