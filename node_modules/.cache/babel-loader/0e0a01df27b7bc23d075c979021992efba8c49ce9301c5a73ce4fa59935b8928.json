{"ast":null,"code":"var _jsxFileName = \"/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/loans/RepaymentButton.jsx\",\n  _s = $RefreshSig$();\n// src/features/repayments/RepaymentButton.jsx\nimport React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction getAuthHeader() {\n  let t = localStorage.getItem('token') || '';\n  t = t.replace(/^\"|\"$/g, '');\n  return t ? {\n    Authorization: `Bearer ${t}`\n  } : {};\n}\n\n/**\n * Props:\n *  - loanId: string\n *  - amount: number (installment this period â€“ display only)\n *  - onPaid?: () => void | Promise<void>\n */\nexport default function RepaymentButton({\n  loanId,\n  amount,\n  onPaid\n}) {\n  _s();\n  const [source, setSource] = useState('wallet'); // 'wallet' | 'bank'\n  const [loading, setLoading] = useState(false);\n  const [errorMsg, setErrorMsg] = useState('');\n  const [okMsg, setOkMsg] = useState('');\n  const handlePay = async () => {\n    setLoading(true);\n    setErrorMsg('');\n    setOkMsg('');\n    try {\n      const res = await axios.post(`/api/loans/${loanId}/pay-next`, {\n        source\n      },\n      // ðŸ‘ˆ send selected source\n      {\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeader()\n        },\n        withCredentials: true\n      });\n      setOkMsg('Payment submitted successfully.');\n      if (typeof onPaid === 'function') {\n        await onPaid();\n      }\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error('payNextInstallment error', err);\n      const msg = (err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || (err === null || err === void 0 ? void 0 : err.message) || 'Payment failed';\n      setErrorMsg(msg);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      marginTop: 12\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        flexWrap: 'wrap',\n        gap: 12,\n        alignItems: 'center',\n        marginBottom: 8,\n        fontSize: 13,\n        color: '#475569'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          fontWeight: 600\n        },\n        children: \"Pay from:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'inline-flex',\n          alignItems: 'center',\n          gap: 4\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"radio\",\n          name: `pay-source-${loanId}`,\n          value: \"wallet\",\n          checked: source === 'wallet',\n          onChange: () => setSource('wallet')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this), \"PeerFund wallet balance\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'inline-flex',\n          alignItems: 'center',\n          gap: 4\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"radio\",\n          name: `pay-source-${loanId}`,\n          value: \"bank\",\n          checked: source === 'bank',\n          onChange: () => setSource('bank')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this), \"Linked bank (payment method)\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handlePay,\n      disabled: loading,\n      style: {\n        background: '#4f46e5',\n        color: '#fff',\n        border: '1px solid #4f46e5',\n        padding: '10px 16px',\n        borderRadius: 999,\n        fontWeight: 800,\n        cursor: loading ? 'not-allowed' : 'pointer'\n      },\n      children: loading ? 'Processingâ€¦' : 'Pay next installment'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this), errorMsg && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 6,\n        fontSize: 12,\n        color: '#b91c1c',\n        background: '#fee2e2',\n        borderRadius: 8,\n        padding: '4px 8px'\n      },\n      children: errorMsg\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 9\n    }, this), okMsg && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 6,\n        fontSize: 12,\n        color: '#166534',\n        background: '#dcfce7',\n        borderRadius: 8,\n        padding: '4px 8px'\n      },\n      children: okMsg\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n}\n_s(RepaymentButton, \"oR5TQ1lm7VWH4THkd8DA75qRYs4=\");\n_c = RepaymentButton;\nRepaymentButton.propTypes = {\n  loanId: PropTypes.string.isRequired,\n  amount: PropTypes.number,\n  onPaid: PropTypes.func\n};\nvar _c;\n$RefreshReg$(_c, \"RepaymentButton\");","map":{"version":3,"names":["React","useState","PropTypes","axios","jsxDEV","_jsxDEV","getAuthHeader","t","localStorage","getItem","replace","Authorization","RepaymentButton","loanId","amount","onPaid","_s","source","setSource","loading","setLoading","errorMsg","setErrorMsg","okMsg","setOkMsg","handlePay","res","post","headers","withCredentials","err","_err$response","_err$response$data","console","error","msg","response","data","message","style","marginTop","children","display","flexWrap","gap","alignItems","marginBottom","fontSize","color","fontWeight","fileName","_jsxFileName","lineNumber","columnNumber","type","name","value","checked","onChange","onClick","disabled","background","border","padding","borderRadius","cursor","_c","propTypes","string","isRequired","number","func","$RefreshReg$"],"sources":["/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/loans/RepaymentButton.jsx"],"sourcesContent":["// src/features/repayments/RepaymentButton.jsx\nimport React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport axios from 'axios';\n\nfunction getAuthHeader() {\n  let t = localStorage.getItem('token') || '';\n  t = t.replace(/^\"|\"$/g, '');\n  return t ? { Authorization: `Bearer ${t}` } : {};\n}\n\n/**\n * Props:\n *  - loanId: string\n *  - amount: number (installment this period â€“ display only)\n *  - onPaid?: () => void | Promise<void>\n */\nexport default function RepaymentButton({ loanId, amount, onPaid }) {\n  const [source, setSource] = useState('wallet'); // 'wallet' | 'bank'\n  const [loading, setLoading] = useState(false);\n  const [errorMsg, setErrorMsg] = useState('');\n  const [okMsg, setOkMsg] = useState('');\n\n  const handlePay = async () => {\n    setLoading(true);\n    setErrorMsg('');\n    setOkMsg('');\n\n    try {\n      const res = await axios.post(\n        `/api/loans/${loanId}/pay-next`,\n        { source }, // ðŸ‘ˆ send selected source\n        {\n          headers: {\n            'Content-Type': 'application/json',\n            ...getAuthHeader(),\n          },\n          withCredentials: true,\n        }\n      );\n\n      setOkMsg('Payment submitted successfully.');\n      if (typeof onPaid === 'function') {\n        await onPaid();\n      }\n    } catch (err) {\n      console.error('payNextInstallment error', err);\n      const msg =\n        err?.response?.data?.error ||\n        err?.message ||\n        'Payment failed';\n      setErrorMsg(msg);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div style={{ marginTop: 12 }}>\n     \n      {/* Source selector */}\n      <div\n        style={{\n          display: 'flex',\n          flexWrap: 'wrap',\n          gap: 12,\n          alignItems: 'center',\n          marginBottom: 8,\n          fontSize: 13,\n          color: '#475569',\n        }}\n      >\n        <span style={{ fontWeight: 600 }}>Pay from:</span>\n\n        <label style={{ display: 'inline-flex', alignItems: 'center', gap: 4 }}>\n          <input\n            type=\"radio\"\n            name={`pay-source-${loanId}`}\n            value=\"wallet\"\n            checked={source === 'wallet'}\n            onChange={() => setSource('wallet')}\n          />\n          PeerFund wallet balance\n        </label>\n\n        <label style={{ display: 'inline-flex', alignItems: 'center', gap: 4 }}>\n          <input\n            type=\"radio\"\n            name={`pay-source-${loanId}`}\n            value=\"bank\"\n            checked={source === 'bank'}\n            onChange={() => setSource('bank')}\n          />\n          Linked bank (payment method)\n        </label>\n      </div>\n\n      <button\n        onClick={handlePay}\n        disabled={loading}\n        style={{\n          background: '#4f46e5',\n          color: '#fff',\n          border: '1px solid #4f46e5',\n          padding: '10px 16px',\n          borderRadius: 999,\n          fontWeight: 800,\n          cursor: loading ? 'not-allowed' : 'pointer',\n        }}\n      >\n        {loading ? 'Processingâ€¦' : 'Pay next installment'}\n      </button>\n\n      {errorMsg && (\n        <div\n          style={{\n            marginTop: 6,\n            fontSize: 12,\n            color: '#b91c1c',\n            background: '#fee2e2',\n            borderRadius: 8,\n            padding: '4px 8px',\n          }}\n        >\n          {errorMsg}\n        </div>\n      )}\n\n      {okMsg && (\n        <div\n          style={{\n            marginTop: 6,\n            fontSize: 12,\n            color: '#166534',\n            background: '#dcfce7',\n            borderRadius: 8,\n            padding: '4px 8px',\n          }}\n        >\n          {okMsg}\n        </div>\n      )}\n    </div>\n  );\n}\n\nRepaymentButton.propTypes = {\n  loanId: PropTypes.string.isRequired,\n  amount: PropTypes.number,\n  onPaid: PropTypes.func,\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}