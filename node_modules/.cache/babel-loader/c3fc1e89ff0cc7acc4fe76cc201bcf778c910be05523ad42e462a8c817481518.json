{"ast":null,"code":"var _jsxFileName = \"/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/loans/RepaymentButton.jsx\",\n  _s = $RefreshSig$();\n// src/features/loans/RepaymentButton.jsx\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction getAuthHeaders() {\n  let t = localStorage.getItem('token') || '';\n  t = t.replace(/^\"|\"$/g, '');\n  if (t.toLowerCase().startsWith('bearer ')) t = t.slice(7);\n  return t ? {\n    Authorization: `Bearer ${t}`\n  } : {};\n}\n\n/**\n * Props:\n *  - loanId: string\n *  - onPaid?: () => void   // optional callback after successful payment (e.g. reload summary)\n */\nexport default function RepaymentButton({\n  loanId,\n  onPaid\n}) {\n  _s();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState('');\n  const handlePay = async () => {\n    if (!loanId) return;\n    setLoading(true);\n    setError('');\n    setSuccess('');\n    try {\n      const res = await axios.post(`/api/loans/${loanId}/pay-next`, {}, {\n        headers: {\n          ...getAuthHeaders()\n        }\n      });\n      setSuccess('Payment submitted!');\n      if (typeof onPaid === 'function') {\n        await onPaid();\n      }\n    } catch (e) {\n      var _e$response, _e$response$data;\n      console.error('payNextInstallment error', e);\n      const msg = (e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.error) || (e === null || e === void 0 ? void 0 : e.message) || 'Failed to submit repayment.';\n      setError(msg);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column',\n      gap: 4\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: handlePay,\n      disabled: loading,\n      style: {\n        padding: '6px 12px',\n        borderRadius: 999,\n        border: '1px solid #4f46e5',\n        background: '#4f46e5',\n        color: '#fff',\n        fontSize: 13,\n        fontWeight: 600,\n        cursor: loading ? 'not-allowed' : 'pointer',\n        alignSelf: 'flex-start'\n      },\n      children: loading ? 'Processing…' : 'Pay next installment'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        fontSize: 12,\n        color: '#b91c1c',\n        background: '#fef2f2',\n        borderRadius: 6,\n        padding: '4px 6px',\n        maxWidth: 260\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }, this), success && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        fontSize: 12,\n        color: '#166534',\n        background: '#ecfdf5',\n        borderRadius: 6,\n        padding: '4px 6px',\n        maxWidth: 260\n      },\n      children: success\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 5\n  }, this);\n}\n_s(RepaymentButton, \"E47IYu+wSQ7BjstcfUehFW58aNU=\");\n_c = RepaymentButton;\nvar _c;\n$RefreshReg$(_c, \"RepaymentButton\");","map":{"version":3,"names":["React","useState","axios","jsxDEV","_jsxDEV","getAuthHeaders","t","localStorage","getItem","replace","toLowerCase","startsWith","slice","Authorization","RepaymentButton","loanId","onPaid","_s","loading","setLoading","error","setError","success","setSuccess","handlePay","res","post","headers","e","_e$response","_e$response$data","console","msg","response","data","message","style","display","flexDirection","gap","children","type","onClick","disabled","padding","borderRadius","border","background","color","fontSize","fontWeight","cursor","alignSelf","fileName","_jsxFileName","lineNumber","columnNumber","maxWidth","_c","$RefreshReg$"],"sources":["/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/loans/RepaymentButton.jsx"],"sourcesContent":["// src/features/loans/RepaymentButton.jsx\nimport React, { useState } from 'react';\nimport axios from 'axios';\n\nfunction getAuthHeaders() {\n  let t = localStorage.getItem('token') || '';\n  t = t.replace(/^\"|\"$/g, '');\n  if (t.toLowerCase().startsWith('bearer ')) t = t.slice(7);\n  return t ? { Authorization: `Bearer ${t}` } : {};\n}\n\n/**\n * Props:\n *  - loanId: string\n *  - onPaid?: () => void   // optional callback after successful payment (e.g. reload summary)\n */\nexport default function RepaymentButton({ loanId, onPaid }) {\n  const [loading, setLoading] = useState(false);\n  const [error, setError]   = useState('');\n  const [success, setSuccess] = useState('');\n\n  const handlePay = async () => {\n    if (!loanId) return;\n    setLoading(true);\n    setError('');\n    setSuccess('');\n\n    try {\n      const res = await axios.post(\n        `/api/loans/${loanId}/pay-next`,\n        {},\n        { headers: { ...getAuthHeaders() } }\n      );\n\n      setSuccess('Payment submitted!');\n      if (typeof onPaid === 'function') {\n        await onPaid();\n      }\n    } catch (e) {\n      console.error('payNextInstallment error', e);\n      const msg =\n        e?.response?.data?.error ||\n        e?.message ||\n        'Failed to submit repayment.';\n      setError(msg);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div style={{ display: 'flex', flexDirection: 'column', gap: 4 }}>\n      <button\n        type=\"button\"\n        onClick={handlePay}\n        disabled={loading}\n        style={{\n          padding: '6px 12px',\n          borderRadius: 999,\n          border: '1px solid #4f46e5',\n          background: '#4f46e5',\n          color: '#fff',\n          fontSize: 13,\n          fontWeight: 600,\n          cursor: loading ? 'not-allowed' : 'pointer',\n          alignSelf: 'flex-start',\n        }}\n      >\n        {loading ? 'Processing…' : 'Pay next installment'}\n      </button>\n\n      {error && (\n        <div\n          style={{\n            fontSize: 12,\n            color: '#b91c1c',\n            background: '#fef2f2',\n            borderRadius: 6,\n            padding: '4px 6px',\n            maxWidth: 260,\n          }}\n        >\n          {error}\n        </div>\n      )}\n\n      {success && (\n        <div\n          style={{\n            fontSize: 12,\n            color: '#166534',\n            background: '#ecfdf5',\n            borderRadius: 6,\n            padding: '4px 6px',\n            maxWidth: 260,\n          }}\n        >\n          {success}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}