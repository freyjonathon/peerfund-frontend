{"ast":null,"code":"var _jsxFileName = \"/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/dashboard/MoneySummary.jsx\",\n  _s = $RefreshSig$();\n// src/features/money/MoneySummary.jsx\nimport React, { useEffect, useState, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './MoneySummary.css';\nimport UserProfileModal from '../../components/UserProfileModal';\nimport LoanThreadModal from '../loans/LoanThreadModal';\n\n// ---- helpers --------------------------------------------------------\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction getCurrentUserId() {\n  const t = localStorage.getItem('token');\n  if (!t) return null;\n  try {\n    var _payload$userId;\n    const payload = JSON.parse(atob(t.split('.')[1] || ''));\n    return (_payload$userId = payload === null || payload === void 0 ? void 0 : payload.userId) !== null && _payload$userId !== void 0 ? _payload$userId : null;\n  } catch {\n    return null;\n  }\n}\nconst fmtMoney = n => typeof n === 'number' && !Number.isNaN(n) ? `$${n.toFixed(2)}` : 'â€”';\nconst ROW_GRID = {\n  display: 'grid',\n  gridTemplateColumns: 'minmax(160px,1fr) 140px 180px auto auto',\n  alignItems: 'center',\n  gap: 16\n};\nasync function authFetch(url, options = {}) {\n  const token = localStorage.getItem('token');\n  const headers = {\n    ...(options.headers || {}),\n    ...(token ? {\n      Authorization: `Bearer ${token}`\n    } : {})\n  };\n  const res = await fetch(url, {\n    ...options,\n    headers,\n    credentials: 'include'\n  });\n  if (res.status === 401) {\n    try {\n      console.warn('401 on', url, await res.text());\n    } catch {}\n    window.location.assign('/login');\n    throw new Error('Unauthorized');\n  }\n  return res;\n}\n\n// small concurrency limiter for N+1 calls\nasync function limitedMap(items, limit, fn) {\n  const out = [];\n  let i = 0;\n  async function worker() {\n    while (i < items.length) {\n      const idx = i++;\n      out[idx] = await fn(items[idx], idx);\n    }\n  }\n  const runners = Array(Math.min(limit, items.length)).fill(0).map(worker);\n  await Promise.all(runners);\n  return out;\n}\n\n// ---- row component --------------------------------------------------\n\nfunction OpenRequestRow({\n  req,\n  isExpanded,\n  onToggle,\n  actionLoading,\n  acceptRequest,\n  declineRequest\n}) {\n  var _req$status;\n  // For market requests where *you are lending*, you canâ€™t accept/decline (borrower does that)\n  const isMarketLending = req.type === 'market' && req.role === 'Lending';\n  const showActions = !isMarketLending;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ms-card\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-card-row\",\n      style: ROW_GRID,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-label\",\n          children: \"Counterparty\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-value-strong\",\n          children: [req.counterpartyName || 'Unknown', /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              marginLeft: 8,\n              color: '#64748b',\n              fontWeight: 600\n            },\n            children: [\"\\u2022 \", req.role]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-label\",\n          children: \"Amount\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-value-strong\",\n          children: fmtMoney(req.amount)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-label\",\n          children: \"Created\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-value-strong\",\n          children: req.createdAt ? new Date(req.createdAt).toLocaleDateString() : 'â€”'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          justifySelf: 'end'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"ms-badge ms-badge--warn\",\n          children: \"Open\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          justifySelf: 'end'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"action-btn\",\n          onClick: onToggle,\n          title: \"View request details\",\n          children: isExpanded ? 'ðŸ”½ Hide' : 'ðŸ“„ View'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), isExpanded && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-details\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Your role:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 31\n        }, this), \" \", req.role]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Status:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 31\n        }, this), \" \", (_req$status = req.status) !== null && _req$status !== void 0 ? _req$status : 'OPEN']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Interest Rate:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 13\n        }, this), ' ', Number.isFinite(req.interestRate) ? `${req.interestRate}%` : 'â€”']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Duration:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 13\n        }, this), ' ', Number.isFinite(req.duration) ? `${req.duration} months` : 'â€”']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }, this), req.purpose && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Reason:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 15\n        }, this), \" \", req.purpose]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 13\n      }, this), req.myOffer && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        style: {\n          color: '#475569'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Your Offer:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 15\n        }, this), ' ', fmtMoney(req.myOffer.amount), \" \\u2022 \", req.myOffer.interestRate, \"% \\u2022 \", req.myOffer.duration, \" mo\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 13\n      }, this), showActions && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-8\",\n        style: {\n          display: 'flex',\n          gap: 8,\n          justifyContent: 'flex-end'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"action-btn primary\",\n          onClick: () => acceptRequest(req),\n          disabled: !!actionLoading[req.id],\n          children: actionLoading[req.id] ? 'Workingâ€¦' : 'Accept'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"action-btn\",\n          onClick: () => declineRequest(req),\n          disabled: !!actionLoading[req.id],\n          children: actionLoading[req.id] ? 'Workingâ€¦' : 'Decline'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }, this)]\n  }, req.id, true, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n}\n\n// ---- main component -------------------------------------------------\n_c = OpenRequestRow;\nconst MoneySummary = () => {\n  _s();\n  const [summary, setSummary] = useState({\n    loansGiven: [],\n    loansReceived: [],\n    myOpenRequests: []\n  });\n  const [loading, setLoading] = useState(true);\n  const [expandedLoans, setExpandedLoans] = useState({});\n  const [openSec, setOpenSec] = useState({\n    open: true,\n    given: true,\n    received: true\n  });\n  const [payLoading, setPayLoading] = useState({});\n  const [actionLoading, setActionLoading] = useState({});\n  const [threadLoanId, setThreadLoanId] = useState(null);\n  const navigate = useNavigate();\n\n  // -------- market: only requests I've offered on ----------\n  const fetchMarketRequestsOfferedByMe = async () => {\n    const me = getCurrentUserId();\n    if (!me) return [];\n\n    // 1) open requests\n    let open = [];\n    try {\n      const r = await authFetch('/api/loans/open');\n      if (r.ok) {\n        const raw = await r.json();\n        open = Array.isArray(raw) ? raw : (raw === null || raw === void 0 ? void 0 : raw.items) || [];\n      }\n    } catch {}\n    if (!open.length) return [];\n\n    // Map by id for quick lookup\n    const byId = new Map(open.map(r => [r.id, r]));\n\n    // 2) pull offers for each (limited parallelism)\n    const offersPerRequest = await limitedMap(open, 6, async req => {\n      try {\n        const rr = await authFetch(`/api/loans/${req.id}/offers`);\n        if (!rr.ok) return {\n          id: req.id,\n          mine: null\n        };\n        const offers = await rr.json();\n        const mine = (Array.isArray(offers) ? offers : []).find(o => {\n          var _o$lender;\n          return (o.lenderId || (o === null || o === void 0 ? void 0 : (_o$lender = o.lender) === null || _o$lender === void 0 ? void 0 : _o$lender.id)) === me;\n        });\n        return {\n          id: req.id,\n          mine: mine || null\n        };\n      } catch {\n        return {\n          id: req.id,\n          mine: null\n        };\n      }\n    });\n\n    // 3) keep only the ones where I have an offer\n    const rows = offersPerRequest.filter(x => x.mine).map(({\n      id,\n      mine\n    }) => {\n      var _req$borrower, _req$borrower2, _mine$interestRate;\n      const req = byId.get(id);\n      const borrowerId = (req === null || req === void 0 ? void 0 : (_req$borrower = req.borrower) === null || _req$borrower === void 0 ? void 0 : _req$borrower.id) || (req === null || req === void 0 ? void 0 : req.borrowerId);\n      const borrowerName = (req === null || req === void 0 ? void 0 : (_req$borrower2 = req.borrower) === null || _req$borrower2 === void 0 ? void 0 : _req$borrower2.name) || 'Borrower';\n      return {\n        type: 'market',\n        id,\n        amount: Number(req === null || req === void 0 ? void 0 : req.amount),\n        duration: Number(req === null || req === void 0 ? void 0 : req.duration),\n        interestRate: Number((_mine$interestRate = mine.interestRate) !== null && _mine$interestRate !== void 0 ? _mine$interestRate : req === null || req === void 0 ? void 0 : req.interestRate),\n        purpose: (req === null || req === void 0 ? void 0 : req.purpose) || '',\n        createdAt: (req === null || req === void 0 ? void 0 : req.createdAt) || null,\n        borrowerId,\n        counterpartyName: borrowerName,\n        role: 'Lending',\n        status: (req === null || req === void 0 ? void 0 : req.status) || 'OPEN',\n        myOffer: {\n          id: mine.id,\n          amount: Number(mine.amount),\n          duration: Number(mine.duration),\n          interestRate: Number(mine.interestRate)\n        }\n      };\n    });\n\n    // newest first\n    rows.sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));\n    return rows;\n  };\n\n  // -------- direct requests I'm involved in ----------\n  const fetchDirectOpenRequests = async () => {\n    const me = getCurrentUserId();\n    if (!me) return [];\n    try {\n      const r = await authFetch('/api/direct-requests/open/mine');\n      if (!r.ok) return [];\n      const rows = await r.json();\n      return (Array.isArray(rows) ? rows : []).map(d => {\n        var _d$borrower, _d$months, _d$apr, _d$lender, _d$borrower2;\n        const borrowerId = d.borrowerId || (d === null || d === void 0 ? void 0 : (_d$borrower = d.borrower) === null || _d$borrower === void 0 ? void 0 : _d$borrower.id);\n        const iAmBorrower = String(borrowerId) === String(me);\n        return {\n          type: 'direct',\n          id: d.id,\n          amount: Number(d.amount),\n          duration: Number((_d$months = d.months) !== null && _d$months !== void 0 ? _d$months : d.duration),\n          interestRate: Number((_d$apr = d.apr) !== null && _d$apr !== void 0 ? _d$apr : d.interestRate),\n          createdAt: d.createdAt || null,\n          counterpartyName: iAmBorrower ? (d === null || d === void 0 ? void 0 : (_d$lender = d.lender) === null || _d$lender === void 0 ? void 0 : _d$lender.name) || 'Lender' : (d === null || d === void 0 ? void 0 : (_d$borrower2 = d.borrower) === null || _d$borrower2 === void 0 ? void 0 : _d$borrower2.name) || 'Borrower',\n          role: iAmBorrower ? 'Borrowing' : 'Lending',\n          status: d.status || 'PENDING'\n        };\n      });\n    } catch {\n      return [];\n    }\n  };\n\n  // -------- money summary + merge ----------\n  const fetchSummary = useCallback(async () => {\n    const token = localStorage.getItem('token');\n    if (!token) return;\n    setLoading(true);\n    try {\n      let loansGiven = [];\n      let loansReceived = [];\n      try {\n        const res = await authFetch('/api/users/my-money-summary');\n        if (res.ok) {\n          const data = await res.json();\n          loansGiven = Array.isArray(data.loansGiven) ? data.loansGiven : Array.isArray(data.loansAsLender) ? data.loansAsLender : [];\n          loansReceived = Array.isArray(data.loansReceived) ? data.loansReceived : Array.isArray(data.loansAsBorrower) ? data.loansAsBorrower : [];\n        }\n      } catch {}\n      const [marketTracked, directOpen] = await Promise.all([fetchMarketRequestsOfferedByMe(), fetchDirectOpenRequests()]);\n      setSummary({\n        loansGiven,\n        loansReceived,\n        myOpenRequests: [...marketTracked, ...directOpen]\n      });\n    } catch (err) {\n      console.error('Error fetching money summary:', err);\n      setSummary({\n        loansGiven: [],\n        loansReceived: [],\n        myOpenRequests: []\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(() => {\n    fetchSummary();\n  }, [fetchSummary]);\n\n  // ---- actions (only relevant for \"direct\" rows) --------------------\n\n  const actionPaths = {\n    direct: {\n      accept: id => [`/api/direct-requests/${id}/accept`, `/api/direct-requests/${id}/approve`, `/api/direct-requests/${id}/respond?action=ACCEPT`],\n      decline: id => [`/api/direct-requests/${id}/decline`, `/api/direct-requests/${id}/reject`, `/api/direct-requests/${id}/respond?action=DECLINE`]\n    }\n  };\n  async function tryVerbs(url, body) {\n    const optionsBase = {\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: body ? JSON.stringify(body) : undefined\n    };\n    const verbs = ['POST', 'PUT', 'PATCH'];\n    let lastErr = null;\n    for (const method of verbs) {\n      try {\n        const r = await authFetch(url, {\n          method,\n          ...optionsBase\n        });\n        if (r.ok) return r;\n        const txt = await r.text().catch(() => '');\n        lastErr = new Error(`${r.status} ${r.statusText}${txt ? ` â€¢ ${txt}` : ''}`);\n      } catch (e) {\n        lastErr = e;\n      }\n    }\n    throw lastErr || new Error('All methods failed');\n  }\n  const callAction = async (type, id, which) => {\n    setActionLoading(m => ({\n      ...m,\n      [id]: true\n    }));\n    try {\n      var _actionPaths$type, _actionPaths$type$whi;\n      const urls = ((_actionPaths$type = actionPaths[type]) === null || _actionPaths$type === void 0 ? void 0 : (_actionPaths$type$whi = _actionPaths$type[which]) === null || _actionPaths$type$whi === void 0 ? void 0 : _actionPaths$type$whi.call(_actionPaths$type, id)) || [];\n      if (!urls.length) throw new Error(`Unknown action: ${type}.${which}`);\n      let ok = false;\n      let lastError = null;\n      for (const url of urls) {\n        try {\n          await tryVerbs(url);\n          ok = true;\n          break;\n        } catch (e) {\n          lastError = e;\n        }\n      }\n      if (!ok) throw lastError || new Error('No endpoint accepted this action');\n      await fetchSummary();\n    } catch (e) {\n      console.error(e);\n      alert(`Action failed:\\n${e.message || e}`);\n    } finally {\n      setActionLoading(m => ({\n        ...m,\n        [id]: false\n      }));\n    }\n  };\n  const acceptRequest = req => req.type === 'direct' && callAction('direct', req.id, 'accept');\n  const declineRequest = req => req.type === 'direct' && callAction('direct', req.id, 'decline');\n\n  // ---- loan cards (unchanged) --------------------------------------\n\n  const loanKey = (loan, idx) => (loan === null || loan === void 0 ? void 0 : loan.id) || (loan === null || loan === void 0 ? void 0 : loan._id) || String(idx);\n  const toggleLoanDetails = id => {\n    setExpandedLoans(prev => ({\n      ...Object.keys(prev).reduce((acc, k) => ({\n        ...acc,\n        [k]: false\n      }), {}),\n      [id]: !prev[id]\n    }));\n  };\n  const payNext = async loan => {\n    var _loan$installmentAmou;\n    const key = loanKey(loan);\n    const amount = (_loan$installmentAmou = loan === null || loan === void 0 ? void 0 : loan.installmentAmount) !== null && _loan$installmentAmou !== void 0 ? _loan$installmentAmou : 0;\n    if (!window.confirm(`Pay the next installment (${fmtMoney(amount)})?`)) return;\n    try {\n      setPayLoading(m => ({\n        ...m,\n        [key]: true\n      }));\n      const res = await authFetch(`/api/loans/${loan.id || loan._id}/pay-next`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      const data = await res.json();\n      if (!res.ok) throw new Error((data === null || data === void 0 ? void 0 : data.error) || 'Payment failed');\n      const paid = typeof data.amount === 'number' ? data.amount : amount;\n      alert(`Payment successful! Amount: ${fmtMoney(paid)}`);\n      await fetchSummary();\n    } catch (e) {\n      alert(e.message);\n    } finally {\n      setPayLoading(m => ({\n        ...m,\n        [key]: false\n      }));\n    }\n  };\n  const renderLoanCard = (loan, isLender, idx) => {\n    const key = loanKey(loan, idx);\n    const isExpanded = !!expandedLoans[key];\n    const otherParty = isLender ? loan.borrowerName : loan.lenderName;\n    const canPay = !isLender && typeof loan.installmentAmount === 'number' && loan.installmentAmount > 0 && !!loan.nextDueDate;\n    const badgeClass = (loan.status || '').toUpperCase() === 'FUNDED' ? 'ms-badge ms-badge--ok' : 'ms-badge ms-badge--warn';\n    const fundedDate = loan.fundedDate ? new Date(loan.fundedDate).toLocaleDateString() : 'â€”';\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-card-row\",\n        style: ROW_GRID,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-label\",\n            children: isLender ? 'Borrower' : 'Lender'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 441,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-value-strong\",\n            children: otherParty || 'Unknown'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 442,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-label\",\n            children: \"Amount\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 445,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-value-strong\",\n            children: fmtMoney(loan.amount)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 446,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 444,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-label\",\n            children: \"Funded Date\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 449,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-value-strong\",\n            children: fundedDate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 450,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            justifySelf: 'end'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: badgeClass,\n            children: loan.status || 'â€”'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 453,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 452,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            justifySelf: 'end',\n            display: 'flex',\n            gap: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setThreadLoanId(loan.id || loan._id),\n            className: \"action-btn\",\n            title: \"Open conversation\",\n            children: \"\\uD83D\\uDCAC Messages\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 456,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => toggleLoanDetails(key),\n            className: \"action-btn\",\n            title: \"View contract\",\n            children: isExpanded ? 'ðŸ”½ Hide' : 'ðŸ“„ View'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 463,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 455,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 439,\n        columnNumber: 9\n      }, this), isExpanded && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-details\",\n        children: [loan.status && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Status:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 17\n          }, this), \" \", loan.status]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 472,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Interest Rate:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 477,\n            columnNumber: 15\n          }, this), ' ', typeof loan.interestRate === 'number' ? `${loan.interestRate}%` : 'â€”']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 476,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Duration:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 481,\n            columnNumber: 15\n          }, this), ' ', typeof loan.duration === 'number' ? `${loan.duration} months` : 'â€”']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Next Due Date:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 485,\n            columnNumber: 15\n          }, this), ' ', loan.nextDueDate ? new Date(loan.nextDueDate).toLocaleDateString() : 'â€”']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 484,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Installment (this period):\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 489,\n            columnNumber: 15\n          }, this), \" \", fmtMoney(loan.installmentAmount)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 488,\n          columnNumber: 13\n        }, this), isLender && typeof loan.amountCollected === 'number' && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Amount collected on loan:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 494,\n            columnNumber: 17\n          }, this), \" \", fmtMoney(loan.amountCollected)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 493,\n          columnNumber: 15\n        }, this), !isLender && canPay && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-6\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"action-btn primary\",\n            onClick: () => payNext(loan),\n            disabled: !!payLoading[key],\n            title: \"Pay next installment\",\n            children: payLoading[key] ? 'Processingâ€¦' : 'ðŸ’³ Make Payment'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 500,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 499,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 470,\n        columnNumber: 11\n      }, this)]\n    }, key, true, {\n      fileName: _jsxFileName,\n      lineNumber: 438,\n      columnNumber: 7\n    }, this);\n  };\n\n  // ---- render -------------------------------------------------------\n\n  if (loading) return /*#__PURE__*/_jsxDEV(\"p\", {\n    className: \"ms-loading ms-container\",\n    children: \"Loading money summary...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 518,\n    columnNumber: 23\n  }, this);\n  const given = Array.isArray(summary.loansGiven) ? summary.loansGiven : [];\n  const received = Array.isArray(summary.loansReceived) ? summary.loansReceived : [];\n  const myOpen = Array.isArray(summary.myOpenRequests) ? summary.myOpenRequests : [];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ms-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"ms-heading\",\n      children: \"\\uD83D\\uDCB5 My Money Summary\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 526,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ms-section-head\",\n        onClick: () => setOpenSec(s => ({\n          ...s,\n          open: !s.open\n        })),\n        \"aria-expanded\": openSec.open,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-subheading\",\n          children: \"My Open Loan Requests\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-caret\",\n          children: openSec.open ? 'â–¾' : 'â–¸'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 536,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 530,\n        columnNumber: 9\n      }, this), openSec.open && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-section-body\",\n        children: myOpen.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"ms-empty\",\n          children: \"You have no open direct requests and haven\\u2019t made any offers on market requests yet.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 541,\n          columnNumber: 15\n        }, this) : myOpen.map(req => /*#__PURE__*/_jsxDEV(OpenRequestRow, {\n          req: req,\n          isExpanded: !!expandedLoans[req.id],\n          onToggle: () => toggleLoanDetails(req.id),\n          actionLoading: actionLoading,\n          acceptRequest: acceptRequest,\n          declineRequest: declineRequest\n        }, req.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 546,\n          columnNumber: 17\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 539,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 529,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ms-section-head\",\n        onClick: () => setOpenSec(s => ({\n          ...s,\n          given: !s.given\n        })),\n        \"aria-expanded\": openSec.given,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-subheading\",\n          children: \"Loans Given (I'm the Lender)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 568,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-caret\",\n          children: openSec.given ? 'â–¾' : 'â–¸'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 569,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 563,\n        columnNumber: 9\n      }, this), openSec.given && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-section-body\",\n        children: given.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"ms-empty\",\n          children: \"No loans given yet.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 574,\n          columnNumber: 15\n        }, this) : given.map((loan, idx) => renderLoanCard(loan, true, idx))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 572,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 562,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ms-section-head\",\n        onClick: () => setOpenSec(s => ({\n          ...s,\n          received: !s.received\n        })),\n        \"aria-expanded\": openSec.received,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-subheading\",\n          children: \"Loans Received (I'm the Borrower)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 589,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-caret\",\n          children: openSec.received ? 'â–¾' : 'â–¸'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 590,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 584,\n        columnNumber: 9\n      }, this), openSec.received && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-section-body\",\n        children: received.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"ms-empty\",\n          children: \"No loans received yet.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 595,\n          columnNumber: 15\n        }, this) : received.map((loan, idx) => renderLoanCard(loan, false, idx))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 593,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 583,\n      columnNumber: 7\n    }, this), threadLoanId && /*#__PURE__*/_jsxDEV(LoanThreadModal, {\n      loanId: threadLoanId,\n      onClose: () => setThreadLoanId(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 604,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 525,\n    columnNumber: 5\n  }, this);\n};\n_s(MoneySummary, \"gRkXePKWO75lsCb3pIUlivcYPYE=\", false, function () {\n  return [useNavigate];\n});\n_c2 = MoneySummary;\nexport default MoneySummary;\nvar _c, _c2;\n$RefreshReg$(_c, \"OpenRequestRow\");\n$RefreshReg$(_c2, \"MoneySummary\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","useNavigate","UserProfileModal","LoanThreadModal","jsxDEV","_jsxDEV","getCurrentUserId","t","localStorage","getItem","_payload$userId","payload","JSON","parse","atob","split","userId","fmtMoney","n","Number","isNaN","toFixed","ROW_GRID","display","gridTemplateColumns","alignItems","gap","authFetch","url","options","token","headers","Authorization","res","fetch","credentials","status","console","warn","text","window","location","assign","Error","limitedMap","items","limit","fn","out","i","worker","length","idx","runners","Array","Math","min","fill","map","Promise","all","OpenRequestRow","req","isExpanded","onToggle","actionLoading","acceptRequest","declineRequest","_req$status","isMarketLending","type","role","showActions","className","children","style","fileName","_jsxFileName","lineNumber","columnNumber","counterpartyName","marginLeft","color","fontWeight","amount","createdAt","Date","toLocaleDateString","justifySelf","onClick","title","isFinite","interestRate","duration","purpose","myOffer","justifyContent","disabled","id","_c","MoneySummary","_s","summary","setSummary","loansGiven","loansReceived","myOpenRequests","loading","setLoading","expandedLoans","setExpandedLoans","openSec","setOpenSec","open","given","received","payLoading","setPayLoading","setActionLoading","threadLoanId","setThreadLoanId","navigate","fetchMarketRequestsOfferedByMe","me","r","ok","raw","json","isArray","byId","Map","offersPerRequest","rr","mine","offers","find","o","_o$lender","lenderId","lender","rows","filter","x","_req$borrower","_req$borrower2","_mine$interestRate","get","borrowerId","borrower","borrowerName","name","sort","a","b","fetchDirectOpenRequests","d","_d$borrower","_d$months","_d$apr","_d$lender","_d$borrower2","iAmBorrower","String","months","apr","fetchSummary","data","loansAsLender","loansAsBorrower","marketTracked","directOpen","err","error","actionPaths","direct","accept","decline","tryVerbs","body","optionsBase","stringify","undefined","verbs","lastErr","method","txt","catch","statusText","e","callAction","which","m","_actionPaths$type","_actionPaths$type$whi","urls","call","lastError","alert","message","loanKey","loan","_id","toggleLoanDetails","prev","Object","keys","reduce","acc","k","payNext","_loan$installmentAmou","key","installmentAmount","confirm","paid","renderLoanCard","isLender","otherParty","lenderName","canPay","nextDueDate","badgeClass","toUpperCase","fundedDate","amountCollected","myOpen","s","loanId","onClose","_c2","$RefreshReg$"],"sources":["/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/dashboard/MoneySummary.jsx"],"sourcesContent":["// src/features/money/MoneySummary.jsx\r\nimport React, { useEffect, useState, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport './MoneySummary.css';\r\nimport UserProfileModal from '../../components/UserProfileModal';\r\nimport LoanThreadModal from '../loans/LoanThreadModal';\r\n\r\n// ---- helpers --------------------------------------------------------\r\n\r\nfunction getCurrentUserId() {\r\n  const t = localStorage.getItem('token');\r\n  if (!t) return null;\r\n  try {\r\n    const payload = JSON.parse(atob(t.split('.')[1] || ''));\r\n    return payload?.userId ?? null;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nconst fmtMoney = (n) =>\r\n  typeof n === 'number' && !Number.isNaN(n) ? `$${n.toFixed(2)}` : 'â€”';\r\n\r\nconst ROW_GRID = {\r\n  display: 'grid',\r\n  gridTemplateColumns: 'minmax(160px,1fr) 140px 180px auto auto',\r\n  alignItems: 'center',\r\n  gap: 16,\r\n};\r\n\r\nasync function authFetch(url, options = {}) {\r\n  const token = localStorage.getItem('token');\r\n  const headers = {\r\n    ...(options.headers || {}),\r\n    ...(token ? { Authorization: `Bearer ${token}` } : {}),\r\n  };\r\n  const res = await fetch(url, {\r\n    ...options,\r\n    headers,\r\n    credentials: 'include',\r\n  });\r\n  if (res.status === 401) {\r\n    try { console.warn('401 on', url, await res.text()); } catch {}\r\n    window.location.assign('/login');\r\n    throw new Error('Unauthorized');\r\n  }\r\n  return res;\r\n}\r\n\r\n// small concurrency limiter for N+1 calls\r\nasync function limitedMap(items, limit, fn) {\r\n  const out = [];\r\n  let i = 0;\r\n  async function worker() {\r\n    while (i < items.length) {\r\n      const idx = i++;\r\n      out[idx] = await fn(items[idx], idx);\r\n    }\r\n  }\r\n  const runners = Array(Math.min(limit, items.length)).fill(0).map(worker);\r\n  await Promise.all(runners);\r\n  return out;\r\n}\r\n\r\n// ---- row component --------------------------------------------------\r\n\r\nfunction OpenRequestRow({\r\n  req,\r\n  isExpanded,\r\n  onToggle,\r\n  actionLoading,\r\n  acceptRequest,\r\n  declineRequest,\r\n}) {\r\n  // For market requests where *you are lending*, you canâ€™t accept/decline (borrower does that)\r\n  const isMarketLending = req.type === 'market' && req.role === 'Lending';\r\n  const showActions = !isMarketLending;\r\n\r\n  return (\r\n    <div className=\"ms-card\" key={req.id}>\r\n      <div className=\"ms-card-row\" style={ROW_GRID}>\r\n        <div>\r\n          <div className=\"ms-label\">Counterparty</div>\r\n          <div className=\"ms-value-strong\">\r\n            {req.counterpartyName || 'Unknown'}\r\n            <span style={{ marginLeft: 8, color: '#64748b', fontWeight: 600 }}>\r\n              â€¢ {req.role}\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <div className=\"ms-label\">Amount</div>\r\n          <div className=\"ms-value-strong\">{fmtMoney(req.amount)}</div>\r\n        </div>\r\n\r\n        <div>\r\n          <div className=\"ms-label\">Created</div>\r\n          <div className=\"ms-value-strong\">\r\n            {req.createdAt ? new Date(req.createdAt).toLocaleDateString() : 'â€”'}\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ justifySelf: 'end' }}>\r\n          <span className=\"ms-badge ms-badge--warn\">Open</span>\r\n        </div>\r\n\r\n        <div style={{ justifySelf: 'end' }}>\r\n          <button className=\"action-btn\" onClick={onToggle} title=\"View request details\">\r\n            {isExpanded ? 'ðŸ”½ Hide' : 'ðŸ“„ View'}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {isExpanded && (\r\n        <div className=\"ms-details\">\r\n          <p className=\"mt-6\"><strong>Your role:</strong> {req.role}</p>\r\n          <p className=\"mt-6\"><strong>Status:</strong> {req.status ?? 'OPEN'}</p>\r\n          <p className=\"mt-6\">\r\n            <strong>Interest Rate:</strong>{' '}\r\n            {Number.isFinite(req.interestRate) ? `${req.interestRate}%` : 'â€”'}\r\n          </p>\r\n          <p className=\"mt-6\">\r\n            <strong>Duration:</strong>{' '}\r\n            {Number.isFinite(req.duration) ? `${req.duration} months` : 'â€”'}\r\n          </p>\r\n          {req.purpose && (\r\n            <p className=\"mt-6\">\r\n              <strong>Reason:</strong> {req.purpose}\r\n            </p>\r\n          )}\r\n          {req.myOffer && (\r\n            <p className=\"mt-6\" style={{ color: '#475569' }}>\r\n              <strong>Your Offer:</strong>{' '}\r\n              {fmtMoney(req.myOffer.amount)} â€¢ {req.myOffer.interestRate}% â€¢ {req.myOffer.duration} mo\r\n            </p>\r\n          )}\r\n\r\n          {showActions && (\r\n            <div className=\"mt-8\" style={{ display: 'flex', gap: 8, justifyContent: 'flex-end' }}>\r\n              <button\r\n                className=\"action-btn primary\"\r\n                onClick={() => acceptRequest(req)}\r\n                disabled={!!actionLoading[req.id]}\r\n              >\r\n                {actionLoading[req.id] ? 'Workingâ€¦' : 'Accept'}\r\n              </button>\r\n              <button\r\n                className=\"action-btn\"\r\n                onClick={() => declineRequest(req)}\r\n                disabled={!!actionLoading[req.id]}\r\n              >\r\n                {actionLoading[req.id] ? 'Workingâ€¦' : 'Decline'}\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// ---- main component -------------------------------------------------\r\n\r\nconst MoneySummary = () => {\r\n  const [summary, setSummary] = useState({\r\n    loansGiven: [],\r\n    loansReceived: [],\r\n    myOpenRequests: [],\r\n  });\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [expandedLoans, setExpandedLoans] = useState({});\r\n  const [openSec, setOpenSec] = useState({ open: true, given: true, received: true });\r\n\r\n  const [payLoading, setPayLoading] = useState({});\r\n  const [actionLoading, setActionLoading] = useState({});\r\n  const [threadLoanId, setThreadLoanId] = useState(null);\r\n\r\n  const navigate = useNavigate();\r\n\r\n  // -------- market: only requests I've offered on ----------\r\n  const fetchMarketRequestsOfferedByMe = async () => {\r\n    const me = getCurrentUserId();\r\n    if (!me) return [];\r\n\r\n    // 1) open requests\r\n    let open = [];\r\n    try {\r\n      const r = await authFetch('/api/loans/open');\r\n      if (r.ok) {\r\n        const raw = await r.json();\r\n        open = Array.isArray(raw) ? raw : raw?.items || [];\r\n      }\r\n    } catch {}\r\n\r\n    if (!open.length) return [];\r\n\r\n    // Map by id for quick lookup\r\n    const byId = new Map(open.map((r) => [r.id, r]));\r\n\r\n    // 2) pull offers for each (limited parallelism)\r\n    const offersPerRequest = await limitedMap(open, 6, async (req) => {\r\n      try {\r\n        const rr = await authFetch(`/api/loans/${req.id}/offers`);\r\n        if (!rr.ok) return { id: req.id, mine: null };\r\n        const offers = await rr.json();\r\n        const mine = (Array.isArray(offers) ? offers : []).find(\r\n          (o) => (o.lenderId || o?.lender?.id) === me\r\n        );\r\n        return { id: req.id, mine: mine || null };\r\n      } catch {\r\n        return { id: req.id, mine: null };\r\n      }\r\n    });\r\n\r\n    // 3) keep only the ones where I have an offer\r\n    const rows = offersPerRequest\r\n      .filter((x) => x.mine)\r\n      .map(({ id, mine }) => {\r\n        const req = byId.get(id);\r\n        const borrowerId = req?.borrower?.id || req?.borrowerId;\r\n        const borrowerName = req?.borrower?.name || 'Borrower';\r\n        return {\r\n          type: 'market',\r\n          id,\r\n          amount: Number(req?.amount),\r\n          duration: Number(req?.duration),\r\n          interestRate: Number(mine.interestRate ?? req?.interestRate),\r\n          purpose: req?.purpose || '',\r\n          createdAt: req?.createdAt || null,\r\n          borrowerId,\r\n          counterpartyName: borrowerName,\r\n          role: 'Lending',\r\n          status: req?.status || 'OPEN',\r\n          myOffer: {\r\n            id: mine.id,\r\n            amount: Number(mine.amount),\r\n            duration: Number(mine.duration),\r\n            interestRate: Number(mine.interestRate),\r\n          },\r\n        };\r\n      });\r\n\r\n    // newest first\r\n    rows.sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));\r\n    return rows;\r\n  };\r\n\r\n  // -------- direct requests I'm involved in ----------\r\n  const fetchDirectOpenRequests = async () => {\r\n    const me = getCurrentUserId();\r\n    if (!me) return [];\r\n\r\n    try {\r\n      const r = await authFetch('/api/direct-requests/open/mine');\r\n      if (!r.ok) return [];\r\n      const rows = await r.json();\r\n      return (Array.isArray(rows) ? rows : []).map((d) => {\r\n        const borrowerId = d.borrowerId || d?.borrower?.id;\r\n        const iAmBorrower = String(borrowerId) === String(me);\r\n        return {\r\n          type: 'direct',\r\n          id: d.id,\r\n          amount: Number(d.amount),\r\n          duration: Number(d.months ?? d.duration),\r\n          interestRate: Number(d.apr ?? d.interestRate),\r\n          createdAt: d.createdAt || null,\r\n          counterpartyName: iAmBorrower ? (d?.lender?.name || 'Lender') : (d?.borrower?.name || 'Borrower'),\r\n          role: iAmBorrower ? 'Borrowing' : 'Lending',\r\n          status: d.status || 'PENDING',\r\n        };\r\n      });\r\n    } catch {\r\n      return [];\r\n    }\r\n  };\r\n\r\n  // -------- money summary + merge ----------\r\n  const fetchSummary = useCallback(async () => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) return;\r\n    setLoading(true);\r\n    try {\r\n      let loansGiven = [];\r\n      let loansReceived = [];\r\n      try {\r\n        const res = await authFetch('/api/users/my-money-summary');\r\n        if (res.ok) {\r\n          const data = await res.json();\r\n          loansGiven = Array.isArray(data.loansGiven)\r\n            ? data.loansGiven\r\n            : Array.isArray(data.loansAsLender)\r\n            ? data.loansAsLender\r\n            : [];\r\n          loansReceived = Array.isArray(data.loansReceived)\r\n            ? data.loansReceived\r\n            : Array.isArray(data.loansAsBorrower)\r\n            ? data.loansAsBorrower\r\n            : [];\r\n        }\r\n      } catch {}\r\n\r\n      const [marketTracked, directOpen] = await Promise.all([\r\n        fetchMarketRequestsOfferedByMe(),\r\n        fetchDirectOpenRequests(),\r\n      ]);\r\n\r\n      setSummary({\r\n        loansGiven,\r\n        loansReceived,\r\n        myOpenRequests: [...marketTracked, ...directOpen],\r\n      });\r\n    } catch (err) {\r\n      console.error('Error fetching money summary:', err);\r\n      setSummary({ loansGiven: [], loansReceived: [], myOpenRequests: [] });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    fetchSummary();\r\n  }, [fetchSummary]);\r\n\r\n  // ---- actions (only relevant for \"direct\" rows) --------------------\r\n\r\n  const actionPaths = {\r\n    direct: {\r\n      accept: (id) => [\r\n        `/api/direct-requests/${id}/accept`,\r\n        `/api/direct-requests/${id}/approve`,\r\n        `/api/direct-requests/${id}/respond?action=ACCEPT`,\r\n      ],\r\n      decline: (id) => [\r\n        `/api/direct-requests/${id}/decline`,\r\n        `/api/direct-requests/${id}/reject`,\r\n        `/api/direct-requests/${id}/respond?action=DECLINE`,\r\n      ],\r\n    },\r\n  };\r\n\r\n  async function tryVerbs(url, body) {\r\n    const optionsBase = {\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: body ? JSON.stringify(body) : undefined,\r\n    };\r\n    const verbs = ['POST', 'PUT', 'PATCH'];\r\n    let lastErr = null;\r\n    for (const method of verbs) {\r\n      try {\r\n        const r = await authFetch(url, { method, ...optionsBase });\r\n        if (r.ok) return r;\r\n        const txt = await r.text().catch(() => '');\r\n        lastErr = new Error(`${r.status} ${r.statusText}${txt ? ` â€¢ ${txt}` : ''}`);\r\n      } catch (e) {\r\n        lastErr = e;\r\n      }\r\n    }\r\n    throw lastErr || new Error('All methods failed');\r\n  }\r\n\r\n  const callAction = async (type, id, which) => {\r\n    setActionLoading((m) => ({ ...m, [id]: true }));\r\n    try {\r\n      const urls = actionPaths[type]?.[which]?.(id) || [];\r\n      if (!urls.length) throw new Error(`Unknown action: ${type}.${which}`);\r\n      let ok = false; let lastError = null;\r\n      for (const url of urls) {\r\n        try { await tryVerbs(url); ok = true; break; } catch (e) { lastError = e; }\r\n      }\r\n      if (!ok) throw lastError || new Error('No endpoint accepted this action');\r\n      await fetchSummary();\r\n    } catch (e) {\r\n      console.error(e);\r\n      alert(`Action failed:\\n${e.message || e}`);\r\n    } finally {\r\n      setActionLoading((m) => ({ ...m, [id]: false }));\r\n    }\r\n  };\r\n\r\n  const acceptRequest  = (req) => req.type === 'direct' && callAction('direct', req.id, 'accept');\r\n  const declineRequest = (req) => req.type === 'direct' && callAction('direct', req.id, 'decline');\r\n\r\n  // ---- loan cards (unchanged) --------------------------------------\r\n\r\n  const loanKey = (loan, idx) => loan?.id || loan?._id || String(idx);\r\n\r\n  const toggleLoanDetails = (id) => {\r\n    setExpandedLoans((prev) => ({\r\n      ...(Object.keys(prev).reduce((acc, k) => ({ ...acc, [k]: false }), {})),\r\n      [id]: !prev[id],\r\n    }));\r\n  };\r\n\r\n  const payNext = async (loan) => {\r\n    const key = loanKey(loan);\r\n    const amount = loan?.installmentAmount ?? 0;\r\n    if (!window.confirm(`Pay the next installment (${fmtMoney(amount)})?`)) return;\r\n    try {\r\n      setPayLoading((m) => ({ ...m, [key]: true }));\r\n      const res = await authFetch(`/api/loans/${loan.id || loan._id}/pay-next`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n      });\r\n      const data = await res.json();\r\n      if (!res.ok) throw new Error(data?.error || 'Payment failed');\r\n      const paid = typeof data.amount === 'number' ? data.amount : amount;\r\n      alert(`Payment successful! Amount: ${fmtMoney(paid)}`);\r\n      await fetchSummary();\r\n    } catch (e) {\r\n      alert(e.message);\r\n    } finally {\r\n      setPayLoading((m) => ({ ...m, [key]: false }));\r\n    }\r\n  };\r\n\r\n  const renderLoanCard = (loan, isLender, idx) => {\r\n    const key = loanKey(loan, idx);\r\n    const isExpanded = !!expandedLoans[key];\r\n    const otherParty = isLender ? loan.borrowerName : loan.lenderName;\r\n\r\n    const canPay =\r\n      !isLender &&\r\n      typeof loan.installmentAmount === 'number' &&\r\n      loan.installmentAmount > 0 &&\r\n      !!loan.nextDueDate;\r\n\r\n    const badgeClass =\r\n      (loan.status || '').toUpperCase() === 'FUNDED'\r\n        ? 'ms-badge ms-badge--ok'\r\n        : 'ms-badge ms-badge--warn';\r\n\r\n    const fundedDate =\r\n      loan.fundedDate ? new Date(loan.fundedDate).toLocaleDateString() : 'â€”';\r\n\r\n    return (\r\n      <div className=\"ms-card\" key={key}>\r\n        <div className=\"ms-card-row\" style={ROW_GRID}>\r\n          <div>\r\n            <div className=\"ms-label\">{isLender ? 'Borrower' : 'Lender'}</div>\r\n            <div className=\"ms-value-strong\">{otherParty || 'Unknown'}</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"ms-label\">Amount</div>\r\n            <div className=\"ms-value-strong\">{fmtMoney(loan.amount)}</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"ms-label\">Funded Date</div>\r\n            <div className=\"ms-value-strong\">{fundedDate}</div>\r\n          </div>\r\n          <div style={{ justifySelf: 'end' }}>\r\n            <span className={badgeClass}>{loan.status || 'â€”'}</span>\r\n          </div>\r\n          <div style={{ justifySelf: 'end', display: 'flex', gap: 8 }}>\r\n            <button\r\n              onClick={() => setThreadLoanId(loan.id || loan._id)}\r\n              className=\"action-btn\"\r\n              title=\"Open conversation\"\r\n            >\r\n              ðŸ’¬ Messages\r\n            </button>\r\n            <button onClick={() => toggleLoanDetails(key)} className=\"action-btn\" title=\"View contract\">\r\n              {isExpanded ? 'ðŸ”½ Hide' : 'ðŸ“„ View'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {isExpanded && (\r\n          <div className=\"ms-details\">\r\n            {loan.status && (\r\n              <p className=\"mt-6\">\r\n                <strong>Status:</strong> {loan.status}\r\n              </p>\r\n            )}\r\n            <p className=\"mt-6\">\r\n              <strong>Interest Rate:</strong>{' '}\r\n              {typeof loan.interestRate === 'number' ? `${loan.interestRate}%` : 'â€”'}\r\n            </p>\r\n            <p className=\"mt-6\">\r\n              <strong>Duration:</strong>{' '}\r\n              {typeof loan.duration === 'number' ? `${loan.duration} months` : 'â€”'}\r\n            </p>\r\n            <p className=\"mt-6\">\r\n              <strong>Next Due Date:</strong>{' '}\r\n              {loan.nextDueDate ? new Date(loan.nextDueDate).toLocaleDateString() : 'â€”'}\r\n            </p>\r\n            <p className=\"mt-6\">\r\n              <strong>Installment (this period):</strong> {fmtMoney(loan.installmentAmount)}\r\n            </p>\r\n\r\n            {isLender && typeof loan.amountCollected === 'number' && (\r\n              <p className=\"mt-6\">\r\n                <strong>Amount collected on loan:</strong> {fmtMoney(loan.amountCollected)}\r\n              </p>\r\n            )}\r\n\r\n            {!isLender && canPay && (\r\n              <div className=\"mt-6\">\r\n                <button\r\n                  className=\"action-btn primary\"\r\n                  onClick={() => payNext(loan)}\r\n                  disabled={!!payLoading[key]}\r\n                  title=\"Pay next installment\"\r\n                >\r\n                  {payLoading[key] ? 'Processingâ€¦' : 'ðŸ’³ Make Payment'}\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // ---- render -------------------------------------------------------\r\n\r\n  if (loading) return <p className=\"ms-loading ms-container\">Loading money summary...</p>;\r\n\r\n  const given = Array.isArray(summary.loansGiven) ? summary.loansGiven : [];\r\n  const received = Array.isArray(summary.loansReceived) ? summary.loansReceived : [];\r\n  const myOpen = Array.isArray(summary.myOpenRequests) ? summary.myOpenRequests : [];\r\n\r\n  return (\r\n    <div className=\"ms-container\">\r\n      <h2 className=\"ms-heading\">ðŸ’µ My Money Summary</h2>\r\n\r\n      {/* Section: Open Requests Iâ€™m tracking */}\r\n      <div className=\"ms-section\">\r\n        <button\r\n          className=\"ms-section-head\"\r\n          onClick={() => setOpenSec((s) => ({ ...s, open: !s.open }))}\r\n          aria-expanded={openSec.open}\r\n        >\r\n          <div className=\"ms-subheading\">My Open Loan Requests</div>\r\n          <div className=\"ms-caret\">{openSec.open ? 'â–¾' : 'â–¸'}</div>\r\n        </button>\r\n        {openSec.open && (\r\n          <div className=\"ms-section-body\">\r\n            {myOpen.length === 0 ? (\r\n              <p className=\"ms-empty\">\r\n                You have no open direct requests and havenâ€™t made any offers on market requests yet.\r\n              </p>\r\n            ) : (\r\n              myOpen.map((req) => (\r\n                <OpenRequestRow\r\n                  key={req.id}\r\n                  req={req}\r\n                  isExpanded={!!expandedLoans[req.id]}\r\n                  onToggle={() => toggleLoanDetails(req.id)}\r\n                  actionLoading={actionLoading}\r\n                  acceptRequest={acceptRequest}\r\n                  declineRequest={declineRequest}\r\n                />\r\n              ))\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Loans Given */}\r\n      <div className=\"ms-section\">\r\n        <button\r\n          className=\"ms-section-head\"\r\n          onClick={() => setOpenSec((s) => ({ ...s, given: !s.given }))}\r\n          aria-expanded={openSec.given}\r\n        >\r\n          <div className=\"ms-subheading\">Loans Given (I'm the Lender)</div>\r\n          <div className=\"ms-caret\">{openSec.given ? 'â–¾' : 'â–¸'}</div>\r\n        </button>\r\n        {openSec.given && (\r\n          <div className=\"ms-section-body\">\r\n            {given.length === 0 ? (\r\n              <p className=\"ms-empty\">No loans given yet.</p>\r\n            ) : (\r\n              given.map((loan, idx) => renderLoanCard(loan, true, idx))\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Loans Received */}\r\n      <div className=\"ms-section\">\r\n        <button\r\n          className=\"ms-section-head\"\r\n          onClick={() => setOpenSec((s) => ({ ...s, received: !s.received }))}\r\n          aria-expanded={openSec.received}\r\n        >\r\n          <div className=\"ms-subheading\">Loans Received (I'm the Borrower)</div>\r\n          <div className=\"ms-caret\">{openSec.received ? 'â–¾' : 'â–¸'}</div>\r\n        </button>\r\n        {openSec.received && (\r\n          <div className=\"ms-section-body\">\r\n            {received.length === 0 ? (\r\n              <p className=\"ms-empty\">No loans received yet.</p>\r\n            ) : (\r\n              received.map((loan, idx) => renderLoanCard(loan, false, idx))\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {threadLoanId && (\r\n        <LoanThreadModal loanId={threadLoanId} onClose={() => setThreadLoanId(null)} />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MoneySummary;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}