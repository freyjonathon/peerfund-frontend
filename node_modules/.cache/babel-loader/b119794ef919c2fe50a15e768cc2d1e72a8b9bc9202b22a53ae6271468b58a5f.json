{"ast":null,"code":"var _jsxFileName = \"/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/messaging/LoanThread.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LoanThread = () => {\n  _s();\n  const {\n    loanId\n  } = useParams();\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [loading, setLoading] = useState(true);\n  const fetchMessages = async () => {\n    try {\n      const res = await fetch(`/api/loans/${loanId}/messages`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      if (!res.ok) throw new Error('Failed to load messages');\n      const data = await res.json();\n      setMessages(data);\n    } catch (err) {\n      console.error('Error fetching messages:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const sendMessage = async () => {\n    if (!newMessage.trim()) return;\n    try {\n      const res = await fetch(`/api/loans/${loanId}/messages`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        },\n        body: JSON.stringify({\n          content: newMessage\n        })\n      });\n      if (!res.ok) throw new Error('Failed to send message');\n      setNewMessage('');\n      fetchMessages(); // Refresh messages\n    } catch (err) {\n      console.error('Error sending message:', err);\n    }\n  };\n  useEffect(() => {\n    fetchMessages();\n  }, [loanId]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: '2rem',\n      maxWidth: '700px',\n      margin: 'auto'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\uD83D\\uDCAC Loan Messages\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading messages...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: '2rem'\n      },\n      children: messages.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"No messages yet. Start the conversation!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 13\n      }, this) : messages.map(msg => {\n        var _msg$sender;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '1rem',\n            padding: '1rem',\n            borderRadius: '8px',\n            backgroundColor: msg.senderId === msg.currentUserId ? '#e8f5e9' : '#f1f1f1'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: [((_msg$sender = msg.sender) === null || _msg$sender === void 0 ? void 0 : _msg$sender.name) || 'User', \":\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: msg.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n            children: new Date(msg.createdAt).toLocaleString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 17\n          }, this)]\n        }, msg.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 15\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        rows: \"3\",\n        style: {\n          width: '100%',\n          marginBottom: '1rem'\n        },\n        placeholder: \"Type your message...\",\n        value: newMessage,\n        onChange: e => setNewMessage(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: sendMessage,\n        children: \"Send Message\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n};\n_s(LoanThread, \"48gFwdmLDN1zATHbQXqxG/TiZWc=\", false, function () {\n  return [useParams];\n});\n_c = LoanThread;\nexport default LoanThread;\nvar _c;\n$RefreshReg$(_c, \"LoanThread\");","map":{"version":3,"names":["React","useEffect","useState","useParams","jsxDEV","_jsxDEV","LoanThread","_s","loanId","messages","setMessages","newMessage","setNewMessage","loading","setLoading","fetchMessages","res","fetch","headers","Authorization","localStorage","getItem","ok","Error","data","json","err","console","error","sendMessage","trim","method","body","JSON","stringify","content","style","padding","maxWidth","margin","children","fileName","_jsxFileName","lineNumber","columnNumber","marginBottom","length","map","msg","_msg$sender","borderRadius","backgroundColor","senderId","currentUserId","sender","name","Date","createdAt","toLocaleString","id","rows","width","placeholder","value","onChange","e","target","onClick","_c","$RefreshReg$"],"sources":["/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/messaging/LoanThread.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\n\r\nconst LoanThread = () => {\r\n  const { loanId } = useParams();\r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const fetchMessages = async () => {\r\n    try {\r\n      const res = await fetch(`/api/loans/${loanId}/messages`, {\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n      });\r\n      if (!res.ok) throw new Error('Failed to load messages');\r\n      const data = await res.json();\r\n      setMessages(data);\r\n    } catch (err) {\r\n      console.error('Error fetching messages:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const sendMessage = async () => {\r\n    if (!newMessage.trim()) return;\r\n\r\n    try {\r\n      const res = await fetch(`/api/loans/${loanId}/messages`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n        body: JSON.stringify({ content: newMessage }),\r\n      });\r\n\r\n      if (!res.ok) throw new Error('Failed to send message');\r\n      setNewMessage('');\r\n      fetchMessages(); // Refresh messages\r\n    } catch (err) {\r\n      console.error('Error sending message:', err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchMessages();\r\n  }, [loanId]);\r\n\r\n  return (\r\n    <div style={{ padding: '2rem', maxWidth: '700px', margin: 'auto' }}>\r\n      <h2>ðŸ’¬ Loan Messages</h2>\r\n\r\n      {loading ? (\r\n        <p>Loading messages...</p>\r\n      ) : (\r\n        <div style={{ marginBottom: '2rem' }}>\r\n          {messages.length === 0 ? (\r\n            <p>No messages yet. Start the conversation!</p>\r\n          ) : (\r\n            messages.map((msg) => (\r\n              <div\r\n                key={msg.id}\r\n                style={{\r\n                  marginBottom: '1rem',\r\n                  padding: '1rem',\r\n                  borderRadius: '8px',\r\n                  backgroundColor: msg.senderId === msg.currentUserId ? '#e8f5e9' : '#f1f1f1',\r\n                }}\r\n              >\r\n                <strong>{msg.sender?.name || 'User'}:</strong>\r\n                <p>{msg.content}</p>\r\n                <small>{new Date(msg.createdAt).toLocaleString()}</small>\r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      <div>\r\n        <textarea\r\n          rows=\"3\"\r\n          style={{ width: '100%', marginBottom: '1rem' }}\r\n          placeholder=\"Type your message...\"\r\n          value={newMessage}\r\n          onChange={(e) => setNewMessage(e.target.value)}\r\n        />\r\n        <button onClick={sendMessage}>Send Message</button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LoanThread;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}