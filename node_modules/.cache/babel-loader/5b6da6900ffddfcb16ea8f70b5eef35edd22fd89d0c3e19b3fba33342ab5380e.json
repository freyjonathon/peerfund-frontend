{"ast":null,"code":"var _jsxFileName = \"/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/dashboard/MoneySummary.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// src/features/money/MoneySummary.jsx\nimport React, { useEffect, useState, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './MoneySummary.css';\nimport UserProfileModal from '../../components/UserProfileModal';\nimport LoanThreadModal from '../loans/LoanThreadModal';\n\n// helper: decode JWT for current user id\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction getCurrentUserId() {\n  const t = localStorage.getItem('token');\n  if (!t) return null;\n  try {\n    var _payload$userId;\n    const payload = JSON.parse(atob(t.split('.')[1] || ''));\n    return (_payload$userId = payload === null || payload === void 0 ? void 0 : payload.userId) !== null && _payload$userId !== void 0 ? _payload$userId : null;\n  } catch {\n    return null;\n  }\n}\nconst fmtMoney = n => typeof n === 'number' && !Number.isNaN(n) ? `$${n.toFixed(2)}` : 'â€”';\n\n// one-line row layout used across all sections\nconst ROW_GRID = {\n  display: 'grid',\n  gridTemplateColumns: 'minmax(160px,1fr) 140px 180px auto auto',\n  alignItems: 'center',\n  gap: 16\n};\n\n/* ---------- Child component for a single open request row (with negotiation) ---------- */\nfunction OpenRequestRow({\n  req,\n  isExpanded,\n  onToggle,\n  actionLoading,\n  submitCounter,\n  acceptRequest,\n  declineRequest\n}) {\n  _s();\n  var _req$status;\n  const [proposal, setProposal] = useState({\n    amount: req.amount || 0,\n    months: req.duration || 1,\n    interestRate: req.interestRate || 0\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ms-card\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-card-row\",\n      style: ROW_GRID,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-label\",\n          children: \"Borrower\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-value-strong\",\n          children: req.borrowerName || 'You'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-label\",\n          children: \"Amount\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-value-strong\",\n          children: fmtMoney(req.amount)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-label\",\n          children: \"Created\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-value-strong\",\n          children: req.createdAt ? new Date(req.createdAt).toLocaleDateString() : 'â€”'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          justifySelf: 'end'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"ms-badge ms-badge--warn\",\n          children: \"Open\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          justifySelf: 'end'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"action-btn\",\n          onClick: onToggle,\n          title: \"View request details\",\n          children: isExpanded ? 'ðŸ”½ Hide' : 'ðŸ“„ View'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this), isExpanded && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-details\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Status:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 13\n        }, this), \" \", (_req$status = req.status) !== null && _req$status !== void 0 ? _req$status : 'OPEN']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Interest Rate:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 13\n        }, this), ' ', Number.isFinite(req.interestRate) ? `${req.interestRate}%` : 'â€”']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Duration:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 13\n        }, this), ' ', Number.isFinite(req.duration) ? `${req.duration} months` : 'â€”']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }, this), req.purpose ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Reason:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 15\n        }, this), \" \", req.purpose]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 13\n      }, this) : null, req.lenderName ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Requested Lender:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 15\n        }, this), \" \", req.lenderName]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }, this) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-8\",\n        style: {\n          display: 'flex',\n          flexWrap: 'wrap',\n          gap: 10\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"ms-label\",\n            children: \"Amount\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            min: \"1\",\n            className: \"auth-input\",\n            value: proposal.amount,\n            onChange: e => setProposal(p => ({\n              ...p,\n              amount: Number(e.target.value)\n            })),\n            style: {\n              width: 140\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"ms-label\",\n            children: \"APR %\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            min: \"0\",\n            className: \"auth-input\",\n            value: proposal.interestRate,\n            onChange: e => setProposal(p => ({\n              ...p,\n              interestRate: Number(e.target.value)\n            })),\n            style: {\n              width: 120\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"ms-label\",\n            children: \"Months\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            min: \"1\",\n            className: \"auth-input\",\n            value: proposal.months,\n            onChange: e => setProposal(p => ({\n              ...p,\n              months: Number(e.target.value)\n            })),\n            style: {\n              width: 120\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginLeft: 'auto',\n            display: 'flex',\n            gap: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"action-btn\",\n            onClick: () => submitCounter(req, req.type === 'direct' ? {\n              amount: proposal.amount,\n              apr: proposal.interestRate,\n              months: proposal.months\n            } : {\n              amount: proposal.amount,\n              interestRate: proposal.interestRate,\n              months: proposal.months\n            }),\n            disabled: !!actionLoading[req.id],\n            children: actionLoading[req.id] ? 'Savingâ€¦' : 'Make Counter-Offer'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"action-btn primary\",\n            onClick: () => acceptRequest(req),\n            disabled: !!actionLoading[req.id],\n            children: actionLoading[req.id] ? 'Workingâ€¦' : 'Accept'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"action-btn\",\n            onClick: () => declineRequest(req),\n            disabled: !!actionLoading[req.id],\n            children: actionLoading[req.id] ? 'Workingâ€¦' : 'Decline'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }, this)]\n  }, req.id, true, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 5\n  }, this);\n}\n\n/* -------------------------------- Parent -------------------------------- */\n_s(OpenRequestRow, \"kuAQz44Ww4Vm45/3BwYk0IW1zjw=\");\n_c = OpenRequestRow;\nconst MoneySummary = () => {\n  _s2();\n  const [summary, setSummary] = useState({\n    loansGiven: [],\n    loansReceived: [],\n    myOpenRequests: []\n  });\n  const [loading, setLoading] = useState(true);\n  const [expandedLoans, setExpandedLoans] = useState({});\n  const [openSec, setOpenSec] = useState({\n    open: true,\n    given: true,\n    received: true\n  });\n  const [payLoading, setPayLoading] = useState({});\n  const [actionLoading, setActionLoading] = useState({});\n  const [profileUserId, setProfileUserId] = useState(null);\n  const [threadLoanId, setThreadLoanId] = useState(null);\n  const token = localStorage.getItem('token');\n  const navigate = useNavigate();\n  const authHeader = token ? {\n    Authorization: `Bearer ${token}`\n  } : {};\n\n  /* ------------------ Fetch helpers (market + direct) ------------------ */\n\n  const fetchMarketOpenRequests = async () => {\n    const me = getCurrentUserId();\n    if (!me) return [];\n    try {\n      const r = await fetch('/api/loan-requests/mine?status=OPEN', {\n        headers: authHeader\n      });\n      if (r.ok) {\n        const list = await r.json();\n        const items = Array.isArray(list) ? list : Array.isArray(list === null || list === void 0 ? void 0 : list.items) ? list.items : [];\n        return items.filter(it => {\n          var _it$borrower;\n          return ((it === null || it === void 0 ? void 0 : it.borrowerId) || (it === null || it === void 0 ? void 0 : (_it$borrower = it.borrower) === null || _it$borrower === void 0 ? void 0 : _it$borrower.id)) === me;\n        }).map(r => {\n          var _r$duration, _r$interestRate, _r$borrower, _r$borrower2;\n          return {\n            type: 'market',\n            id: r.id,\n            amount: Number(r.amount),\n            duration: Number((_r$duration = r.duration) !== null && _r$duration !== void 0 ? _r$duration : r.months),\n            interestRate: Number((_r$interestRate = r.interestRate) !== null && _r$interestRate !== void 0 ? _r$interestRate : r.apr),\n            purpose: r.purpose || '',\n            createdAt: r.createdAt || null,\n            borrowerName: (r === null || r === void 0 ? void 0 : (_r$borrower = r.borrower) === null || _r$borrower === void 0 ? void 0 : _r$borrower.name) || 'You',\n            borrowerId: (r === null || r === void 0 ? void 0 : (_r$borrower2 = r.borrower) === null || _r$borrower2 === void 0 ? void 0 : _r$borrower2.id) || r.borrowerId || me,\n            status: r.status || 'OPEN'\n          };\n        });\n      }\n    } catch {}\n    try {\n      const resOpen = await fetch('/api/loans/open', {\n        headers: authHeader\n      });\n      if (resOpen.ok) {\n        const openListRaw = await resOpen.json();\n        const openList = Array.isArray(openListRaw) ? openListRaw : Array.isArray(openListRaw === null || openListRaw === void 0 ? void 0 : openListRaw.items) ? openListRaw.items : [];\n        const me2 = getCurrentUserId();\n        const mine = openList.filter(r => {\n          var _r$borrower3;\n          const borrowerId = (r === null || r === void 0 ? void 0 : (_r$borrower3 = r.borrower) === null || _r$borrower3 === void 0 ? void 0 : _r$borrower3.id) || (r === null || r === void 0 ? void 0 : r.borrowerId);\n          return borrowerId && borrowerId === me2;\n        });\n        return mine.map(r => {\n          var _r$duration2, _r$interestRate2, _r$borrower4, _r$borrower5;\n          return {\n            type: 'market',\n            id: r.id,\n            amount: Number(r.amount),\n            duration: Number((_r$duration2 = r.duration) !== null && _r$duration2 !== void 0 ? _r$duration2 : r.months),\n            interestRate: Number((_r$interestRate2 = r.interestRate) !== null && _r$interestRate2 !== void 0 ? _r$interestRate2 : r.apr),\n            purpose: r.purpose || '',\n            createdAt: r.createdAt || null,\n            borrowerName: (r === null || r === void 0 ? void 0 : (_r$borrower4 = r.borrower) === null || _r$borrower4 === void 0 ? void 0 : _r$borrower4.name) || 'You',\n            borrowerId: (r === null || r === void 0 ? void 0 : (_r$borrower5 = r.borrower) === null || _r$borrower5 === void 0 ? void 0 : _r$borrower5.id) || (r === null || r === void 0 ? void 0 : r.borrowerId) || me2,\n            status: r.status || 'OPEN'\n          };\n        });\n      }\n    } catch {}\n    return [];\n  };\n  const fetchDirectOpenRequests = async () => {\n    const me = getCurrentUserId();\n    if (!me) return [];\n    try {\n      const r = await fetch('/api/direct-requests/mine', {\n        headers: authHeader\n      });\n      if (!r.ok) return [];\n      const data = await r.json();\n      const combined = Array.isArray(data) ? data : [...(Array.isArray(data === null || data === void 0 ? void 0 : data.asBorrower) ? data.asBorrower : []), ...(Array.isArray(data === null || data === void 0 ? void 0 : data.asLender) ? data.asLender : [])];\n      const FINAL = new Set(['DECLINED', 'CANCELLED', 'DISBURSED', 'APPROVED', 'REJECTED']);\n      return combined.filter(d => !FINAL.has(((d === null || d === void 0 ? void 0 : d.status) || '').toUpperCase())).map(d => {\n        var _d$borrower, _d$lender, _d$months, _d$apr, _d$borrower2, _d$lender2;\n        const borrowerId = d.borrowerId || (d === null || d === void 0 ? void 0 : (_d$borrower = d.borrower) === null || _d$borrower === void 0 ? void 0 : _d$borrower.id);\n        const lenderId = d.lenderId || (d === null || d === void 0 ? void 0 : (_d$lender = d.lender) === null || _d$lender === void 0 ? void 0 : _d$lender.id);\n        const iAmBorrower = borrowerId === me;\n        return {\n          type: 'direct',\n          id: d.id,\n          amount: Number(d.amount),\n          duration: Number((_d$months = d.months) !== null && _d$months !== void 0 ? _d$months : d.duration),\n          interestRate: Number((_d$apr = d.apr) !== null && _d$apr !== void 0 ? _d$apr : d.interestRate),\n          createdAt: d.createdAt || null,\n          borrowerId,\n          borrowerName: (d === null || d === void 0 ? void 0 : (_d$borrower2 = d.borrower) === null || _d$borrower2 === void 0 ? void 0 : _d$borrower2.name) || (iAmBorrower ? 'You' : ''),\n          lenderId,\n          lenderName: (d === null || d === void 0 ? void 0 : (_d$lender2 = d.lender) === null || _d$lender2 === void 0 ? void 0 : _d$lender2.name) || (!iAmBorrower ? 'Counterparty' : ''),\n          status: d.status || 'PENDING'\n        };\n      });\n    } catch {\n      return [];\n    }\n  };\n  const fetchSummary = useCallback(async () => {\n    if (!token) return;\n    setLoading(true);\n    try {\n      const res = await fetch('/api/users/my-money-summary', {\n        headers: authHeader\n      });\n      let loansGiven = [];\n      let loansReceived = [];\n      if (res.ok) {\n        const data = await res.json();\n        loansGiven = Array.isArray(data.loansGiven) ? data.loansGiven : Array.isArray(data.loansAsLender) ? data.loansAsLender : [];\n        loansReceived = Array.isArray(data.loansReceived) ? data.loansReceived : Array.isArray(data.loansAsBorrower) ? data.loansAsBorrower : [];\n      }\n      const [marketOpen, directOpen] = await Promise.all([fetchMarketOpenRequests(), fetchDirectOpenRequests()]);\n      const myOpenRequests = [...marketOpen, ...directOpen];\n      setSummary({\n        loansGiven,\n        loansReceived,\n        myOpenRequests\n      });\n    } catch (err) {\n      console.error('Error fetching money summary:', err);\n      setSummary({\n        loansGiven: [],\n        loansReceived: [],\n        myOpenRequests: []\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, [token]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(() => {\n    fetchSummary();\n  }, [fetchSummary]);\n  const loanKey = (loan, idx) => (loan === null || loan === void 0 ? void 0 : loan.id) || (loan === null || loan === void 0 ? void 0 : loan._id) || String(idx);\n  const toggleLoanDetails = id => {\n    setExpandedLoans(prev => ({\n      ...Object.keys(prev).reduce((acc, k) => ({\n        ...acc,\n        [k]: false\n      }), {}),\n      [id]: !prev[id]\n    }));\n  };\n  const payNext = async loan => {\n    var _loan$installmentAmou;\n    const key = loanKey(loan);\n    const amount = (_loan$installmentAmou = loan === null || loan === void 0 ? void 0 : loan.installmentAmount) !== null && _loan$installmentAmou !== void 0 ? _loan$installmentAmou : 0;\n    if (!window.confirm(`Pay the next installment (${fmtMoney(amount)})?`)) return;\n    try {\n      setPayLoading(m => ({\n        ...m,\n        [key]: true\n      }));\n      const res = await fetch(`/api/loans/${loan.id || loan._id}/pay-next`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...authHeader\n        },\n        credentials: 'include'\n      });\n      const data = await res.json();\n      if (!res.ok) throw new Error((data === null || data === void 0 ? void 0 : data.error) || 'Payment failed');\n      const paid = typeof data.amount === 'number' ? data.amount : amount;\n      alert(`Payment successful! Amount: ${fmtMoney(paid)}`);\n      await fetchSummary();\n    } catch (e) {\n      alert(e.message);\n    } finally {\n      setPayLoading(m => ({\n        ...m,\n        [key]: false\n      }));\n    }\n  };\n\n  /* -------------------- Action endpoints + helpers -------------------- */\n\n  // Build fallback lists for each action. Weâ€™ll try these in order until one succeeds.\n  const actionPaths = {\n    market: {\n      accept: id => [`/api/loan-requests/${id}/accept`, `/api/loan-requests/${id}/approve`, `/api/loan-requests/${id}/respond?action=ACCEPT`],\n      decline: id => [`/api/loan-requests/${id}/decline`, `/api/loan-requests/${id}/reject`, `/api/loan-requests/${id}/respond?action=DECLINE`],\n      counter: id => [`/api/loan-requests/${id}/counter-offer`, `/api/loan-requests/${id}/counter`, `/api/loan-requests/${id}/respond?action=COUNTER`]\n    },\n    direct: {\n      accept: id => [`/api/direct-requests/${id}/accept`, `/api/direct-requests/${id}/approve`, `/api/direct-requests/${id}/respond?action=ACCEPT`],\n      decline: id => [`/api/direct-requests/${id}/decline`, `/api/direct-requests/${id}/reject`, `/api/direct-requests/${id}/respond?action=DECLINE`],\n      counter: id => [`/api/direct-requests/${id}/counter-offer`, `/api/direct-requests/${id}/counter`, `/api/direct-requests/${id}/respond?action=COUNTER`]\n    }\n  };\n\n  // Try POST â†’ PUT â†’ PATCH for a given url + body.\n  async function tryVerbs(url, body) {\n    const optionsBase = {\n      headers: {\n        'Content-Type': 'application/json',\n        ...authHeader\n      },\n      body: body ? JSON.stringify(body) : undefined\n    };\n\n    // order matters; some backends only accept POST, others PUT/PATCH\n    const verbs = ['POST', 'PUT', 'PATCH'];\n    let lastErr = null;\n    for (const method of verbs) {\n      try {\n        const r = await fetch(url, {\n          method,\n          ...optionsBase\n        });\n        if (r.ok) return r;\n        // save details and keep trying\n        const txt = await r.text().catch(() => '');\n        lastErr = new Error(`${r.status} ${r.statusText}${txt ? ` â€¢ ${txt}` : ''}`);\n      } catch (e) {\n        lastErr = e;\n      }\n    }\n    throw lastErr || new Error('All methods failed');\n  }\n\n  // Master action caller: tries multiple paths & multiple verbs, shows good error text on failure\n  const callAction = async (type, id, which, body) => {\n    setActionLoading(m => ({\n      ...m,\n      [id]: true\n    }));\n    try {\n      var _actionPaths$type, _actionPaths$type$whi, _ref, _body$amount, _ref2, _body$months, _ref3, _body$duration, _ref4, _body$interestRate, _ref5, _body$apr;\n      const urls = ((_actionPaths$type = actionPaths[type]) === null || _actionPaths$type === void 0 ? void 0 : (_actionPaths$type$whi = _actionPaths$type[which]) === null || _actionPaths$type$whi === void 0 ? void 0 : _actionPaths$type$whi.call(_actionPaths$type, id)) || [];\n      if (!urls.length) throw new Error(`Unknown action: ${type}.${which}`);\n\n      // ensure we send a superset payload that covers common backend shapes\n      const supersetBody = body ? {\n        ...body,\n        // normalize keys that different backends use\n        amount: (_ref = (_body$amount = body.amount) !== null && _body$amount !== void 0 ? _body$amount : body.value) !== null && _ref !== void 0 ? _ref : undefined,\n        months: (_ref2 = (_body$months = body.months) !== null && _body$months !== void 0 ? _body$months : body.duration) !== null && _ref2 !== void 0 ? _ref2 : undefined,\n        duration: (_ref3 = (_body$duration = body.duration) !== null && _body$duration !== void 0 ? _body$duration : body.months) !== null && _ref3 !== void 0 ? _ref3 : undefined,\n        interestRate: (_ref4 = (_body$interestRate = body.interestRate) !== null && _body$interestRate !== void 0 ? _body$interestRate : body.apr) !== null && _ref4 !== void 0 ? _ref4 : undefined,\n        apr: (_ref5 = (_body$apr = body.apr) !== null && _body$apr !== void 0 ? _body$apr : body.interestRate) !== null && _ref5 !== void 0 ? _ref5 : undefined\n      } : undefined;\n      let ok = false;\n      let lastError = null;\n      for (const url of urls) {\n        try {\n          const r = await tryVerbs(url, supersetBody);\n          // success\n          ok = true;\n          break;\n        } catch (e) {\n          lastError = e;\n          // loop and try the next url\n        }\n      }\n      if (!ok) throw lastError || new Error('No endpoint accepted this action');\n\n      // Refresh the list\n      await fetchSummary();\n    } catch (e) {\n      console.error(e);\n      alert(`Action failed:\\n${e.message || e}`);\n    } finally {\n      setActionLoading(m => ({\n        ...m,\n        [id]: false\n      }));\n    }\n  };\n\n  // Simple wrappers used by the row component\n  const acceptRequest = req => callAction(req.type, req.id, 'accept');\n  const declineRequest = req => callAction(req.type, req.id, 'decline');\n  const submitCounter = (req, proposal) => callAction(req.type, req.id, 'counter', proposal);\n\n  /* ----------------------- Card renderers (one-line) ----------------------- */\n\n  const renderLoanCard = (loan, isLender, idx) => {\n    const key = loanKey(loan, idx);\n    const isExpanded = !!expandedLoans[key];\n    const otherParty = isLender ? loan.borrowerName : loan.lenderName;\n    const canPay = !isLender && typeof loan.installmentAmount === 'number' && loan.installmentAmount > 0 && !!loan.nextDueDate;\n    const badgeClass = (loan.status || '').toUpperCase() === 'FUNDED' ? 'ms-badge ms-badge--ok' : 'ms-badge ms-badge--warn';\n    const fundedDate = loan.fundedDate ? new Date(loan.fundedDate).toLocaleDateString() : 'â€”';\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-card-row\",\n        style: ROW_GRID,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-label\",\n            children: isLender ? 'Borrower' : 'Lender'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 523,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-value-strong\",\n            children: otherParty || 'Unknown'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 524,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 522,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-label\",\n            children: \"Amount\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 527,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-value-strong\",\n            children: fmtMoney(loan.amount)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 528,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 526,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-label\",\n            children: \"Funded Date\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 531,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-value-strong\",\n            children: fundedDate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 532,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 530,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            justifySelf: 'end'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: badgeClass,\n            children: loan.status || 'â€”'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 535,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 534,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            justifySelf: 'end',\n            display: 'flex',\n            gap: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setThreadLoanId(loan.id || loan._id),\n            className: \"action-btn\",\n            title: \"Open conversation\",\n            children: \"\\uD83D\\uDCAC Messages\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 538,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => toggleLoanDetails(key),\n            className: \"action-btn\",\n            title: \"View contract\",\n            children: isExpanded ? 'ðŸ”½ Hide' : 'ðŸ“„ View'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 545,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 537,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 521,\n        columnNumber: 9\n      }, this), isExpanded && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-details\",\n        children: [loan.status && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Status:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 559,\n            columnNumber: 17\n          }, this), \" \", loan.status]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 558,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Interest Rate:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 563,\n            columnNumber: 15\n          }, this), ' ', typeof loan.interestRate === 'number' ? `${loan.interestRate}%` : 'â€”']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 562,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Duration:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 567,\n            columnNumber: 15\n          }, this), ' ', typeof loan.duration === 'number' ? `${loan.duration} months` : 'â€”']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 566,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Next Due Date:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 571,\n            columnNumber: 15\n          }, this), ' ', loan.nextDueDate ? new Date(loan.nextDueDate).toLocaleDateString() : 'â€”']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 570,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Installment (this period):\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 575,\n            columnNumber: 15\n          }, this), \" \", fmtMoney(loan.installmentAmount)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 574,\n          columnNumber: 13\n        }, this), isLender && typeof loan.amountCollected === 'number' && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Amount collected on loan:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 580,\n            columnNumber: 17\n          }, this), \" \", fmtMoney(loan.amountCollected)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 579,\n          columnNumber: 15\n        }, this), !isLender && canPay && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-6\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"action-btn primary\",\n            onClick: () => payNext(loan),\n            disabled: !!payLoading[key],\n            title: \"Pay next installment\",\n            children: payLoading[key] ? 'Processingâ€¦' : 'ðŸ’³ Make Payment'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 586,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 585,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 556,\n        columnNumber: 11\n      }, this)]\n    }, key, true, {\n      fileName: _jsxFileName,\n      lineNumber: 520,\n      columnNumber: 7\n    }, this);\n  };\n\n  /* ------------------------------- Render ------------------------------- */\n\n  if (loading) return /*#__PURE__*/_jsxDEV(\"p\", {\n    className: \"ms-loading ms-container\",\n    children: \"Loading money summary...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 604,\n    columnNumber: 23\n  }, this);\n  const given = Array.isArray(summary.loansGiven) ? summary.loansGiven : [];\n  const received = Array.isArray(summary.loansReceived) ? summary.loansReceived : [];\n  const myOpen = Array.isArray(summary.myOpenRequests) ? summary.myOpenRequests : [];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ms-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"ms-heading\",\n      children: \"\\uD83D\\uDCB5 My Money Summary\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 612,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ms-section-head\",\n        onClick: () => setOpenSec(s => ({\n          ...s,\n          open: !s.open\n        })),\n        \"aria-expanded\": openSec.open,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-subheading\",\n          children: \"My Open Loan Requests\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 621,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-caret\",\n          children: openSec.open ? 'â–¾' : 'â–¸'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 622,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 616,\n        columnNumber: 9\n      }, this), openSec.open && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-section-body\",\n        children: myOpen.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"ms-empty\",\n          children: \"You have no open requests.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 627,\n          columnNumber: 15\n        }, this) : myOpen.map(req => /*#__PURE__*/_jsxDEV(OpenRequestRow, {\n          req: req,\n          isExpanded: !!expandedLoans[req.id],\n          onToggle: () => toggleLoanDetails(req.id),\n          actionLoading: actionLoading,\n          submitCounter: submitCounter,\n          acceptRequest: acceptRequest,\n          declineRequest: declineRequest\n        }, req.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 630,\n          columnNumber: 17\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 625,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 615,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ms-section-head\",\n        onClick: () => setOpenSec(s => ({\n          ...s,\n          given: !s.given\n        })),\n        \"aria-expanded\": openSec.given,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-subheading\",\n          children: \"Loans Given (I'm the Lender)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 653,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-caret\",\n          children: openSec.given ? 'â–¾' : 'â–¸'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 654,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 648,\n        columnNumber: 9\n      }, this), openSec.given && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-section-body\",\n        children: given.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"ms-empty\",\n          children: \"No loans given yet.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 659,\n          columnNumber: 15\n        }, this) : given.map((loan, idx) => renderLoanCard(loan, true, idx))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 657,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 647,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ms-section-head\",\n        onClick: () => setOpenSec(s => ({\n          ...s,\n          received: !s.received\n        })),\n        \"aria-expanded\": openSec.received,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-subheading\",\n          children: \"Loans Received (I'm the Borrower)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 674,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-caret\",\n          children: openSec.received ? 'â–¾' : 'â–¸'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 675,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 669,\n        columnNumber: 9\n      }, this), openSec.received && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-section-body\",\n        children: received.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"ms-empty\",\n          children: \"No loans received yet.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 680,\n          columnNumber: 15\n        }, this) : received.map((loan, idx) => renderLoanCard(loan, false, idx))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 678,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 668,\n      columnNumber: 7\n    }, this), profileUserId && /*#__PURE__*/_jsxDEV(UserProfileModal, {\n      userId: profileUserId,\n      onClose: () => setProfileUserId(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 689,\n      columnNumber: 9\n    }, this), threadLoanId && /*#__PURE__*/_jsxDEV(LoanThreadModal, {\n      loanId: threadLoanId,\n      onClose: () => setThreadLoanId(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 692,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 611,\n    columnNumber: 5\n  }, this);\n};\n_s2(MoneySummary, \"rFYXm4Rj6q4xVm1fmLcgSI7JeOI=\", false, function () {\n  return [useNavigate];\n});\n_c2 = MoneySummary;\nexport default MoneySummary;\nvar _c, _c2;\n$RefreshReg$(_c, \"OpenRequestRow\");\n$RefreshReg$(_c2, \"MoneySummary\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","useNavigate","UserProfileModal","LoanThreadModal","jsxDEV","_jsxDEV","getCurrentUserId","t","localStorage","getItem","_payload$userId","payload","JSON","parse","atob","split","userId","fmtMoney","n","Number","isNaN","toFixed","ROW_GRID","display","gridTemplateColumns","alignItems","gap","OpenRequestRow","req","isExpanded","onToggle","actionLoading","submitCounter","acceptRequest","declineRequest","_s","_req$status","proposal","setProposal","amount","months","duration","interestRate","className","children","style","fileName","_jsxFileName","lineNumber","columnNumber","borrowerName","createdAt","Date","toLocaleDateString","justifySelf","onClick","title","status","isFinite","purpose","lenderName","flexWrap","type","min","value","onChange","e","p","target","width","marginLeft","apr","disabled","id","_c","MoneySummary","_s2","summary","setSummary","loansGiven","loansReceived","myOpenRequests","loading","setLoading","expandedLoans","setExpandedLoans","openSec","setOpenSec","open","given","received","payLoading","setPayLoading","setActionLoading","profileUserId","setProfileUserId","threadLoanId","setThreadLoanId","token","navigate","authHeader","Authorization","fetchMarketOpenRequests","me","r","fetch","headers","ok","list","json","items","Array","isArray","filter","it","_it$borrower","borrowerId","borrower","map","_r$duration","_r$interestRate","_r$borrower","_r$borrower2","name","resOpen","openListRaw","openList","me2","mine","_r$borrower3","_r$duration2","_r$interestRate2","_r$borrower4","_r$borrower5","fetchDirectOpenRequests","data","combined","asBorrower","asLender","FINAL","Set","d","has","toUpperCase","_d$borrower","_d$lender","_d$months","_d$apr","_d$borrower2","_d$lender2","lenderId","lender","iAmBorrower","fetchSummary","res","loansAsLender","loansAsBorrower","marketOpen","directOpen","Promise","all","err","console","error","loanKey","loan","idx","_id","String","toggleLoanDetails","prev","Object","keys","reduce","acc","k","payNext","_loan$installmentAmou","key","installmentAmount","window","confirm","m","method","credentials","Error","paid","alert","message","actionPaths","market","accept","decline","counter","direct","tryVerbs","url","body","optionsBase","stringify","undefined","verbs","lastErr","txt","text","catch","statusText","callAction","which","_actionPaths$type","_actionPaths$type$whi","_ref","_body$amount","_ref2","_body$months","_ref3","_body$duration","_ref4","_body$interestRate","_ref5","_body$apr","urls","call","length","supersetBody","lastError","renderLoanCard","isLender","otherParty","canPay","nextDueDate","badgeClass","fundedDate","amountCollected","myOpen","s","onClose","loanId","_c2","$RefreshReg$"],"sources":["/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/dashboard/MoneySummary.jsx"],"sourcesContent":["// src/features/money/MoneySummary.jsx\r\nimport React, { useEffect, useState, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport './MoneySummary.css';\r\nimport UserProfileModal from '../../components/UserProfileModal';\r\nimport LoanThreadModal from '../loans/LoanThreadModal';\r\n\r\n// helper: decode JWT for current user id\r\nfunction getCurrentUserId() {\r\n  const t = localStorage.getItem('token');\r\n  if (!t) return null;\r\n  try {\r\n    const payload = JSON.parse(atob(t.split('.')[1] || ''));\r\n    return payload?.userId ?? null;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nconst fmtMoney = (n) =>\r\n  typeof n === 'number' && !Number.isNaN(n) ? `$${n.toFixed(2)}` : 'â€”';\r\n\r\n// one-line row layout used across all sections\r\nconst ROW_GRID = {\r\n  display: 'grid',\r\n  gridTemplateColumns: 'minmax(160px,1fr) 140px 180px auto auto',\r\n  alignItems: 'center',\r\n  gap: 16,\r\n};\r\n\r\n/* ---------- Child component for a single open request row (with negotiation) ---------- */\r\nfunction OpenRequestRow({\r\n  req,\r\n  isExpanded,\r\n  onToggle,\r\n  actionLoading,\r\n  submitCounter,\r\n  acceptRequest,\r\n  declineRequest,\r\n}) {\r\n  const [proposal, setProposal] = useState({\r\n    amount: req.amount || 0,\r\n    months: req.duration || 1,\r\n    interestRate: req.interestRate || 0,\r\n  });\r\n\r\n  return (\r\n    <div className=\"ms-card\" key={req.id}>\r\n      {/* ONE-LINE TOP ROW */}\r\n      <div className=\"ms-card-row\" style={ROW_GRID}>\r\n        <div>\r\n          <div className=\"ms-label\">Borrower</div>\r\n          <div className=\"ms-value-strong\">{req.borrowerName || 'You'}</div>\r\n        </div>\r\n        <div>\r\n          <div className=\"ms-label\">Amount</div>\r\n          <div className=\"ms-value-strong\">{fmtMoney(req.amount)}</div>\r\n        </div>\r\n        <div>\r\n          <div className=\"ms-label\">Created</div>\r\n          <div className=\"ms-value-strong\">\r\n            {req.createdAt ? new Date(req.createdAt).toLocaleDateString() : 'â€”'}\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ justifySelf: 'end' }}>\r\n          <span className=\"ms-badge ms-badge--warn\">Open</span>\r\n        </div>\r\n\r\n        <div style={{ justifySelf: 'end' }}>\r\n          <button\r\n            className=\"action-btn\"\r\n            onClick={onToggle}\r\n            title=\"View request details\"\r\n          >\r\n            {isExpanded ? 'ðŸ”½ Hide' : 'ðŸ“„ View'}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* DETAILS + NEGOTIATE BAR */}\r\n      {isExpanded && (\r\n        <div className=\"ms-details\">\r\n          <p className=\"mt-6\">\r\n            <strong>Status:</strong> {req.status ?? 'OPEN'}\r\n          </p>\r\n          <p className=\"mt-6\">\r\n            <strong>Interest Rate:</strong>{' '}\r\n            {Number.isFinite(req.interestRate) ? `${req.interestRate}%` : 'â€”'}\r\n          </p>\r\n          <p className=\"mt-6\">\r\n            <strong>Duration:</strong>{' '}\r\n            {Number.isFinite(req.duration) ? `${req.duration} months` : 'â€”'}\r\n          </p>\r\n          {req.purpose ? (\r\n            <p className=\"mt-6\">\r\n              <strong>Reason:</strong> {req.purpose}\r\n            </p>\r\n          ) : null}\r\n          {req.lenderName ? (\r\n            <p className=\"mt-6\">\r\n              <strong>Requested Lender:</strong> {req.lenderName}\r\n            </p>\r\n          ) : null}\r\n\r\n          {/* Negotiate / Accept controls */}\r\n          <div className=\"mt-8\" style={{ display: 'flex', flexWrap: 'wrap', gap: 10 }}>\r\n            <div>\r\n              <label className=\"ms-label\">Amount</label>\r\n              <input\r\n                type=\"number\"\r\n                min=\"1\"\r\n                className=\"auth-input\"\r\n                value={proposal.amount}\r\n                onChange={(e) =>\r\n                  setProposal((p) => ({ ...p, amount: Number(e.target.value) }))\r\n                }\r\n                style={{ width: 140 }}\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"ms-label\">APR %</label>\r\n              <input\r\n                type=\"number\"\r\n                min=\"0\"\r\n                className=\"auth-input\"\r\n                value={proposal.interestRate}\r\n                onChange={(e) =>\r\n                  setProposal((p) => ({ ...p, interestRate: Number(e.target.value) }))\r\n                }\r\n                style={{ width: 120 }}\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"ms-label\">Months</label>\r\n              <input\r\n                type=\"number\"\r\n                min=\"1\"\r\n                className=\"auth-input\"\r\n                value={proposal.months}\r\n                onChange={(e) =>\r\n                  setProposal((p) => ({ ...p, months: Number(e.target.value) }))\r\n                }\r\n                style={{ width: 120 }}\r\n              />\r\n            </div>\r\n\r\n            <div style={{ marginLeft: 'auto', display: 'flex', gap: 8 }}>\r\n              <button\r\n                className=\"action-btn\"\r\n                onClick={() =>\r\n                  submitCounter(\r\n                    req,\r\n                    req.type === 'direct'\r\n                      ? { amount: proposal.amount, apr: proposal.interestRate, months: proposal.months }\r\n                      : { amount: proposal.amount, interestRate: proposal.interestRate, months: proposal.months }\r\n                  )\r\n                }\r\n                disabled={!!actionLoading[req.id]}\r\n              >\r\n                {actionLoading[req.id] ? 'Savingâ€¦' : 'Make Counter-Offer'}\r\n              </button>\r\n              <button\r\n                className=\"action-btn primary\"\r\n                onClick={() => acceptRequest(req)}\r\n                disabled={!!actionLoading[req.id]}\r\n              >\r\n                {actionLoading[req.id] ? 'Workingâ€¦' : 'Accept'}\r\n              </button>\r\n              <button\r\n                className=\"action-btn\"\r\n                onClick={() => declineRequest(req)}\r\n                disabled={!!actionLoading[req.id]}\r\n              >\r\n                {actionLoading[req.id] ? 'Workingâ€¦' : 'Decline'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n/* -------------------------------- Parent -------------------------------- */\r\n\r\nconst MoneySummary = () => {\r\n  const [summary, setSummary] = useState({\r\n    loansGiven: [],\r\n    loansReceived: [],\r\n    myOpenRequests: [],\r\n  });\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [expandedLoans, setExpandedLoans] = useState({});\r\n  const [openSec, setOpenSec] = useState({ open: true, given: true, received: true });\r\n\r\n  const [payLoading, setPayLoading] = useState({});\r\n  const [actionLoading, setActionLoading] = useState({});\r\n  const [profileUserId, setProfileUserId] = useState(null);\r\n  const [threadLoanId, setThreadLoanId] = useState(null);\r\n\r\n  const token = localStorage.getItem('token');\r\n  const navigate = useNavigate();\r\n  const authHeader = token ? { Authorization: `Bearer ${token}` } : {};\r\n\r\n  /* ------------------ Fetch helpers (market + direct) ------------------ */\r\n\r\n  const fetchMarketOpenRequests = async () => {\r\n    const me = getCurrentUserId();\r\n    if (!me) return [];\r\n\r\n    try {\r\n      const r = await fetch('/api/loan-requests/mine?status=OPEN', { headers: authHeader });\r\n      if (r.ok) {\r\n        const list = await r.json();\r\n        const items = Array.isArray(list) ? list : Array.isArray(list?.items) ? list.items : [];\r\n        return items\r\n          .filter((it) => (it?.borrowerId || it?.borrower?.id) === me)\r\n          .map((r) => ({\r\n            type: 'market',\r\n            id: r.id,\r\n            amount: Number(r.amount),\r\n            duration: Number(r.duration ?? r.months),\r\n            interestRate: Number(r.interestRate ?? r.apr),\r\n            purpose: r.purpose || '',\r\n            createdAt: r.createdAt || null,\r\n            borrowerName: r?.borrower?.name || 'You',\r\n            borrowerId: r?.borrower?.id || r.borrowerId || me,\r\n            status: r.status || 'OPEN',\r\n          }));\r\n      }\r\n    } catch {}\r\n\r\n    try {\r\n      const resOpen = await fetch('/api/loans/open', { headers: authHeader });\r\n      if (resOpen.ok) {\r\n        const openListRaw = await resOpen.json();\r\n        const openList = Array.isArray(openListRaw)\r\n          ? openListRaw\r\n          : Array.isArray(openListRaw?.items)\r\n          ? openListRaw.items\r\n          : [];\r\n        const me2 = getCurrentUserId();\r\n        const mine = openList.filter((r) => {\r\n          const borrowerId = r?.borrower?.id || r?.borrowerId;\r\n          return borrowerId && borrowerId === me2;\r\n        });\r\n        return mine.map((r) => ({\r\n          type: 'market',\r\n          id: r.id,\r\n          amount: Number(r.amount),\r\n          duration: Number(r.duration ?? r.months),\r\n          interestRate: Number(r.interestRate ?? r.apr),\r\n          purpose: r.purpose || '',\r\n          createdAt: r.createdAt || null,\r\n          borrowerName: r?.borrower?.name || 'You',\r\n          borrowerId: r?.borrower?.id || r?.borrowerId || me2,\r\n          status: r.status || 'OPEN',\r\n        }));\r\n      }\r\n    } catch {}\r\n\r\n    return [];\r\n  };\r\n\r\n  const fetchDirectOpenRequests = async () => {\r\n    const me = getCurrentUserId();\r\n    if (!me) return [];\r\n\r\n    try {\r\n      const r = await fetch('/api/direct-requests/mine', { headers: authHeader });\r\n      if (!r.ok) return [];\r\n      const data = await r.json();\r\n      const combined = Array.isArray(data)\r\n        ? data\r\n        : [\r\n            ...(Array.isArray(data?.asBorrower) ? data.asBorrower : []),\r\n            ...(Array.isArray(data?.asLender) ? data.asLender : []),\r\n          ];\r\n      const FINAL = new Set(['DECLINED', 'CANCELLED', 'DISBURSED', 'APPROVED', 'REJECTED']);\r\n      return combined\r\n        .filter((d) => !FINAL.has((d?.status || '').toUpperCase()))\r\n        .map((d) => {\r\n          const borrowerId = d.borrowerId || d?.borrower?.id;\r\n          const lenderId = d.lenderId || d?.lender?.id;\r\n          const iAmBorrower = borrowerId === me;\r\n\r\n          return {\r\n            type: 'direct',\r\n            id: d.id,\r\n            amount: Number(d.amount),\r\n            duration: Number(d.months ?? d.duration),\r\n            interestRate: Number(d.apr ?? d.interestRate),\r\n            createdAt: d.createdAt || null,\r\n            borrowerId,\r\n            borrowerName: d?.borrower?.name || (iAmBorrower ? 'You' : ''),\r\n            lenderId,\r\n            lenderName: d?.lender?.name || (!iAmBorrower ? 'Counterparty' : ''),\r\n            status: d.status || 'PENDING',\r\n          };\r\n        });\r\n    } catch {\r\n      return [];\r\n    }\r\n  };\r\n\r\n  const fetchSummary = useCallback(async () => {\r\n    if (!token) return;\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch('/api/users/my-money-summary', { headers: authHeader });\r\n      let loansGiven = [];\r\n      let loansReceived = [];\r\n      if (res.ok) {\r\n        const data = await res.json();\r\n        loansGiven = Array.isArray(data.loansGiven)\r\n          ? data.loansGiven\r\n          : Array.isArray(data.loansAsLender)\r\n          ? data.loansAsLender\r\n          : [];\r\n        loansReceived = Array.isArray(data.loansReceived)\r\n          ? data.loansReceived\r\n          : Array.isArray(data.loansAsBorrower)\r\n          ? data.loansAsBorrower\r\n          : [];\r\n      }\r\n\r\n      const [marketOpen, directOpen] = await Promise.all([\r\n        fetchMarketOpenRequests(),\r\n        fetchDirectOpenRequests(),\r\n      ]);\r\n      const myOpenRequests = [...marketOpen, ...directOpen];\r\n\r\n      setSummary({ loansGiven, loansReceived, myOpenRequests });\r\n    } catch (err) {\r\n      console.error('Error fetching money summary:', err);\r\n      setSummary({ loansGiven: [], loansReceived: [], myOpenRequests: [] });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [token]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    fetchSummary();\r\n  }, [fetchSummary]);\r\n\r\n  const loanKey = (loan, idx) => loan?.id || loan?._id || String(idx);\r\n\r\n  const toggleLoanDetails = (id) => {\r\n    setExpandedLoans((prev) => ({\r\n      ...(Object.keys(prev).reduce((acc, k) => ({ ...acc, [k]: false }), {})),\r\n      [id]: !prev[id],\r\n    }));\r\n  };\r\n\r\n  const payNext = async (loan) => {\r\n    const key = loanKey(loan);\r\n    const amount = loan?.installmentAmount ?? 0;\r\n    if (!window.confirm(`Pay the next installment (${fmtMoney(amount)})?`)) return;\r\n    try {\r\n      setPayLoading((m) => ({ ...m, [key]: true }));\r\n      const res = await fetch(`/api/loans/${loan.id || loan._id}/pay-next`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json', ...authHeader },\r\n        credentials: 'include',\r\n      });\r\n      const data = await res.json();\r\n      if (!res.ok) throw new Error(data?.error || 'Payment failed');\r\n      const paid = typeof data.amount === 'number' ? data.amount : amount;\r\n      alert(`Payment successful! Amount: ${fmtMoney(paid)}`);\r\n      await fetchSummary();\r\n    } catch (e) {\r\n      alert(e.message);\r\n    } finally {\r\n      setPayLoading((m) => ({ ...m, [key]: false }));\r\n    }\r\n  };\r\n\r\n    /* -------------------- Action endpoints + helpers -------------------- */\r\n\r\n  // Build fallback lists for each action. Weâ€™ll try these in order until one succeeds.\r\n  const actionPaths = {\r\n    market: {\r\n      accept: (id) => [\r\n        `/api/loan-requests/${id}/accept`,\r\n        `/api/loan-requests/${id}/approve`,\r\n        `/api/loan-requests/${id}/respond?action=ACCEPT`,\r\n      ],\r\n      decline: (id) => [\r\n        `/api/loan-requests/${id}/decline`,\r\n        `/api/loan-requests/${id}/reject`,\r\n        `/api/loan-requests/${id}/respond?action=DECLINE`,\r\n      ],\r\n      counter: (id) => [\r\n        `/api/loan-requests/${id}/counter-offer`,\r\n        `/api/loan-requests/${id}/counter`,\r\n        `/api/loan-requests/${id}/respond?action=COUNTER`,\r\n      ],\r\n    },\r\n    direct: {\r\n      accept: (id) => [\r\n        `/api/direct-requests/${id}/accept`,\r\n        `/api/direct-requests/${id}/approve`,\r\n        `/api/direct-requests/${id}/respond?action=ACCEPT`,\r\n      ],\r\n      decline: (id) => [\r\n        `/api/direct-requests/${id}/decline`,\r\n        `/api/direct-requests/${id}/reject`,\r\n        `/api/direct-requests/${id}/respond?action=DECLINE`,\r\n      ],\r\n      counter: (id) => [\r\n        `/api/direct-requests/${id}/counter-offer`,\r\n        `/api/direct-requests/${id}/counter`,\r\n        `/api/direct-requests/${id}/respond?action=COUNTER`,\r\n      ],\r\n    },\r\n  };\r\n\r\n  // Try POST â†’ PUT â†’ PATCH for a given url + body.\r\n  async function tryVerbs(url, body) {\r\n    const optionsBase = {\r\n      headers: { 'Content-Type': 'application/json', ...authHeader },\r\n      body: body ? JSON.stringify(body) : undefined,\r\n    };\r\n\r\n    // order matters; some backends only accept POST, others PUT/PATCH\r\n    const verbs = ['POST', 'PUT', 'PATCH'];\r\n    let lastErr = null;\r\n\r\n    for (const method of verbs) {\r\n      try {\r\n        const r = await fetch(url, { method, ...optionsBase });\r\n        if (r.ok) return r;\r\n        // save details and keep trying\r\n        const txt = await r.text().catch(() => '');\r\n        lastErr = new Error(`${r.status} ${r.statusText}${txt ? ` â€¢ ${txt}` : ''}`);\r\n      } catch (e) {\r\n        lastErr = e;\r\n      }\r\n    }\r\n    throw lastErr || new Error('All methods failed');\r\n  }\r\n\r\n  // Master action caller: tries multiple paths & multiple verbs, shows good error text on failure\r\n  const callAction = async (type, id, which, body) => {\r\n    setActionLoading((m) => ({ ...m, [id]: true }));\r\n    try {\r\n      const urls = actionPaths[type]?.[which]?.(id) || [];\r\n      if (!urls.length) throw new Error(`Unknown action: ${type}.${which}`);\r\n\r\n      // ensure we send a superset payload that covers common backend shapes\r\n      const supersetBody = body\r\n        ? {\r\n            ...body,\r\n            // normalize keys that different backends use\r\n            amount: body.amount ?? body.value ?? undefined,\r\n            months: body.months ?? body.duration ?? undefined,\r\n            duration: body.duration ?? body.months ?? undefined,\r\n            interestRate: body.interestRate ?? body.apr ?? undefined,\r\n            apr: body.apr ?? body.interestRate ?? undefined,\r\n          }\r\n        : undefined;\r\n\r\n      let ok = false;\r\n      let lastError = null;\r\n\r\n      for (const url of urls) {\r\n        try {\r\n          const r = await tryVerbs(url, supersetBody);\r\n          // success\r\n          ok = true;\r\n          break;\r\n        } catch (e) {\r\n          lastError = e;\r\n          // loop and try the next url\r\n        }\r\n      }\r\n\r\n      if (!ok) throw lastError || new Error('No endpoint accepted this action');\r\n\r\n      // Refresh the list\r\n      await fetchSummary();\r\n    } catch (e) {\r\n      console.error(e);\r\n      alert(`Action failed:\\n${e.message || e}`);\r\n    } finally {\r\n      setActionLoading((m) => ({ ...m, [id]: false }));\r\n    }\r\n  };\r\n\r\n  // Simple wrappers used by the row component\r\n  const acceptRequest = (req) => callAction(req.type, req.id, 'accept');\r\n  const declineRequest = (req) => callAction(req.type, req.id, 'decline');\r\n  const submitCounter = (req, proposal) => callAction(req.type, req.id, 'counter', proposal);\r\n\r\n\r\n  /* ----------------------- Card renderers (one-line) ----------------------- */\r\n\r\n  const renderLoanCard = (loan, isLender, idx) => {\r\n    const key = loanKey(loan, idx);\r\n    const isExpanded = !!expandedLoans[key];\r\n    const otherParty = isLender ? loan.borrowerName : loan.lenderName;\r\n\r\n    const canPay =\r\n      !isLender &&\r\n      typeof loan.installmentAmount === 'number' &&\r\n      loan.installmentAmount > 0 &&\r\n      !!loan.nextDueDate;\r\n\r\n    const badgeClass =\r\n      (loan.status || '').toUpperCase() === 'FUNDED'\r\n        ? 'ms-badge ms-badge--ok'\r\n        : 'ms-badge ms-badge--warn';\r\n\r\n    const fundedDate =\r\n      loan.fundedDate ? new Date(loan.fundedDate).toLocaleDateString() : 'â€”';\r\n\r\n    return (\r\n      <div className=\"ms-card\" key={key}>\r\n        <div className=\"ms-card-row\" style={ROW_GRID}>\r\n          <div>\r\n            <div className=\"ms-label\">{isLender ? 'Borrower' : 'Lender'}</div>\r\n            <div className=\"ms-value-strong\">{otherParty || 'Unknown'}</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"ms-label\">Amount</div>\r\n            <div className=\"ms-value-strong\">{fmtMoney(loan.amount)}</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"ms-label\">Funded Date</div>\r\n            <div className=\"ms-value-strong\">{fundedDate}</div>\r\n          </div>\r\n          <div style={{ justifySelf: 'end' }}>\r\n            <span className={badgeClass}>{loan.status || 'â€”'}</span>\r\n          </div>\r\n          <div style={{ justifySelf: 'end', display: 'flex', gap: 8 }}>\r\n            <button\r\n              onClick={() => setThreadLoanId(loan.id || loan._id)}\r\n              className=\"action-btn\"\r\n              title=\"Open conversation\"\r\n            >\r\n              ðŸ’¬ Messages\r\n            </button>\r\n            <button\r\n              onClick={() => toggleLoanDetails(key)}\r\n              className=\"action-btn\"\r\n              title=\"View contract\"\r\n            >\r\n              {isExpanded ? 'ðŸ”½ Hide' : 'ðŸ“„ View'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {isExpanded && (\r\n          <div className=\"ms-details\">\r\n            {loan.status && (\r\n              <p className=\"mt-6\">\r\n                <strong>Status:</strong> {loan.status}\r\n              </p>\r\n            )}\r\n            <p className=\"mt-6\">\r\n              <strong>Interest Rate:</strong>{' '}\r\n              {typeof loan.interestRate === 'number' ? `${loan.interestRate}%` : 'â€”'}\r\n            </p>\r\n            <p className=\"mt-6\">\r\n              <strong>Duration:</strong>{' '}\r\n              {typeof loan.duration === 'number' ? `${loan.duration} months` : 'â€”'}\r\n            </p>\r\n            <p className=\"mt-6\">\r\n              <strong>Next Due Date:</strong>{' '}\r\n              {loan.nextDueDate ? new Date(loan.nextDueDate).toLocaleDateString() : 'â€”'}\r\n            </p>\r\n            <p className=\"mt-6\">\r\n              <strong>Installment (this period):</strong> {fmtMoney(loan.installmentAmount)}\r\n            </p>\r\n\r\n            {isLender && typeof loan.amountCollected === 'number' && (\r\n              <p className=\"mt-6\">\r\n                <strong>Amount collected on loan:</strong> {fmtMoney(loan.amountCollected)}\r\n              </p>\r\n            )}\r\n\r\n            {!isLender && canPay && (\r\n              <div className=\"mt-6\">\r\n                <button\r\n                  className=\"action-btn primary\"\r\n                  onClick={() => payNext(loan)}\r\n                  disabled={!!payLoading[key]}\r\n                  title=\"Pay next installment\"\r\n                >\r\n                  {payLoading[key] ? 'Processingâ€¦' : 'ðŸ’³ Make Payment'}\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  /* ------------------------------- Render ------------------------------- */\r\n\r\n  if (loading) return <p className=\"ms-loading ms-container\">Loading money summary...</p>;\r\n\r\n  const given = Array.isArray(summary.loansGiven) ? summary.loansGiven : [];\r\n  const received = Array.isArray(summary.loansReceived) ? summary.loansReceived : [];\r\n  const myOpen = Array.isArray(summary.myOpenRequests) ? summary.myOpenRequests : [];\r\n\r\n  return (\r\n    <div className=\"ms-container\">\r\n      <h2 className=\"ms-heading\">ðŸ’µ My Money Summary</h2>\r\n\r\n      {/* Section: Open Requests */}\r\n      <div className=\"ms-section\">\r\n        <button\r\n          className=\"ms-section-head\"\r\n          onClick={() => setOpenSec((s) => ({ ...s, open: !s.open }))}\r\n          aria-expanded={openSec.open}\r\n        >\r\n          <div className=\"ms-subheading\">My Open Loan Requests</div>\r\n          <div className=\"ms-caret\">{openSec.open ? 'â–¾' : 'â–¸'}</div>\r\n        </button>\r\n        {openSec.open && (\r\n          <div className=\"ms-section-body\">\r\n            {myOpen.length === 0 ? (\r\n              <p className=\"ms-empty\">You have no open requests.</p>\r\n            ) : (\r\n              myOpen.map((req) => (\r\n                <OpenRequestRow\r\n                  key={req.id}\r\n                  req={req}\r\n                  isExpanded={!!expandedLoans[req.id]}\r\n                  onToggle={() => toggleLoanDetails(req.id)}\r\n                  actionLoading={actionLoading}\r\n                  submitCounter={submitCounter}\r\n                  acceptRequest={acceptRequest}\r\n                  declineRequest={declineRequest}\r\n                />\r\n              ))\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Section: Loans Given */}\r\n      <div className=\"ms-section\">\r\n        <button\r\n          className=\"ms-section-head\"\r\n          onClick={() => setOpenSec((s) => ({ ...s, given: !s.given }))}\r\n          aria-expanded={openSec.given}\r\n        >\r\n          <div className=\"ms-subheading\">Loans Given (I'm the Lender)</div>\r\n          <div className=\"ms-caret\">{openSec.given ? 'â–¾' : 'â–¸'}</div>\r\n        </button>\r\n        {openSec.given && (\r\n          <div className=\"ms-section-body\">\r\n            {given.length === 0 ? (\r\n              <p className=\"ms-empty\">No loans given yet.</p>\r\n            ) : (\r\n              given.map((loan, idx) => renderLoanCard(loan, true, idx))\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Section: Loans Received */}\r\n      <div className=\"ms-section\">\r\n        <button\r\n          className=\"ms-section-head\"\r\n          onClick={() => setOpenSec((s) => ({ ...s, received: !s.received }))}\r\n          aria-expanded={openSec.received}\r\n        >\r\n          <div className=\"ms-subheading\">Loans Received (I'm the Borrower)</div>\r\n          <div className=\"ms-caret\">{openSec.received ? 'â–¾' : 'â–¸'}</div>\r\n        </button>\r\n        {openSec.received && (\r\n          <div className=\"ms-section-body\">\r\n            {received.length === 0 ? (\r\n              <p className=\"ms-empty\">No loans received yet.</p>\r\n            ) : (\r\n              received.map((loan, idx) => renderLoanCard(loan, false, idx))\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {profileUserId && (\r\n        <UserProfileModal userId={profileUserId} onClose={() => setProfileUserId(null)} />\r\n      )}\r\n      {threadLoanId && (\r\n        <LoanThreadModal loanId={threadLoanId} onClose={() => setThreadLoanId(null)} />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MoneySummary;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}