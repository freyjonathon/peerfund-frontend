{"ast":null,"code":"import _objectSpread from\"/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/features/direct/DirectRequestConfirm.jsx\nimport React,{useMemo,useState}from'react';import{useNavigate,useParams,useSearchParams,useLocation}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function DirectRequestConfirm(){var _ref,_sp$get,_ref2,_sp$get2,_ref3,_sp$get3;const navigate=useNavigate();const{lenderId}=useParams();const[sp]=useSearchParams();const{state}=useLocation();// <= also support history state\n// prefer query params, fall back to `location.state`\nconst amount=Number((_ref=(_sp$get=sp.get('amount'))!==null&&_sp$get!==void 0?_sp$get:state===null||state===void 0?void 0:state.amount)!==null&&_ref!==void 0?_ref:0);const rate=Number((_ref2=(_sp$get2=sp.get('rate'))!==null&&_sp$get2!==void 0?_sp$get2:state===null||state===void 0?void 0:state.rate)!==null&&_ref2!==void 0?_ref2:0);const months=Number((_ref3=(_sp$get3=sp.get('months'))!==null&&_sp$get3!==void 0?_sp$get3:state===null||state===void 0?void 0:state.months)!==null&&_ref3!==void 0?_ref3:0);const[submitting,setSubmitting]=useState(false);const canSubmit=useMemo(()=>lenderId&&Number.isFinite(amount)&&amount>0&&Number.isFinite(rate)&&months>0,[lenderId,amount,rate,months]);const onCancel=()=>navigate(-1);const onConfirm=async()=>{if(!canSubmit)return;try{setSubmitting(true);const token=localStorage.getItem('token')||'';const res=await fetch('/api/direct-requests',{method:'POST',headers:_objectSpread({'Content-Type':'application/json'},token?{Authorization:\"Bearer \".concat(token)}:{}),body:JSON.stringify({lenderId,amount,months,apr:rate})});const data=await res.json().catch(()=>({}));if(!res.ok)throw new Error((data===null||data===void 0?void 0:data.error)||'Failed to submit request');alert('Direct loan request sent!');navigate('/money-summary');}catch(e){alert(e.message);}finally{setSubmitting(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"auth-wrap\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"auth-card\",style:{maxWidth:520},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"auth-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"auth-logo\",children:\"PF\"}),/*#__PURE__*/_jsx(\"div\",{className:\"auth-title\",children:\"Confirm Direct Loan Request\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"auth-sub\",children:\"Review and confirm your request.\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12},children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Lender ID:\"}),\" \",lenderId]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Amount:\"}),\" $\",amount.toFixed(2)]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"APR:\"}),\" \",rate,\"%\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Months:\"}),\" \",months]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"auth-actions\",style:{marginTop:16},children:[/*#__PURE__*/_jsx(\"button\",{className:\"auth-btn\",onClick:onCancel,disabled:submitting,children:\"Back\"}),/*#__PURE__*/_jsx(\"button\",{className:\"auth-btn primary\",onClick:onConfirm,disabled:submitting||!canSubmit,children:submitting?'Submitting…':'Confirm & Send'})]})]})});}","map":{"version":3,"names":["React","useMemo","useState","useNavigate","useParams","useSearchParams","useLocation","jsx","_jsx","jsxs","_jsxs","DirectRequestConfirm","_ref","_sp$get","_ref2","_sp$get2","_ref3","_sp$get3","navigate","lenderId","sp","state","amount","Number","get","rate","months","submitting","setSubmitting","canSubmit","isFinite","onCancel","onConfirm","token","localStorage","getItem","res","fetch","method","headers","_objectSpread","Authorization","concat","body","JSON","stringify","apr","data","json","catch","ok","Error","error","alert","e","message","className","children","style","maxWidth","marginTop","toFixed","onClick","disabled"],"sources":["/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/direct/DirectRequestConfirm.jsx"],"sourcesContent":["// src/features/direct/DirectRequestConfirm.jsx\nimport React, { useMemo, useState } from 'react';\nimport { useNavigate, useParams, useSearchParams, useLocation } from 'react-router-dom';\n\nexport default function DirectRequestConfirm() {\n  const navigate = useNavigate();\n  const { lenderId } = useParams();\n  const [sp] = useSearchParams();\n  const { state } = useLocation();     // <= also support history state\n\n  // prefer query params, fall back to `location.state`\n  const amount = Number(sp.get('amount') ?? state?.amount ?? 0);\n  const rate   = Number(sp.get('rate')   ?? state?.rate   ?? 0);\n  const months = Number(sp.get('months') ?? state?.months ?? 0);\n\n  const [submitting, setSubmitting] = useState(false);\n  const canSubmit = useMemo(\n    () => lenderId && Number.isFinite(amount) && amount > 0 && Number.isFinite(rate) && months > 0,\n    [lenderId, amount, rate, months]\n  );\n\n  const onCancel = () => navigate(-1);\n\n  const onConfirm = async () => {\n    if (!canSubmit) return;\n    try {\n      setSubmitting(true);\n      const token = localStorage.getItem('token') || '';\n      const res = await fetch('/api/direct-requests', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(token ? { Authorization: `Bearer ${token}` } : {}),\n        },\n        body: JSON.stringify({ lenderId, amount, months, apr: rate }),\n      });\n      const data = await res.json().catch(() => ({}));\n      if (!res.ok) throw new Error(data?.error || 'Failed to submit request');\n      alert('Direct loan request sent!');\n      navigate('/money-summary');\n    } catch (e) {\n      alert(e.message);\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"auth-wrap\">\n      <div className=\"auth-card\" style={{ maxWidth: 520 }}>\n        <div className=\"auth-header\">\n          <div className=\"auth-logo\">PF</div>\n          <div className=\"auth-title\">Confirm Direct Loan Request</div>\n        </div>\n\n        <div className=\"auth-sub\">Review and confirm your request.</div>\n\n        <div style={{ marginTop: 12 }}>\n          <p><strong>Lender ID:</strong> {lenderId}</p>\n          <p><strong>Amount:</strong> ${amount.toFixed(2)}</p>\n          <p><strong>APR:</strong> {rate}%</p>\n          <p><strong>Months:</strong> {months}</p>\n        </div>\n\n        <div className=\"auth-actions\" style={{ marginTop: 16 }}>\n          <button className=\"auth-btn\" onClick={onCancel} disabled={submitting}>Back</button>\n          <button className=\"auth-btn primary\" onClick={onConfirm} disabled={submitting || !canSubmit}>\n            {submitting ? 'Submitting…' : 'Confirm & Send'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}