{"ast":null,"code":"var _jsxFileName = \"/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/components/RequireAdmin.jsx\",\n  _s = $RefreshSig$();\n// src/components/RequireAdmin.jsx\nimport React, { useEffect, useState } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst RequireAdmin = ({\n  children\n}) => {\n  _s();\n  const [loading, setLoading] = useState(true);\n  const [isAdmin, setIsAdmin] = useState(false);\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setLoading(false);\n      setIsAdmin(false);\n      return;\n    }\n    const checkAdmin = async () => {\n      try {\n        const res = await fetch('/api/users/profile', {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        if (!res.ok) {\n          throw new Error('Failed to load profile');\n        }\n        const data = await res.json();\n        // Your backend returns role: 'ADMIN' | 'USER' | 'SUPERUSER'\n        if (data.role === 'ADMIN') {\n          setIsAdmin(true);\n        } else {\n          setIsAdmin(false);\n        }\n      } catch (err) {\n        console.error('RequireAdmin error:', err);\n        setIsAdmin(false);\n      } finally {\n        setLoading(false);\n      }\n    };\n    checkAdmin();\n  }, []);\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '1rem'\n      },\n      children: \"Checking admin access\\u2026\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }, this);\n  }\n  if (!isAdmin) {\n    // They’re logged in but not an admin – send back to normal app\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/dashboard\",\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 12\n    }, this);\n  }\n  return children;\n};\n_s(RequireAdmin, \"xVTL6OGf1Dz1Fb1+C9WwZBdUN00=\");\n_c = RequireAdmin;\nexport default RequireAdmin;\nvar _c;\n$RefreshReg$(_c, \"RequireAdmin\");","map":{"version":3,"names":["React","useEffect","useState","Navigate","jsxDEV","_jsxDEV","RequireAdmin","children","_s","loading","setLoading","isAdmin","setIsAdmin","token","localStorage","getItem","checkAdmin","res","fetch","headers","Authorization","ok","Error","data","json","role","err","console","error","style","padding","fileName","_jsxFileName","lineNumber","columnNumber","to","replace","_c","$RefreshReg$"],"sources":["/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/components/RequireAdmin.jsx"],"sourcesContent":["// src/components/RequireAdmin.jsx\nimport React, { useEffect, useState } from 'react';\nimport { Navigate } from 'react-router-dom';\n\nconst RequireAdmin = ({ children }) => {\n  const [loading, setLoading] = useState(true);\n  const [isAdmin, setIsAdmin] = useState(false);\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setLoading(false);\n      setIsAdmin(false);\n      return;\n    }\n\n    const checkAdmin = async () => {\n      try {\n        const res = await fetch('/api/users/profile', {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n\n        if (!res.ok) {\n          throw new Error('Failed to load profile');\n        }\n\n        const data = await res.json();\n        // Your backend returns role: 'ADMIN' | 'USER' | 'SUPERUSER'\n        if (data.role === 'ADMIN') {\n          setIsAdmin(true);\n        } else {\n          setIsAdmin(false);\n        }\n      } catch (err) {\n        console.error('RequireAdmin error:', err);\n        setIsAdmin(false);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    checkAdmin();\n  }, []);\n\n  if (loading) {\n    return (\n      <div style={{ padding: '1rem' }}>\n        Checking admin access…\n      </div>\n    );\n  }\n\n  if (!isAdmin) {\n    // They’re logged in but not an admin – send back to normal app\n    return <Navigate to=\"/dashboard\" replace />;\n  }\n\n  return children;\n};\n\nexport default RequireAdmin;\n"],"mappings":";;AAAA;AACA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,QAAQ,QAAQ,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE5C,MAAMC,YAAY,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EACrC,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGR,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAACS,OAAO,EAAEC,UAAU,CAAC,GAAGV,QAAQ,CAAC,KAAK,CAAC;EAE7CD,SAAS,CAAC,MAAM;IACd,MAAMY,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,IAAI,CAACF,KAAK,EAAE;MACVH,UAAU,CAAC,KAAK,CAAC;MACjBE,UAAU,CAAC,KAAK,CAAC;MACjB;IACF;IAEA,MAAMI,UAAU,GAAG,MAAAA,CAAA,KAAY;MAC7B,IAAI;QACF,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,oBAAoB,EAAE;UAC5CC,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUP,KAAK;UAAG;QAC9C,CAAC,CAAC;QAEF,IAAI,CAACI,GAAG,CAACI,EAAE,EAAE;UACX,MAAM,IAAIC,KAAK,CAAC,wBAAwB,CAAC;QAC3C;QAEA,MAAMC,IAAI,GAAG,MAAMN,GAAG,CAACO,IAAI,CAAC,CAAC;QAC7B;QACA,IAAID,IAAI,CAACE,IAAI,KAAK,OAAO,EAAE;UACzBb,UAAU,CAAC,IAAI,CAAC;QAClB,CAAC,MAAM;UACLA,UAAU,CAAC,KAAK,CAAC;QACnB;MACF,CAAC,CAAC,OAAOc,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAAC,qBAAqB,EAAEF,GAAG,CAAC;QACzCd,UAAU,CAAC,KAAK,CAAC;MACnB,CAAC,SAAS;QACRF,UAAU,CAAC,KAAK,CAAC;MACnB;IACF,CAAC;IAEDM,UAAU,CAAC,CAAC;EACd,CAAC,EAAE,EAAE,CAAC;EAEN,IAAIP,OAAO,EAAE;IACX,oBACEJ,OAAA;MAAKwB,KAAK,EAAE;QAAEC,OAAO,EAAE;MAAO,CAAE;MAAAvB,QAAA,EAAC;IAEjC;MAAAwB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;EAEV;EAEA,IAAI,CAACvB,OAAO,EAAE;IACZ;IACA,oBAAON,OAAA,CAACF,QAAQ;MAACgC,EAAE,EAAC,YAAY;MAACC,OAAO;IAAA;MAAAL,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAC7C;EAEA,OAAO3B,QAAQ;AACjB,CAAC;AAACC,EAAA,CAtDIF,YAAY;AAAA+B,EAAA,GAAZ/B,YAAY;AAwDlB,eAAeA,YAAY;AAAC,IAAA+B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}