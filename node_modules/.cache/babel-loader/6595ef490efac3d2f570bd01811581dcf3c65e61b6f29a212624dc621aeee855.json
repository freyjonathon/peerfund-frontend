{"ast":null,"code":"var _jsxFileName = \"/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/loans/LoanDetails.jsx\",\n  _s = $RefreshSig$();\n// src/features/loans/LoanDetails.jsx\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate, useSearchParams } from 'react-router-dom';\nimport RepaymentForm from './RepaymentForm';\nimport ContractModal from '../../components/ContractModal';\nimport UserProfileModal from '../../components/UserProfileModal';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LoanDetails = () => {\n  _s();\n  var _loan$borrower, _loan$loanOffers, _loan$borrower3, _loan$borrower4;\n  const {\n    loanId\n  } = useParams();\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const [loan, setLoan] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [showRepaymentForm, setShowRepaymentForm] = useState(false);\n  const [selectedOffer, setSelectedOffer] = useState(null);\n  const [showContractModal, setShowContractModal] = useState(false);\n\n  // NEW: which offer rows are expanded\n  const [expandedOffer, setExpandedOffer] = useState({});\n  const [offerForm, setOfferForm] = useState({\n    amount: '',\n    duration: '',\n    interestRate: '',\n    message: ''\n  });\n  const token = localStorage.getItem('token');\n  const userId = token ? JSON.parse(atob(token.split('.')[1])).userId : null;\n  const handleOfferChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setOfferForm(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n  const submitOffer = async () => {\n    try {\n      const res = await fetch(`/api/loans/${loanId}/offers`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify(offerForm)\n      });\n      if (!res.ok) throw new Error('Failed to submit offer');\n      const data = await res.json();\n      alert('Offer submitted!');\n      setLoan(prev => ({\n        ...prev,\n        loanOffers: [data, ...(prev.loanOffers || [])]\n      }));\n      setOfferForm({\n        amount: '',\n        duration: '',\n        interestRate: '',\n        message: ''\n      });\n    } catch (err) {\n      console.error('Error submitting offer:', err);\n      alert('There was a problem submitting your offer.');\n    }\n  };\n  const fetchLoanDetails = async () => {\n    try {\n      const res = await fetch(`/api/loans/${loanId}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const data = await res.json();\n      setLoan(data);\n      setMessages(data.messages || []);\n    } catch (err) {\n      console.error('Error fetching loan details:', err);\n    }\n  };\n  useEffect(() => {\n    fetchLoanDetails();\n  }, [loanId]); // eslint-friendly\n\n  // Scroll to discussion if ?tab=discussion\n  useEffect(() => {\n    if (searchParams.get('tab') === 'discussion' && loan) {\n      setTimeout(() => {\n        const el = document.getElementById('discussion-thread');\n        if (el) el.scrollIntoView({\n          behavior: 'smooth',\n          block: 'start'\n        });\n      }, 0);\n    }\n  }, [searchParams, loan]);\n  const handleSendMessage = async () => {\n    if (!newMessage.trim()) return;\n    try {\n      const res = await fetch(`/api/loans/${loanId}/messages`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          content: newMessage\n        })\n      });\n      const data = await res.json();\n      setMessages(prev => [...prev, data]);\n      setNewMessage('');\n    } catch (err) {\n      console.error('Error sending message:', err);\n    }\n  };\n  const handleAcceptOffer = offer => {\n    setSelectedOffer(offer);\n    setShowContractModal(true);\n  };\n\n  // NEW: toggle a specific offer accordion\n  const toggleOffer = offerId => setExpandedOffer(prev => ({\n    ...prev,\n    [offerId]: !prev[offerId]\n  }));\n  if (!loan) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Loading loan details...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 21\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: '2rem'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [\"Loan Request by \", ((_loan$borrower = loan.borrower) === null || _loan$borrower === void 0 ? void 0 : _loan$borrower.name) || 'Unknown User']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        gap: '12px',\n        alignItems: 'flex-start',\n        marginBottom: '1rem'\n      },\n      children: /*#__PURE__*/_jsxDEV(UserProfileModal, {\n        user: loan.borrower\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Amount:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 10\n      }, this), \" $\", loan.amount]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Duration:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 10\n      }, this), \" \", loan.duration, \" months\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Reason:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 10\n      }, this), \" \", loan.purpose]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Status:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 10\n      }, this), \" \", loan.status]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Offers\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this), ((_loan$loanOffers = loan.loanOffers) === null || _loan$loanOffers === void 0 ? void 0 : _loan$loanOffers.length) > 0 ? loan.loanOffers.map(offer => {\n      var _offer$lender, _loan$borrower2;\n      const isOpen = !!expandedOffer[offer.id];\n      const statusLabel = loan.status === 'FUNDED' ? 'Accepted' : 'Pending';\n      const badgeStyle = loan.status === 'FUNDED' ? {\n        background: '#dcfce7',\n        color: '#166534',\n        borderColor: '#86efac'\n      } : {\n        background: '#fef3c7',\n        color: '#92400e',\n        borderColor: '#fde68a'\n      };\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          border: '1px solid #e2e8f0',\n          borderRadius: 12,\n          background: '#fff',\n          marginBottom: 12,\n          overflow: 'hidden'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => toggleOffer(offer.id),\n          \"aria-expanded\": isOpen,\n          style: {\n            width: '100%',\n            textAlign: 'left',\n            background: '#f8fafc',\n            border: 0,\n            padding: '12px 14px',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'space-between',\n            cursor: 'pointer'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              alignItems: 'center',\n              gap: 10\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                width: 8,\n                height: 8,\n                borderRadius: 999,\n                background: '#6366f1',\n                display: 'inline-block'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                fontWeight: 700,\n                color: '#0f172a'\n              },\n              children: [\"Offer from \", ((_offer$lender = offer.lender) === null || _offer$lender === void 0 ? void 0 : _offer$lender.name) || 'Unknown']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              gap: 12,\n              alignItems: 'center',\n              color: '#334155',\n              fontSize: 14\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"$\", Number(offer.amount || 0).toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [offer.interestRate, \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [offer.duration, \" mo\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                borderRadius: 999,\n                padding: '2px 8px',\n                fontSize: 12,\n                fontWeight: 700,\n                border: '1px solid',\n                ...badgeStyle\n              },\n              children: statusLabel\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                fontSize: 18,\n                color: '#64748b'\n              },\n              children: isOpen ? '▾' : '▸'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 15\n        }, this), isOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '12px 14px 14px',\n            borderTop: '1px solid #e2e8f0'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Message:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 22\n            }, this), \" \", offer.message || '—']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 19\n          }, this), loan.status === 'OPEN' && userId === ((_loan$borrower2 = loan.borrower) === null || _loan$borrower2 === void 0 ? void 0 : _loan$borrower2.id) && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleAcceptOffer(offer),\n            style: {\n              background: '#4f46e5',\n              border: '1px solid #4f46e5',\n              color: '#fff',\n              fontWeight: 700,\n              padding: '8px 12px',\n              borderRadius: 10,\n              cursor: 'pointer'\n            },\n            children: \"Accept Offer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 17\n        }, this)]\n      }, offer.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 13\n      }, this);\n    }) : /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"No offers yet.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 9\n    }, this), loan.status === 'OPEN' && ((_loan$borrower3 = loan.borrower) === null || _loan$borrower3 === void 0 ? void 0 : _loan$borrower3.id) !== userId && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: '2rem',\n        padding: '1rem',\n        border: '1px solid #888',\n        borderRadius: 10\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Submit an Offer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Amount ($):\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 24\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"amount\",\n          value: offerForm.amount,\n          onChange: handleOfferChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Duration (months):\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 31\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"duration\",\n          value: offerForm.duration,\n          onChange: handleOfferChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Interest Rate (%):\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 31\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"interestRate\",\n          step: \"0.01\",\n          value: offerForm.interestRate,\n          onChange: handleOfferChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Message (optional):\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 32\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          name: \"message\",\n          value: offerForm.message,\n          onChange: handleOfferChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: submitOffer,\n        children: \"Submit Offer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 9\n    }, this), loan.status === 'FUNDED' && userId === ((_loan$borrower4 = loan.borrower) === null || _loan$borrower4 === void 0 ? void 0 : _loan$borrower4.id) && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: '2rem'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Repayments\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setShowRepaymentForm(true),\n        children: \"Make a Payment\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate(`/loan/${loan.id}/repayments`),\n        children: \"View Repayment Tracker\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 11\n      }, this), showRepaymentForm && /*#__PURE__*/_jsxDEV(RepaymentForm, {\n        loanId: loan.id\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 33\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 7\n    }, this), showContractModal && selectedOffer && /*#__PURE__*/_jsxDEV(ContractModal, {\n      offer: selectedOffer,\n      borrower: loan.borrower,\n      onConfirm: async () => {\n        try {\n          const res = await fetch(`/api/loans/offers/${selectedOffer.id}/accept`, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              Authorization: `Bearer ${token}`\n            }\n          });\n          if (!res.ok) {\n            const errorText = await res.text();\n            alert(`❌ ${errorText || 'Something went wrong'}`);\n            return;\n          }\n          await res.json();\n          alert('✅ Loan contract created and saved!');\n          setShowContractModal(false);\n          navigate('/dashboard');\n        } catch (err) {\n          console.error('❌ Error finalizing contract:', err);\n          alert('Network or server error occurred.');\n        }\n      },\n      onCancel: () => setShowContractModal(false)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 121,\n    columnNumber: 5\n  }, this);\n};\n_s(LoanDetails, \"UOh/fAxDeW/nXMNOcZLIhlDSaeI=\", false, function () {\n  return [useParams, useNavigate, useSearchParams];\n});\n_c = LoanDetails;\nexport default LoanDetails;\nvar _c;\n$RefreshReg$(_c, \"LoanDetails\");","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","useSearchParams","RepaymentForm","ContractModal","UserProfileModal","jsxDEV","_jsxDEV","LoanDetails","_s","_loan$borrower","_loan$loanOffers","_loan$borrower3","_loan$borrower4","loanId","navigate","searchParams","loan","setLoan","messages","setMessages","newMessage","setNewMessage","showRepaymentForm","setShowRepaymentForm","selectedOffer","setSelectedOffer","showContractModal","setShowContractModal","expandedOffer","setExpandedOffer","offerForm","setOfferForm","amount","duration","interestRate","message","token","localStorage","getItem","userId","JSON","parse","atob","split","handleOfferChange","e","name","value","target","prev","submitOffer","res","fetch","method","headers","Authorization","body","stringify","ok","Error","data","json","alert","loanOffers","err","console","error","fetchLoanDetails","get","setTimeout","el","document","getElementById","scrollIntoView","behavior","block","handleSendMessage","trim","content","handleAcceptOffer","offer","toggleOffer","offerId","children","fileName","_jsxFileName","lineNumber","columnNumber","style","padding","borrower","display","gap","alignItems","marginBottom","user","purpose","status","length","map","_offer$lender","_loan$borrower2","isOpen","id","statusLabel","badgeStyle","background","color","borderColor","border","borderRadius","overflow","onClick","width","textAlign","justifyContent","cursor","height","fontWeight","lender","fontSize","Number","toFixed","borderTop","marginTop","type","onChange","step","onConfirm","errorText","text","onCancel","_c","$RefreshReg$"],"sources":["/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/loans/LoanDetails.jsx"],"sourcesContent":["// src/features/loans/LoanDetails.jsx\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate, useSearchParams } from 'react-router-dom';\nimport RepaymentForm from './RepaymentForm';\nimport ContractModal from '../../components/ContractModal';\nimport UserProfileModal from '../../components/UserProfileModal';\n\nconst LoanDetails = () => {\n  const { loanId } = useParams();\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n\n  const [loan, setLoan] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [showRepaymentForm, setShowRepaymentForm] = useState(false);\n  const [selectedOffer, setSelectedOffer] = useState(null);\n  const [showContractModal, setShowContractModal] = useState(false);\n\n  // NEW: which offer rows are expanded\n  const [expandedOffer, setExpandedOffer] = useState({});\n\n  const [offerForm, setOfferForm] = useState({\n    amount: '',\n    duration: '',\n    interestRate: '',\n    message: '',\n  });\n\n  const token = localStorage.getItem('token');\n  const userId = token ? JSON.parse(atob(token.split('.')[1])).userId : null;\n\n  const handleOfferChange = (e) => {\n    const { name, value } = e.target;\n    setOfferForm((prev) => ({ ...prev, [name]: value }));\n  };\n\n  const submitOffer = async () => {\n    try {\n      const res = await fetch(`/api/loans/${loanId}/offers`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify(offerForm),\n      });\n\n      if (!res.ok) throw new Error('Failed to submit offer');\n      const data = await res.json();\n      alert('Offer submitted!');\n      setLoan((prev) => ({\n        ...prev,\n        loanOffers: [data, ...(prev.loanOffers || [])],\n      }));\n      setOfferForm({ amount: '', duration: '', interestRate: '', message: '' });\n    } catch (err) {\n      console.error('Error submitting offer:', err);\n      alert('There was a problem submitting your offer.');\n    }\n  };\n\n  const fetchLoanDetails = async () => {\n    try {\n      const res = await fetch(`/api/loans/${loanId}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      const data = await res.json();\n      setLoan(data);\n      setMessages(data.messages || []);\n    } catch (err) {\n      console.error('Error fetching loan details:', err);\n    }\n  };\n\n  useEffect(() => {\n    fetchLoanDetails();\n  }, [loanId]); // eslint-friendly\n\n  // Scroll to discussion if ?tab=discussion\n  useEffect(() => {\n    if (searchParams.get('tab') === 'discussion' && loan) {\n      setTimeout(() => {\n        const el = document.getElementById('discussion-thread');\n        if (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });\n      }, 0);\n    }\n  }, [searchParams, loan]);\n\n  const handleSendMessage = async () => {\n    if (!newMessage.trim()) return;\n    try {\n      const res = await fetch(`/api/loans/${loanId}/messages`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ content: newMessage }),\n      });\n      const data = await res.json();\n      setMessages((prev) => [...prev, data]);\n      setNewMessage('');\n    } catch (err) {\n      console.error('Error sending message:', err);\n    }\n  };\n\n  const handleAcceptOffer = (offer) => {\n    setSelectedOffer(offer);\n    setShowContractModal(true);\n  };\n\n  // NEW: toggle a specific offer accordion\n  const toggleOffer = (offerId) =>\n    setExpandedOffer((prev) => ({ ...prev, [offerId]: !prev[offerId] }));\n\n  if (!loan) return <p>Loading loan details...</p>;\n\n  return (\n    <div style={{ padding: '2rem' }}>\n      <h2>Loan Request by {loan.borrower?.name || 'Unknown User'}</h2>\n\n      {/* You were mounting UserProfileModal directly; leaving as-is since it works for you */}\n      <div style={{ display: 'flex', gap: '12px', alignItems: 'flex-start', marginBottom: '1rem' }}>\n        <UserProfileModal user={loan.borrower} />\n      </div>\n\n      <p><strong>Amount:</strong> ${loan.amount}</p>\n      <p><strong>Duration:</strong> {loan.duration} months</p>\n      <p><strong>Reason:</strong> {loan.purpose}</p>\n      <p><strong>Status:</strong> {loan.status}</p>\n\n      <hr />\n      <h3>Offers</h3>\n\n      {loan.loanOffers?.length > 0 ? (\n        loan.loanOffers.map((offer) => {\n          const isOpen = !!expandedOffer[offer.id];\n          const statusLabel = loan.status === 'FUNDED' ? 'Accepted' : 'Pending';\n          const badgeStyle =\n            loan.status === 'FUNDED'\n              ? { background: '#dcfce7', color: '#166534', borderColor: '#86efac' }\n              : { background: '#fef3c7', color: '#92400e', borderColor: '#fde68a' };\n\n          return (\n            <div\n              key={offer.id}\n              style={{\n                border: '1px solid #e2e8f0',\n                borderRadius: 12,\n                background: '#fff',\n                marginBottom: 12,\n                overflow: 'hidden',\n              }}\n            >\n              {/* Header row (click to open/close) */}\n              <button\n                onClick={() => toggleOffer(offer.id)}\n                aria-expanded={isOpen}\n                style={{\n                  width: '100%',\n                  textAlign: 'left',\n                  background: '#f8fafc',\n                  border: 0,\n                  padding: '12px 14px',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'space-between',\n                  cursor: 'pointer',\n                }}\n              >\n                <div style={{ display: 'flex', alignItems: 'center', gap: 10 }}>\n                  <span\n                    style={{\n                      width: 8,\n                      height: 8,\n                      borderRadius: 999,\n                      background: '#6366f1',\n                      display: 'inline-block',\n                    }}\n                  />\n                  <span style={{ fontWeight: 700, color: '#0f172a' }}>\n                    Offer from {offer.lender?.name || 'Unknown'}\n                  </span>\n                </div>\n\n                <div style={{ display: 'flex', gap: 12, alignItems: 'center', color: '#334155', fontSize: 14 }}>\n                  <span>${Number(offer.amount || 0).toFixed(2)}</span>\n                  <span>{offer.interestRate}%</span>\n                  <span>{offer.duration} mo</span>\n                  <span\n                    style={{\n                      borderRadius: 999,\n                      padding: '2px 8px',\n                      fontSize: 12,\n                      fontWeight: 700,\n                      border: '1px solid',\n                      ...badgeStyle,\n                    }}\n                  >\n                    {statusLabel}\n                  </span>\n                  <span style={{ fontSize: 18, color: '#64748b' }}>{isOpen ? '▾' : '▸'}</span>\n                </div>\n              </button>\n\n              {/* Body */}\n              {isOpen && (\n                <div style={{ padding: '12px 14px 14px', borderTop: '1px solid #e2e8f0' }}>\n                  <p><strong>Message:</strong> {offer.message || '—'}</p>\n\n                  {loan.status === 'OPEN' && userId === loan.borrower?.id && (\n                    <button\n                      onClick={() => handleAcceptOffer(offer)}\n                      style={{\n                        background: '#4f46e5',\n                        border: '1px solid #4f46e5',\n                        color: '#fff',\n                        fontWeight: 700,\n                        padding: '8px 12px',\n                        borderRadius: 10,\n                        cursor: 'pointer',\n                      }}\n                    >\n                      Accept Offer\n                    </button>\n                  )}\n                </div>\n              )}\n            </div>\n          );\n        })\n      ) : (\n        <p>No offers yet.</p>\n      )}\n\n      {loan.status === 'OPEN' && loan.borrower?.id !== userId && (\n        <div style={{ marginTop: '2rem', padding: '1rem', border: '1px solid #888', borderRadius: 10 }}>\n          <h4>Submit an Offer</h4>\n          <label>\n            Amount ($):<br />\n            <input type=\"number\" name=\"amount\" value={offerForm.amount} onChange={handleOfferChange} />\n          </label>\n          <br /><br />\n          <label>\n            Duration (months):<br />\n            <input type=\"number\" name=\"duration\" value={offerForm.duration} onChange={handleOfferChange} />\n          </label>\n          <br /><br />\n          <label>\n            Interest Rate (%):<br />\n            <input type=\"number\" name=\"interestRate\" step=\"0.01\" value={offerForm.interestRate} onChange={handleOfferChange} />\n          </label>\n          <br /><br />\n          <label>\n            Message (optional):<br />\n            <textarea name=\"message\" value={offerForm.message} onChange={handleOfferChange} />\n          </label>\n          <br /><br />\n          <button onClick={submitOffer}>Submit Offer</button>\n        </div>\n      )}\n\n      {loan.status === 'FUNDED' && userId === loan.borrower?.id && (\n        <div style={{ marginTop: '2rem' }}>\n          <h3>Repayments</h3>\n          <button onClick={() => setShowRepaymentForm(true)}>Make a Payment</button>\n          <button onClick={() => navigate(`/loan/${loan.id}/repayments`)}>View Repayment Tracker</button>\n          {showRepaymentForm && <RepaymentForm loanId={loan.id} />}\n        </div>\n      )}\n\n      <hr />\n      \n      {showContractModal && selectedOffer && (\n        <ContractModal\n          offer={selectedOffer}\n          borrower={loan.borrower}\n          onConfirm={async () => {\n            try {\n              const res = await fetch(`/api/loans/offers/${selectedOffer.id}/accept`, {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json',\n                  Authorization: `Bearer ${token}`,\n                },\n              });\n\n              if (!res.ok) {\n                const errorText = await res.text();\n                alert(`❌ ${errorText || 'Something went wrong'}`);\n                return;\n              }\n\n              await res.json();\n\n              alert('✅ Loan contract created and saved!');\n              setShowContractModal(false);\n              navigate('/dashboard');\n            } catch (err) {\n              console.error('❌ Error finalizing contract:', err);\n              alert('Network or server error occurred.');\n            }\n          }}\n          onCancel={() => setShowContractModal(false)}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default LoanDetails;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}