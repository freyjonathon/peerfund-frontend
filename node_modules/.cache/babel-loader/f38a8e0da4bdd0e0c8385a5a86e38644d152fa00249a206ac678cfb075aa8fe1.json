{"ast":null,"code":"// src/components/RequireAdmin.jsx\nimport React,{useEffect,useState}from'react';import{Navigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";const RequireAdmin=_ref=>{let{children}=_ref;const[loading,setLoading]=useState(true);const[isAdmin,setIsAdmin]=useState(false);useEffect(()=>{const token=localStorage.getItem('token');if(!token){setLoading(false);setIsAdmin(false);return;}const checkAdmin=async()=>{try{const res=await fetch('/api/users/profile',{headers:{Authorization:\"Bearer \".concat(token)}});if(!res.ok){throw new Error('Failed to load profile');}const data=await res.json();// Your backend returns role: 'ADMIN' | 'USER' | 'SUPERUSER'\nif(data.role==='ADMIN'){setIsAdmin(true);}else{setIsAdmin(false);}}catch(err){console.error('RequireAdmin error:',err);setIsAdmin(false);}finally{setLoading(false);}};checkAdmin();},[]);if(loading){return/*#__PURE__*/_jsx(\"div\",{style:{padding:'1rem'},children:\"Checking admin access\\u2026\"});}if(!isAdmin){// They’re logged in but not an admin – send back to normal app\nreturn/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\",replace:true});}return children;};export default RequireAdmin;","map":{"version":3,"names":["React","useEffect","useState","Navigate","jsx","_jsx","RequireAdmin","_ref","children","loading","setLoading","isAdmin","setIsAdmin","token","localStorage","getItem","checkAdmin","res","fetch","headers","Authorization","concat","ok","Error","data","json","role","err","console","error","style","padding","to","replace"],"sources":["/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/components/RequireAdmin.jsx"],"sourcesContent":["// src/components/RequireAdmin.jsx\nimport React, { useEffect, useState } from 'react';\nimport { Navigate } from 'react-router-dom';\n\nconst RequireAdmin = ({ children }) => {\n  const [loading, setLoading] = useState(true);\n  const [isAdmin, setIsAdmin] = useState(false);\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setLoading(false);\n      setIsAdmin(false);\n      return;\n    }\n\n    const checkAdmin = async () => {\n      try {\n        const res = await fetch('/api/users/profile', {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n\n        if (!res.ok) {\n          throw new Error('Failed to load profile');\n        }\n\n        const data = await res.json();\n        // Your backend returns role: 'ADMIN' | 'USER' | 'SUPERUSER'\n        if (data.role === 'ADMIN') {\n          setIsAdmin(true);\n        } else {\n          setIsAdmin(false);\n        }\n      } catch (err) {\n        console.error('RequireAdmin error:', err);\n        setIsAdmin(false);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    checkAdmin();\n  }, []);\n\n  if (loading) {\n    return (\n      <div style={{ padding: '1rem' }}>\n        Checking admin access…\n      </div>\n    );\n  }\n\n  if (!isAdmin) {\n    // They’re logged in but not an admin – send back to normal app\n    return <Navigate to=\"/dashboard\" replace />;\n  }\n\n  return children;\n};\n\nexport default RequireAdmin;\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,QAAQ,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE5C,KAAM,CAAAC,YAAY,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAChC,KAAM,CAACE,OAAO,CAAEC,UAAU,CAAC,CAAGR,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACS,OAAO,CAAEC,UAAU,CAAC,CAAGV,QAAQ,CAAC,KAAK,CAAC,CAE7CD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAY,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,GAAI,CAACF,KAAK,CAAE,CACVH,UAAU,CAAC,KAAK,CAAC,CACjBE,UAAU,CAAC,KAAK,CAAC,CACjB,OACF,CAEA,KAAM,CAAAI,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAC,KAAK,CAAC,oBAAoB,CAAE,CAC5CC,OAAO,CAAE,CAAEC,aAAa,WAAAC,MAAA,CAAYR,KAAK,CAAG,CAC9C,CAAC,CAAC,CAEF,GAAI,CAACI,GAAG,CAACK,EAAE,CAAE,CACX,KAAM,IAAI,CAAAC,KAAK,CAAC,wBAAwB,CAAC,CAC3C,CAEA,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAP,GAAG,CAACQ,IAAI,CAAC,CAAC,CAC7B;AACA,GAAID,IAAI,CAACE,IAAI,GAAK,OAAO,CAAE,CACzBd,UAAU,CAAC,IAAI,CAAC,CAClB,CAAC,IAAM,CACLA,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAE,MAAOe,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,qBAAqB,CAAEF,GAAG,CAAC,CACzCf,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,OAAS,CACRF,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAEDM,UAAU,CAAC,CAAC,CACd,CAAC,CAAE,EAAE,CAAC,CAEN,GAAIP,OAAO,CAAE,CACX,mBACEJ,IAAA,QAAKyB,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAO,CAAE,CAAAvB,QAAA,CAAC,6BAEjC,CAAK,CAAC,CAEV,CAEA,GAAI,CAACG,OAAO,CAAE,CACZ;AACA,mBAAON,IAAA,CAACF,QAAQ,EAAC6B,EAAE,CAAC,YAAY,CAACC,OAAO,MAAE,CAAC,CAC7C,CAEA,MAAO,CAAAzB,QAAQ,CACjB,CAAC,CAED,cAAe,CAAAF,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}