{"ast":null,"code":"var _jsxFileName = \"/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/dashboard/MoneySummary.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// src/features/money/MoneySummary.jsx\nimport React, { useEffect, useState, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './MoneySummary.css';\nimport UserProfileModal from '../../components/UserProfileModal';\nimport LoanThreadModal from '../loans/LoanThreadModal';\n\n// helper: decode JWT for current user id\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction getCurrentUserId() {\n  const t = localStorage.getItem('token');\n  if (!t) return null;\n  try {\n    var _payload$userId;\n    const payload = JSON.parse(atob(t.split('.')[1] || ''));\n    return (_payload$userId = payload === null || payload === void 0 ? void 0 : payload.userId) !== null && _payload$userId !== void 0 ? _payload$userId : null;\n  } catch {\n    return null;\n  }\n}\nconst fmtMoney = n => typeof n === 'number' && !Number.isNaN(n) ? `$${n.toFixed(2)}` : 'â€”';\n\n// One-line row layout used across all sections\nconst ROW_GRID = {\n  display: 'grid',\n  gridTemplateColumns: 'minmax(160px,1fr) 140px 180px auto auto',\n  alignItems: 'center',\n  gap: 16\n};\n\n/* ----------------------- authFetch: token + cookies ----------------------- */\nasync function authFetch(url, options = {}) {\n  const token = localStorage.getItem('token');\n  const headers = {\n    ...(options.headers || {}),\n    ...(token ? {\n      Authorization: `Bearer ${token}`\n    } : {})\n  };\n  const res = await fetch(url, {\n    ...options,\n    headers,\n    credentials: 'include'\n  });\n  if (res.status === 401) {\n    try {\n      console.warn('401 on', url, await res.text());\n    } catch {}\n    window.location.assign('/login');\n    throw new Error('Unauthorized');\n  }\n  return res;\n}\n\n/* -------------------------- Browse Modal (market) ------------------------- */\nfunction BrowseRequestsModal({\n  open,\n  onClose,\n  items,\n  loading,\n  onRefresh,\n  navigate\n}) {\n  if (!open) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    role: \"dialog\",\n    \"aria-modal\": \"true\",\n    style: {\n      position: 'fixed',\n      inset: 0,\n      background: 'rgba(15,23,42,0.45)',\n      display: 'grid',\n      placeItems: 'center',\n      zIndex: 50\n    },\n    onClick: onClose,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-card\",\n      style: {\n        width: 'min(900px, 92vw)',\n        maxHeight: '82vh',\n        overflow: 'auto'\n      },\n      onClick: e => e.stopPropagation(),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"ms-subheading\",\n          style: {\n            margin: 0\n          },\n          children: \"Browse Open Requests\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"action-btn\",\n            onClick: onRefresh,\n            children: \"Refresh\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"action-btn\",\n            onClick: onClose,\n            children: \"Close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 12\n        },\n        children: loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"ms-empty\",\n          children: \"Loading open requests\\u2026\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 13\n        }, this) : items.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"ms-empty\",\n          children: \"No open requests from other users right now.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 13\n        }, this) : items.map(r => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-card\",\n          style: {\n            marginBottom: 10,\n            padding: 12,\n            border: '1px solid var(--ring)'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-card-row\",\n            style: ROW_GRID,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ms-label\",\n                children: \"Borrower\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 97,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ms-value-strong\",\n                children: r.borrowerName || 'Borrower'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 98,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 96,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ms-label\",\n                children: \"Amount\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 101,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ms-value-strong\",\n                children: fmtMoney(r.amount)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 102,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ms-label\",\n                children: \"Created\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 105,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ms-value-strong\",\n                children: r.createdAt ? new Date(r.createdAt).toLocaleDateString() : 'â€”'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 106,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                justifySelf: 'end'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ms-badge ms-badge--warn\",\n                children: \"Open\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 111,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                justifySelf: 'end'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"action-btn primary\",\n                onClick: () => navigate(`/loan/${r.id}`),\n                title: \"Open request details to submit an offer\",\n                children: \"Open\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 114,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 17\n          }, this)\n        }, r.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this);\n}\n\n/* ---------- Child row (shows controls only when you're the lender) ---------- */\n_c = BrowseRequestsModal;\nfunction OpenRequestRow({\n  req,\n  isExpanded,\n  onView,\n  // decides how to handle \"View\" click\n  actionLoading,\n  submitCounter,\n  acceptRequest,\n  declineRequest\n}) {\n  _s();\n  var _req$status;\n  const [proposal, setProposal] = useState({\n    amount: req.amount || 0,\n    months: req.duration || 1,\n    interestRate: req.interestRate || 0\n  });\n  const isLending = req.role === 'Lending';\n  const lockAmount = req.type === 'market'; // market amount locked\n  const canAccept = isLending; // only lender can accept\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ms-card\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-card-row\",\n      style: ROW_GRID,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-label\",\n          children: \"Counterparty\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-value-strong\",\n          children: [req.counterpartyName || 'Unknown', /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              marginLeft: 8,\n              color: '#64748b',\n              fontWeight: 600\n            },\n            children: [\"\\u2022 \", req.role]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-label\",\n          children: \"Amount\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-value-strong\",\n          children: fmtMoney(req.amount)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-label\",\n          children: \"Created\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-value-strong\",\n          children: req.createdAt ? new Date(req.createdAt).toLocaleDateString() : 'â€”'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          justifySelf: 'end'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"ms-badge ms-badge--warn\",\n          children: \"Open\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          justifySelf: 'end'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"action-btn\",\n          onClick: onView,\n          title: \"View request\",\n          children: isExpanded ? 'ðŸ”½ Hide' : 'ðŸ“„ View'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }, this), isExpanded && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-details\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Your role:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 13\n        }, this), \" \", req.role]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Status:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 13\n        }, this), \" \", (_req$status = req.status) !== null && _req$status !== void 0 ? _req$status : 'OPEN']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Interest Rate:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 13\n        }, this), ' ', Number.isFinite(req.interestRate) ? `${req.interestRate}%` : 'â€”']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Duration:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 13\n        }, this), ' ', Number.isFinite(req.duration) ? `${req.duration} months` : 'â€”']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 11\n      }, this), req.purpose ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Reason:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 33\n        }, this), \" \", req.purpose]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 13\n      }, this) : null, isLending ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-8\",\n        style: {\n          display: 'flex',\n          flexWrap: 'wrap',\n          gap: 10\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"ms-label\",\n            children: \"Amount\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            min: \"1\",\n            className: \"auth-input\",\n            value: lockAmount ? req.amount : proposal.amount,\n            onChange: e => setProposal(p => ({\n              ...p,\n              amount: Number(e.target.value)\n            })),\n            style: {\n              width: 140\n            },\n            disabled: lockAmount,\n            readOnly: lockAmount\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"ms-label\",\n            children: \"APR %\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            min: \"0\",\n            className: \"auth-input\",\n            value: proposal.interestRate,\n            onChange: e => setProposal(p => ({\n              ...p,\n              interestRate: Number(e.target.value)\n            })),\n            style: {\n              width: 120\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"ms-label\",\n            children: \"Months\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            min: \"1\",\n            className: \"auth-input\",\n            value: proposal.months,\n            onChange: e => setProposal(p => ({\n              ...p,\n              months: Number(e.target.value)\n            })),\n            style: {\n              width: 120\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginLeft: 'auto',\n            display: 'flex',\n            gap: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"action-btn\",\n            onClick: () => submitCounter(req, req.type === 'direct' ? {\n              amount: proposal.amount,\n              apr: proposal.interestRate,\n              months: proposal.months\n            } : {\n              amount: lockAmount ? req.amount : proposal.amount,\n              interestRate: proposal.interestRate,\n              months: proposal.months\n            }),\n            disabled: !!actionLoading[req.id],\n            children: actionLoading[req.id] ? 'Savingâ€¦' : 'Make Counter-Offer'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"action-btn primary\",\n            onClick: () => canAccept && acceptRequest(req),\n            disabled: !!actionLoading[req.id] || !canAccept,\n            style: !canAccept || actionLoading[req.id] ? {\n              opacity: 0.5,\n              cursor: 'not-allowed'\n            } : {},\n            title: canAccept ? 'Accept this request' : 'Only the lender can accept',\n            children: actionLoading[req.id] ? 'Workingâ€¦' : 'Accept'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"action-btn\",\n            onClick: () => declineRequest(req),\n            disabled: !!actionLoading[req.id],\n            children: actionLoading[req.id] ? 'Workingâ€¦' : 'Decline'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-8\",\n        style: {\n          color: 'var(--muted)'\n        },\n        children: [\"This is one of your own requests. To lend to someone else, click \", /*#__PURE__*/_jsxDEV(\"em\", {\n          children: \"View\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 80\n        }, this), \" to browse other users\\u2019 open requests.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 9\n    }, this)]\n  }, req.id, true, {\n    fileName: _jsxFileName,\n    lineNumber: 153,\n    columnNumber: 5\n  }, this);\n}\n\n/* -------------------------------- Parent -------------------------------- */\n_s(OpenRequestRow, \"kuAQz44Ww4Vm45/3BwYk0IW1zjw=\");\n_c2 = OpenRequestRow;\nconst MoneySummary = () => {\n  _s2();\n  const [summary, setSummary] = useState({\n    loansGiven: [],\n    loansReceived: [],\n    myOpenRequests: []\n  });\n  const [loading, setLoading] = useState(true);\n  const [expandedLoans, setExpandedLoans] = useState({});\n  const [openSec, setOpenSec] = useState({\n    open: true,\n    given: true,\n    received: true\n  });\n  const [payLoading, setPayLoading] = useState({});\n  const [actionLoading, setActionLoading] = useState({});\n  const [profileUserId, setProfileUserId] = useState(null);\n  const [threadLoanId, setThreadLoanId] = useState(null);\n\n  // browse modal state\n  const [browseOpen, setBrowseOpen] = useState(false);\n  const [browseLoading, setBrowseLoading] = useState(false);\n  const [browseItems, setBrowseItems] = useState([]);\n  const navigate = useNavigate();\n\n  /* ------------------ Fetch helpers (market + direct) ------------------ */\n\n  // All OPEN market requests, mapped to Borrowing/Lending role\n  const fetchMarketOpenRequests = async () => {\n    const me = getCurrentUserId();\n    if (!me) return [];\n    try {\n      const r = await authFetch('/api/loan-requests/open');\n      if (r.ok) {\n        const raw = await r.json();\n        const list = Array.isArray(raw) ? raw : (raw === null || raw === void 0 ? void 0 : raw.items) || [];\n        return list.map(req => {\n          var _req$borrower, _req$borrower2, _req$duration, _req$interestRate, _req$lender, _req$lender2;\n          const borrowerId = req.borrowerId || (req === null || req === void 0 ? void 0 : (_req$borrower = req.borrower) === null || _req$borrower === void 0 ? void 0 : _req$borrower.id);\n          const iAmBorrower = String(borrowerId) === String(me);\n          const borrowerName = (req === null || req === void 0 ? void 0 : (_req$borrower2 = req.borrower) === null || _req$borrower2 === void 0 ? void 0 : _req$borrower2.name) || (iAmBorrower ? 'You' : 'Borrower');\n          return {\n            type: 'market',\n            id: req.id,\n            amount: Number(req.amount),\n            duration: Number((_req$duration = req.duration) !== null && _req$duration !== void 0 ? _req$duration : req.months),\n            interestRate: Number((_req$interestRate = req.interestRate) !== null && _req$interestRate !== void 0 ? _req$interestRate : req.apr),\n            purpose: req.purpose || '',\n            createdAt: req.createdAt || null,\n            borrowerId,\n            borrowerName,\n            lenderName: (req === null || req === void 0 ? void 0 : (_req$lender = req.lender) === null || _req$lender === void 0 ? void 0 : _req$lender.name) || '',\n            counterpartyName: iAmBorrower ? (req === null || req === void 0 ? void 0 : (_req$lender2 = req.lender) === null || _req$lender2 === void 0 ? void 0 : _req$lender2.name) || 'â€”' : borrowerName,\n            role: iAmBorrower ? 'Borrowing' : 'Lending',\n            status: req.status || 'OPEN'\n          };\n        });\n      }\n    } catch {}\n\n    // fallback (borrower-only)\n    try {\n      const r = await authFetch('/api/loan-requests/mine?status=OPEN');\n      if (r.ok) {\n        const list = await r.json();\n        const items = Array.isArray(list) ? list : Array.isArray(list === null || list === void 0 ? void 0 : list.items) ? list.items : [];\n        return items.filter(it => {\n          var _it$borrower;\n          return ((it === null || it === void 0 ? void 0 : it.borrowerId) || (it === null || it === void 0 ? void 0 : (_it$borrower = it.borrower) === null || _it$borrower === void 0 ? void 0 : _it$borrower.id)) === me;\n        }).map(req => {\n          var _req$duration2, _req$interestRate2, _req$borrower3, _req$borrower4, _req$lender3, _req$lender4;\n          return {\n            type: 'market',\n            id: req.id,\n            amount: Number(req.amount),\n            duration: Number((_req$duration2 = req.duration) !== null && _req$duration2 !== void 0 ? _req$duration2 : req.months),\n            interestRate: Number((_req$interestRate2 = req.interestRate) !== null && _req$interestRate2 !== void 0 ? _req$interestRate2 : req.apr),\n            purpose: req.purpose || '',\n            createdAt: req.createdAt || null,\n            borrowerName: (req === null || req === void 0 ? void 0 : (_req$borrower3 = req.borrower) === null || _req$borrower3 === void 0 ? void 0 : _req$borrower3.name) || 'You',\n            borrowerId: (req === null || req === void 0 ? void 0 : (_req$borrower4 = req.borrower) === null || _req$borrower4 === void 0 ? void 0 : _req$borrower4.id) || req.borrowerId || me,\n            lenderName: (req === null || req === void 0 ? void 0 : (_req$lender3 = req.lender) === null || _req$lender3 === void 0 ? void 0 : _req$lender3.name) || '',\n            counterpartyName: (req === null || req === void 0 ? void 0 : (_req$lender4 = req.lender) === null || _req$lender4 === void 0 ? void 0 : _req$lender4.name) || 'â€”',\n            role: 'Borrowing',\n            status: req.status || 'OPEN'\n          };\n        });\n      }\n    } catch {}\n    return [];\n  };\n\n  // DIRECT requests (both roles) from consolidated backend view\n  const fetchDirectOpenRequests = async () => {\n    const me = getCurrentUserId();\n    if (!me) return [];\n    try {\n      const r = await authFetch('/api/direct-requests/open/mine');\n      if (!r.ok) return [];\n      const rows = await r.json();\n      return (Array.isArray(rows) ? rows : []).map(d => {\n        var _d$borrower, _d$lender, _d$lender2, _d$borrower2, _d$months, _d$apr, _d$borrower3, _d$lender3;\n        const borrowerId = d.borrowerId || (d === null || d === void 0 ? void 0 : (_d$borrower = d.borrower) === null || _d$borrower === void 0 ? void 0 : _d$borrower.id);\n        const lenderId = d.lenderId || (d === null || d === void 0 ? void 0 : (_d$lender = d.lender) === null || _d$lender === void 0 ? void 0 : _d$lender.id);\n        const iAmBorrower = String(borrowerId) === String(me);\n        const role = iAmBorrower ? 'Borrowing' : 'Lending';\n        const counterpartyName = iAmBorrower ? (d === null || d === void 0 ? void 0 : (_d$lender2 = d.lender) === null || _d$lender2 === void 0 ? void 0 : _d$lender2.name) || 'Lender' : (d === null || d === void 0 ? void 0 : (_d$borrower2 = d.borrower) === null || _d$borrower2 === void 0 ? void 0 : _d$borrower2.name) || 'Borrower';\n        return {\n          type: 'direct',\n          id: d.id,\n          amount: Number(d.amount),\n          duration: Number((_d$months = d.months) !== null && _d$months !== void 0 ? _d$months : d.duration),\n          interestRate: Number((_d$apr = d.apr) !== null && _d$apr !== void 0 ? _d$apr : d.interestRate),\n          createdAt: d.createdAt || null,\n          borrowerId,\n          borrowerName: (d === null || d === void 0 ? void 0 : (_d$borrower3 = d.borrower) === null || _d$borrower3 === void 0 ? void 0 : _d$borrower3.name) || (iAmBorrower ? 'You' : ''),\n          lenderId,\n          lenderName: (d === null || d === void 0 ? void 0 : (_d$lender3 = d.lender) === null || _d$lender3 === void 0 ? void 0 : _d$lender3.name) || (!iAmBorrower ? 'You' : ''),\n          counterpartyName,\n          role,\n          status: d.status || 'PENDING'\n        };\n      });\n    } catch {\n      return [];\n    }\n  };\n\n  // What the browse modal shows: market requests from other users\n  const fetchOtherUsersMarketRequests = async () => {\n    const me = getCurrentUserId();\n    setBrowseLoading(true);\n    try {\n      const r = await authFetch('/api/loan-requests/open');\n      const raw = r.ok ? await r.json() : [];\n      const items = (Array.isArray(raw) ? raw : (raw === null || raw === void 0 ? void 0 : raw.items) || []).filter(it => {\n        var _it$borrower2;\n        const borrowerId = it.borrowerId || (it === null || it === void 0 ? void 0 : (_it$borrower2 = it.borrower) === null || _it$borrower2 === void 0 ? void 0 : _it$borrower2.id);\n        return borrowerId && String(borrowerId) !== String(me);\n      });\n      const mapped = items.map(it => {\n        var _it$duration, _it$borrower3;\n        return {\n          id: it.id,\n          amount: Number(it.amount),\n          duration: Number((_it$duration = it.duration) !== null && _it$duration !== void 0 ? _it$duration : it.months),\n          createdAt: it.createdAt || null,\n          borrowerName: (it === null || it === void 0 ? void 0 : (_it$borrower3 = it.borrower) === null || _it$borrower3 === void 0 ? void 0 : _it$borrower3.name) || 'Borrower'\n        };\n      });\n      setBrowseItems(mapped);\n    } catch {\n      setBrowseItems([]);\n    } finally {\n      setBrowseLoading(false);\n    }\n  };\n  const openBrowse = async () => {\n    setBrowseOpen(true);\n    await fetchOtherUsersMarketRequests();\n  };\n  const fetchSummary = useCallback(async () => {\n    const token = localStorage.getItem('token');\n    if (!token) return;\n    setLoading(true);\n    try {\n      const res = await authFetch('/api/users/my-money-summary');\n      let loansGiven = [];\n      let loansReceived = [];\n      if (res.ok) {\n        const data = await res.json();\n        loansGiven = Array.isArray(data.loansGiven) ? data.loansGiven : Array.isArray(data.loansAsLender) ? data.loansAsLender : [];\n        loansReceived = Array.isArray(data.loansReceived) ? data.loansReceived : Array.isArray(data.loansAsBorrower) ? data.loansAsBorrower : [];\n      }\n      const [marketOpen, directOpen] = await Promise.all([fetchMarketOpenRequests(), fetchDirectOpenRequests()]);\n      const myOpenRequests = [...marketOpen, ...directOpen].sort((a, b) => {\n        if (a.role === 'Lending' && b.role !== 'Lending') return -1;\n        if (b.role === 'Lending' && a.role !== 'Lending') return 1;\n        const ta = a.createdAt ? new Date(a.createdAt).getTime() : 0;\n        const tb = b.createdAt ? new Date(b.createdAt).getTime() : 0;\n        return tb - ta;\n      });\n      setSummary({\n        loansGiven,\n        loansReceived,\n        myOpenRequests\n      });\n    } catch (err) {\n      console.error('Error fetching money summary:', err);\n      setSummary({\n        loansGiven: [],\n        loansReceived: [],\n        myOpenRequests: []\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(() => {\n    fetchSummary();\n  }, [fetchSummary]);\n  const loanKey = (loan, idx) => (loan === null || loan === void 0 ? void 0 : loan.id) || (loan === null || loan === void 0 ? void 0 : loan._id) || String(idx);\n  const toggleLoanDetails = id => {\n    setExpandedLoans(prev => ({\n      ...Object.keys(prev).reduce((acc, k) => ({\n        ...acc,\n        [k]: false\n      }), {}),\n      [id]: !prev[id]\n    }));\n  };\n  const payNext = async loan => {\n    var _loan$installmentAmou;\n    const key = loanKey(loan);\n    const amount = (_loan$installmentAmou = loan === null || loan === void 0 ? void 0 : loan.installmentAmount) !== null && _loan$installmentAmou !== void 0 ? _loan$installmentAmou : 0;\n    if (!window.confirm(`Pay the next installment (${fmtMoney(amount)})?`)) return;\n    try {\n      setPayLoading(m => ({\n        ...m,\n        [key]: true\n      }));\n      const res = await authFetch(`/api/loans/${loan.id || loan._id}/pay-next`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      const data = await res.json();\n      if (!res.ok) throw new Error((data === null || data === void 0 ? void 0 : data.error) || 'Payment failed');\n      const paid = typeof data.amount === 'number' ? data.amount : amount;\n      alert(`Payment successful! Amount: ${fmtMoney(paid)}`);\n      await fetchSummary();\n    } catch (e) {\n      alert(e.message);\n    } finally {\n      setPayLoading(m => ({\n        ...m,\n        [key]: false\n      }));\n    }\n  };\n\n  /* -------------------- Action endpoints + helpers -------------------- */\n\n  const actionPaths = {\n    market: {\n      accept: id => [`/api/loan-requests/${id}/accept`, `/api/loan-requests/${id}/approve`, `/api/loan-requests/${id}/respond?action=ACCEPT`],\n      decline: id => [`/api/loan-requests/${id}/decline`, `/api/loan-requests/${id}/reject`, `/api/loan-requests/${id}/respond?action=DECLINE`],\n      counter: id => [`/api/loan-requests/${id}/counter-offer`, `/api/loan-requests/${id}/counter`, `/api/loan-requests/${id}/respond?action=COUNTER`]\n    },\n    direct: {\n      accept: id => [`/api/direct-requests/${id}/accept`, `/api/direct-requests/${id}/approve`, `/api/direct-requests/${id}/respond?action=ACCEPT`],\n      decline: id => [`/api/direct-requests/${id}/decline`, `/api/direct-requests/${id}/reject`, `/api/direct-requests/${id}/respond?action=DECLINE`],\n      counter: id => [`/api/direct-requests/${id}/counter-offer`, `/api/direct-requests/${id}/counter`, `/api/direct-requests/${id}/respond?action=COUNTER`]\n    }\n  };\n  async function tryVerbs(url, body) {\n    const optionsBase = {\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: body ? JSON.stringify(body) : undefined\n    };\n    const verbs = ['POST', 'PUT', 'PATCH'];\n    let lastErr = null;\n    for (const method of verbs) {\n      try {\n        const r = await authFetch(url, {\n          method,\n          ...optionsBase\n        });\n        if (r.ok) return r;\n        const txt = await r.text().catch(() => '');\n        lastErr = new Error(`${r.status} ${r.statusText}${txt ? ` â€¢ ${txt}` : ''}`);\n      } catch (e) {\n        lastErr = e;\n      }\n    }\n    throw lastErr || new Error('All methods failed');\n  }\n  const callAction = async (type, id, which, body) => {\n    setActionLoading(m => ({\n      ...m,\n      [id]: true\n    }));\n    try {\n      var _actionPaths$type, _actionPaths$type$whi, _ref, _body$amount, _ref2, _body$months, _ref3, _body$duration, _ref4, _body$interestRate, _ref5, _body$apr;\n      const urls = ((_actionPaths$type = actionPaths[type]) === null || _actionPaths$type === void 0 ? void 0 : (_actionPaths$type$whi = _actionPaths$type[which]) === null || _actionPaths$type$whi === void 0 ? void 0 : _actionPaths$type$whi.call(_actionPaths$type, id)) || [];\n      if (!urls.length) throw new Error(`Unknown action: ${type}.${which}`);\n      const supersetBody = body ? {\n        ...body,\n        amount: (_ref = (_body$amount = body.amount) !== null && _body$amount !== void 0 ? _body$amount : body.value) !== null && _ref !== void 0 ? _ref : undefined,\n        months: (_ref2 = (_body$months = body.months) !== null && _body$months !== void 0 ? _body$months : body.duration) !== null && _ref2 !== void 0 ? _ref2 : undefined,\n        duration: (_ref3 = (_body$duration = body.duration) !== null && _body$duration !== void 0 ? _body$duration : body.months) !== null && _ref3 !== void 0 ? _ref3 : undefined,\n        interestRate: (_ref4 = (_body$interestRate = body.interestRate) !== null && _body$interestRate !== void 0 ? _body$interestRate : body.apr) !== null && _ref4 !== void 0 ? _ref4 : undefined,\n        apr: (_ref5 = (_body$apr = body.apr) !== null && _body$apr !== void 0 ? _body$apr : body.interestRate) !== null && _ref5 !== void 0 ? _ref5 : undefined\n      } : undefined;\n      let ok = false;\n      let lastError = null;\n      for (const url of urls) {\n        try {\n          await tryVerbs(url, supersetBody);\n          ok = true;\n          break;\n        } catch (e) {\n          lastError = e;\n        }\n      }\n      if (!ok) throw lastError || new Error('No endpoint accepted this action');\n      await fetchSummary();\n    } catch (e) {\n      console.error(e);\n      alert(`Action failed:\\n${e.message || e}`);\n    } finally {\n      setActionLoading(m => ({\n        ...m,\n        [id]: false\n      }));\n    }\n  };\n  const acceptRequest = req => callAction(req.type, req.id, 'accept');\n  const declineRequest = req => callAction(req.type, req.id, 'decline');\n  const submitCounter = (req, proposal) => callAction(req.type, req.id, 'counter', proposal);\n\n  /* ------------------------------- Renderers ------------------------------- */\n\n  const renderLoanCard = (loan, isLender, idx) => {\n    const key = loanKey(loan, idx);\n    const isExpanded = !!expandedLoans[key];\n    const otherParty = isLender ? loan.borrowerName : loan.lenderName;\n    const canPay = !isLender && typeof loan.installmentAmount === 'number' && loan.installmentAmount > 0 && !!loan.nextDueDate;\n    const badgeClass = (loan.status || '').toUpperCase() === 'FUNDED' ? 'ms-badge ms-badge--ok' : 'ms-badge ms-badge--warn';\n    const fundedDate = loan.fundedDate ? new Date(loan.fundedDate).toLocaleDateString() : 'â€”';\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-card-row\",\n        style: ROW_GRID,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-label\",\n            children: isLender ? 'Borrower' : 'Lender'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 672,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-value-strong\",\n            children: otherParty || 'Unknown'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 673,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 671,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-label\",\n            children: \"Amount\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 676,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-value-strong\",\n            children: fmtMoney(loan.amount)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 677,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 675,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-label\",\n            children: \"Funded Date\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 680,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ms-value-strong\",\n            children: fundedDate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 681,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 679,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            justifySelf: 'end'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: badgeClass,\n            children: loan.status || 'â€”'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 684,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 683,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            justifySelf: 'end',\n            display: 'flex',\n            gap: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setThreadLoanId(loan.id || loan._id),\n            className: \"action-btn\",\n            title: \"Open conversation\",\n            children: \"\\uD83D\\uDCAC Messages\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 687,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => toggleLoanDetails(key),\n            className: \"action-btn\",\n            title: \"View contract\",\n            children: isExpanded ? 'ðŸ”½ Hide' : 'ðŸ“„ View'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 694,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 686,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 670,\n        columnNumber: 9\n      }, this), isExpanded && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-details\",\n        children: [loan.status && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Status:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 704,\n            columnNumber: 17\n          }, this), \" \", loan.status]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 703,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Interest Rate:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 708,\n            columnNumber: 15\n          }, this), ' ', typeof loan.interestRate === 'number' ? `${loan.interestRate}%` : 'â€”']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 707,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Duration:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 712,\n            columnNumber: 15\n          }, this), ' ', typeof loan.duration === 'number' ? `${loan.duration} months` : 'â€”']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 711,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Next Due Date:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 716,\n            columnNumber: 15\n          }, this), ' ', loan.nextDueDate ? new Date(loan.nextDueDate).toLocaleDateString() : 'â€”']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 715,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Installment (this period):\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 720,\n            columnNumber: 15\n          }, this), \" \", fmtMoney(loan.installmentAmount)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 719,\n          columnNumber: 13\n        }, this), isLender && typeof loan.amountCollected === 'number' && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Amount collected on loan:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 725,\n            columnNumber: 17\n          }, this), \" \", fmtMoney(loan.amountCollected)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 724,\n          columnNumber: 15\n        }, this), !isLender && canPay && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-6\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"action-btn primary\",\n            onClick: () => payNext(loan),\n            disabled: !!payLoading[key],\n            title: \"Pay next installment\",\n            children: payLoading[key] ? 'Processingâ€¦' : 'ðŸ’³ Make Payment'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 731,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 730,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 701,\n        columnNumber: 11\n      }, this)]\n    }, key, true, {\n      fileName: _jsxFileName,\n      lineNumber: 669,\n      columnNumber: 7\n    }, this);\n  };\n\n  /* ------------------------------- Render ------------------------------- */\n\n  if (loading) return /*#__PURE__*/_jsxDEV(\"p\", {\n    className: \"ms-loading ms-container\",\n    children: \"Loading money summary...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 749,\n    columnNumber: 23\n  }, this);\n  const given = Array.isArray(summary.loansGiven) ? summary.loansGiven : [];\n  const received = Array.isArray(summary.loansReceived) ? summary.loansReceived : [];\n  const myOpen = Array.isArray(summary.myOpenRequests) ? summary.myOpenRequests : [];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ms-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"ms-heading\",\n        children: \"\\uD83D\\uDCB5 My Money Summary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 758,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"action-btn\",\n        onClick: openBrowse,\n        title: \"See open requests from others\",\n        children: \"Browse Open Requests\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 759,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 757,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ms-section-head\",\n        onClick: () => setOpenSec(s => ({\n          ...s,\n          open: !s.open\n        })),\n        \"aria-expanded\": openSec.open,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-subheading\",\n          children: \"My Open Loan Requests\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 771,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-caret\",\n          children: openSec.open ? 'â–¾' : 'â–¸'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 772,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 766,\n        columnNumber: 9\n      }, this), openSec.open && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-section-body\",\n        children: myOpen.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"ms-empty\",\n          children: \"You have no open requests.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 777,\n          columnNumber: 15\n        }, this) : myOpen.map(req => /*#__PURE__*/_jsxDEV(OpenRequestRow, {\n          req: req,\n          isExpanded: !!expandedLoans[req.id],\n          onView: () => req.role === 'Borrowing' ? openBrowse() : toggleLoanDetails(req.id),\n          actionLoading: actionLoading,\n          submitCounter: submitCounter,\n          acceptRequest: acceptRequest,\n          declineRequest: declineRequest\n        }, req.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 780,\n          columnNumber: 17\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 775,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 765,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ms-section-head\",\n        onClick: () => setOpenSec(s => ({\n          ...s,\n          given: !s.given\n        })),\n        \"aria-expanded\": openSec.given,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-subheading\",\n          children: \"Loans Given (I'm the Lender)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 803,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-caret\",\n          children: openSec.given ? 'â–¾' : 'â–¸'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 804,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 798,\n        columnNumber: 9\n      }, this), openSec.given && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-section-body\",\n        children: given.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"ms-empty\",\n          children: \"No loans given yet.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 809,\n          columnNumber: 15\n        }, this) : given.map((loan, idx) => renderLoanCard(loan, true, idx))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 807,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 797,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ms-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ms-section-head\",\n        onClick: () => setOpenSec(s => ({\n          ...s,\n          received: !s.received\n        })),\n        \"aria-expanded\": openSec.received,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-subheading\",\n          children: \"Loans Received (I'm the Borrower)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 824,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ms-caret\",\n          children: openSec.received ? 'â–¾' : 'â–¸'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 825,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 819,\n        columnNumber: 9\n      }, this), openSec.received && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ms-section-body\",\n        children: received.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"ms-empty\",\n          children: \"No loans received yet.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 830,\n          columnNumber: 15\n        }, this) : received.map((loan, idx) => renderLoanCard(loan, false, idx))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 828,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 818,\n      columnNumber: 7\n    }, this), profileUserId && /*#__PURE__*/_jsxDEV(UserProfileModal, {\n      userId: profileUserId,\n      onClose: () => setProfileUserId(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 840,\n      columnNumber: 9\n    }, this), threadLoanId && /*#__PURE__*/_jsxDEV(LoanThreadModal, {\n      loanId: threadLoanId,\n      onClose: () => setThreadLoanId(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 843,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(BrowseRequestsModal, {\n      open: browseOpen,\n      onClose: () => setBrowseOpen(false),\n      items: browseItems,\n      loading: browseLoading,\n      onRefresh: fetchOtherUsersMarketRequests,\n      navigate: navigate\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 846,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 756,\n    columnNumber: 5\n  }, this);\n};\n_s2(MoneySummary, \"EXeAF3ERlUM30H2B1RPPucIWP+k=\", false, function () {\n  return [useNavigate];\n});\n_c3 = MoneySummary;\nexport default MoneySummary;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"BrowseRequestsModal\");\n$RefreshReg$(_c2, \"OpenRequestRow\");\n$RefreshReg$(_c3, \"MoneySummary\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","useNavigate","UserProfileModal","LoanThreadModal","jsxDEV","_jsxDEV","getCurrentUserId","t","localStorage","getItem","_payload$userId","payload","JSON","parse","atob","split","userId","fmtMoney","n","Number","isNaN","toFixed","ROW_GRID","display","gridTemplateColumns","alignItems","gap","authFetch","url","options","token","headers","Authorization","res","fetch","credentials","status","console","warn","text","window","location","assign","Error","BrowseRequestsModal","open","onClose","items","loading","onRefresh","navigate","role","style","position","inset","background","placeItems","zIndex","onClick","children","className","width","maxHeight","overflow","e","stopPropagation","justifyContent","margin","fileName","_jsxFileName","lineNumber","columnNumber","marginTop","length","map","r","marginBottom","padding","border","borrowerName","amount","createdAt","Date","toLocaleDateString","justifySelf","id","title","_c","OpenRequestRow","req","isExpanded","onView","actionLoading","submitCounter","acceptRequest","declineRequest","_s","_req$status","proposal","setProposal","months","duration","interestRate","isLending","lockAmount","type","canAccept","counterpartyName","marginLeft","color","fontWeight","isFinite","purpose","flexWrap","min","value","onChange","p","target","disabled","readOnly","apr","opacity","cursor","_c2","MoneySummary","_s2","summary","setSummary","loansGiven","loansReceived","myOpenRequests","setLoading","expandedLoans","setExpandedLoans","openSec","setOpenSec","given","received","payLoading","setPayLoading","setActionLoading","profileUserId","setProfileUserId","threadLoanId","setThreadLoanId","browseOpen","setBrowseOpen","browseLoading","setBrowseLoading","browseItems","setBrowseItems","fetchMarketOpenRequests","me","ok","raw","json","list","Array","isArray","_req$borrower","_req$borrower2","_req$duration","_req$interestRate","_req$lender","_req$lender2","borrowerId","borrower","iAmBorrower","String","name","lenderName","lender","filter","it","_it$borrower","_req$duration2","_req$interestRate2","_req$borrower3","_req$borrower4","_req$lender3","_req$lender4","fetchDirectOpenRequests","rows","d","_d$borrower","_d$lender","_d$lender2","_d$borrower2","_d$months","_d$apr","_d$borrower3","_d$lender3","lenderId","fetchOtherUsersMarketRequests","_it$borrower2","mapped","_it$duration","_it$borrower3","openBrowse","fetchSummary","data","loansAsLender","loansAsBorrower","marketOpen","directOpen","Promise","all","sort","a","b","ta","getTime","tb","err","error","loanKey","loan","idx","_id","toggleLoanDetails","prev","Object","keys","reduce","acc","k","payNext","_loan$installmentAmou","key","installmentAmount","confirm","m","method","paid","alert","message","actionPaths","market","accept","decline","counter","direct","tryVerbs","body","optionsBase","stringify","undefined","verbs","lastErr","txt","catch","statusText","callAction","which","_actionPaths$type","_actionPaths$type$whi","_ref","_body$amount","_ref2","_body$months","_ref3","_body$duration","_ref4","_body$interestRate","_ref5","_body$apr","urls","call","supersetBody","lastError","renderLoanCard","isLender","otherParty","canPay","nextDueDate","badgeClass","toUpperCase","fundedDate","amountCollected","myOpen","s","loanId","_c3","$RefreshReg$"],"sources":["/Users/alabamalewis/Desktop/PeerFund/p2p_contract_frontend/src/features/dashboard/MoneySummary.jsx"],"sourcesContent":["// src/features/money/MoneySummary.jsx\r\nimport React, { useEffect, useState, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport './MoneySummary.css';\r\nimport UserProfileModal from '../../components/UserProfileModal';\r\nimport LoanThreadModal from '../loans/LoanThreadModal';\r\n\r\n// helper: decode JWT for current user id\r\nfunction getCurrentUserId() {\r\n  const t = localStorage.getItem('token');\r\n  if (!t) return null;\r\n  try {\r\n    const payload = JSON.parse(atob(t.split('.')[1] || ''));\r\n    return payload?.userId ?? null;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nconst fmtMoney = (n) =>\r\n  typeof n === 'number' && !Number.isNaN(n) ? `$${n.toFixed(2)}` : 'â€”';\r\n\r\n// One-line row layout used across all sections\r\nconst ROW_GRID = {\r\n  display: 'grid',\r\n  gridTemplateColumns: 'minmax(160px,1fr) 140px 180px auto auto',\r\n  alignItems: 'center',\r\n  gap: 16,\r\n};\r\n\r\n/* ----------------------- authFetch: token + cookies ----------------------- */\r\nasync function authFetch(url, options = {}) {\r\n  const token = localStorage.getItem('token');\r\n  const headers = {\r\n    ...(options.headers || {}),\r\n    ...(token ? { Authorization: `Bearer ${token}` } : {}),\r\n  };\r\n  const res = await fetch(url, {\r\n    ...options,\r\n    headers,\r\n    credentials: 'include',\r\n  });\r\n  if (res.status === 401) {\r\n    try {\r\n      console.warn('401 on', url, await res.text());\r\n    } catch {}\r\n    window.location.assign('/login');\r\n    throw new Error('Unauthorized');\r\n  }\r\n  return res;\r\n}\r\n\r\n/* -------------------------- Browse Modal (market) ------------------------- */\r\nfunction BrowseRequestsModal({ open, onClose, items, loading, onRefresh, navigate }) {\r\n  if (!open) return null;\r\n  return (\r\n    <div\r\n      role=\"dialog\"\r\n      aria-modal=\"true\"\r\n      style={{\r\n        position: 'fixed',\r\n        inset: 0,\r\n        background: 'rgba(15,23,42,0.45)',\r\n        display: 'grid',\r\n        placeItems: 'center',\r\n        zIndex: 50,\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        className=\"ms-card\"\r\n        style={{ width: 'min(900px, 92vw)', maxHeight: '82vh', overflow: 'auto' }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n          <h3 className=\"ms-subheading\" style={{ margin: 0 }}>Browse Open Requests</h3>\r\n          <div style={{ display: 'flex', gap: 8 }}>\r\n            <button className=\"action-btn\" onClick={onRefresh}>Refresh</button>\r\n            <button className=\"action-btn\" onClick={onClose}>Close</button>\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ marginTop: 12 }}>\r\n          {loading ? (\r\n            <p className=\"ms-empty\">Loading open requestsâ€¦</p>\r\n          ) : items.length === 0 ? (\r\n            <p className=\"ms-empty\">No open requests from other users right now.</p>\r\n          ) : (\r\n            items.map((r) => (\r\n              <div\r\n                key={r.id}\r\n                className=\"ms-card\"\r\n                style={{ marginBottom: 10, padding: 12, border: '1px solid var(--ring)' }}\r\n              >\r\n                <div className=\"ms-card-row\" style={ROW_GRID}>\r\n                  <div>\r\n                    <div className=\"ms-label\">Borrower</div>\r\n                    <div className=\"ms-value-strong\">{r.borrowerName || 'Borrower'}</div>\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"ms-label\">Amount</div>\r\n                    <div className=\"ms-value-strong\">{fmtMoney(r.amount)}</div>\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"ms-label\">Created</div>\r\n                    <div className=\"ms-value-strong\">\r\n                      {r.createdAt ? new Date(r.createdAt).toLocaleDateString() : 'â€”'}\r\n                    </div>\r\n                  </div>\r\n                  <div style={{ justifySelf: 'end' }}>\r\n                    <span className=\"ms-badge ms-badge--warn\">Open</span>\r\n                  </div>\r\n                  <div style={{ justifySelf: 'end' }}>\r\n                    <button\r\n                      className=\"action-btn primary\"\r\n                      onClick={() => navigate(`/loan/${r.id}`)}\r\n                      title=\"Open request details to submit an offer\"\r\n                    >\r\n                      Open\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ---------- Child row (shows controls only when you're the lender) ---------- */\r\nfunction OpenRequestRow({\r\n  req,\r\n  isExpanded,\r\n  onView,         // decides how to handle \"View\" click\r\n  actionLoading,\r\n  submitCounter,\r\n  acceptRequest,\r\n  declineRequest,\r\n}) {\r\n  const [proposal, setProposal] = useState({\r\n    amount: req.amount || 0,\r\n    months: req.duration || 1,\r\n    interestRate: req.interestRate || 0,\r\n  });\r\n\r\n  const isLending = req.role === 'Lending';\r\n  const lockAmount = req.type === 'market'; // market amount locked\r\n  const canAccept = isLending;              // only lender can accept\r\n\r\n  return (\r\n    <div className=\"ms-card\" key={req.id}>\r\n      <div className=\"ms-card-row\" style={ROW_GRID}>\r\n        <div>\r\n          <div className=\"ms-label\">Counterparty</div>\r\n          <div className=\"ms-value-strong\">\r\n            {req.counterpartyName || 'Unknown'}\r\n            <span style={{ marginLeft: 8, color: '#64748b', fontWeight: 600 }}>\r\n              â€¢ {req.role}\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <div className=\"ms-label\">Amount</div>\r\n          <div className=\"ms-value-strong\">{fmtMoney(req.amount)}</div>\r\n        </div>\r\n        <div>\r\n          <div className=\"ms-label\">Created</div>\r\n          <div className=\"ms-value-strong\">\r\n            {req.createdAt ? new Date(req.createdAt).toLocaleDateString() : 'â€”'}\r\n          </div>\r\n        </div>\r\n        <div style={{ justifySelf: 'end' }}>\r\n          <span className=\"ms-badge ms-badge--warn\">Open</span>\r\n        </div>\r\n        <div style={{ justifySelf: 'end' }}>\r\n          <button className=\"action-btn\" onClick={onView} title=\"View request\">\r\n            {isExpanded ? 'ðŸ”½ Hide' : 'ðŸ“„ View'}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* DETAILS */}\r\n      {isExpanded && (\r\n        <div className=\"ms-details\">\r\n          <p className=\"mt-6\">\r\n            <strong>Your role:</strong> {req.role}\r\n          </p>\r\n          <p className=\"mt-6\">\r\n            <strong>Status:</strong> {req.status ?? 'OPEN'}\r\n          </p>\r\n          <p className=\"mt-6\">\r\n            <strong>Interest Rate:</strong>{' '}\r\n            {Number.isFinite(req.interestRate) ? `${req.interestRate}%` : 'â€”'}\r\n          </p>\r\n          <p className=\"mt-6\">\r\n            <strong>Duration:</strong>{' '}\r\n            {Number.isFinite(req.duration) ? `${req.duration} months` : 'â€”'}\r\n          </p>\r\n          {req.purpose ? (\r\n            <p className=\"mt-6\"><strong>Reason:</strong> {req.purpose}</p>\r\n          ) : null}\r\n\r\n          {/* Lender-only controls */}\r\n          {isLending ? (\r\n            <div className=\"mt-8\" style={{ display: 'flex', flexWrap: 'wrap', gap: 10 }}>\r\n              <div>\r\n                <label className=\"ms-label\">Amount</label>\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"1\"\r\n                  className=\"auth-input\"\r\n                  value={lockAmount ? req.amount : proposal.amount}\r\n                  onChange={(e) =>\r\n                    setProposal((p) => ({ ...p, amount: Number(e.target.value) }))\r\n                  }\r\n                  style={{ width: 140 }}\r\n                  disabled={lockAmount}\r\n                  readOnly={lockAmount}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"ms-label\">APR %</label>\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  className=\"auth-input\"\r\n                  value={proposal.interestRate}\r\n                  onChange={(e) =>\r\n                    setProposal((p) => ({ ...p, interestRate: Number(e.target.value) }))\r\n                  }\r\n                  style={{ width: 120 }}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"ms-label\">Months</label>\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"1\"\r\n                  className=\"auth-input\"\r\n                  value={proposal.months}\r\n                  onChange={(e) =>\r\n                    setProposal((p) => ({ ...p, months: Number(e.target.value) }))\r\n                  }\r\n                  style={{ width: 120 }}\r\n                />\r\n              </div>\r\n\r\n              <div style={{ marginLeft: 'auto', display: 'flex', gap: 8 }}>\r\n                <button\r\n                  className=\"action-btn\"\r\n                  onClick={() =>\r\n                    submitCounter(\r\n                      req,\r\n                      req.type === 'direct'\r\n                        ? {\r\n                            amount: proposal.amount,\r\n                            apr: proposal.interestRate,\r\n                            months: proposal.months,\r\n                          }\r\n                        : {\r\n                            amount: lockAmount ? req.amount : proposal.amount,\r\n                            interestRate: proposal.interestRate,\r\n                            months: proposal.months,\r\n                          }\r\n                    )\r\n                  }\r\n                  disabled={!!actionLoading[req.id]}\r\n                >\r\n                  {actionLoading[req.id] ? 'Savingâ€¦' : 'Make Counter-Offer'}\r\n                </button>\r\n\r\n                <button\r\n                  className=\"action-btn primary\"\r\n                  onClick={() => canAccept && acceptRequest(req)}\r\n                  disabled={!!actionLoading[req.id] || !canAccept}\r\n                  style={(!canAccept || actionLoading[req.id]) ? { opacity: 0.5, cursor: 'not-allowed' } : {}}\r\n                  title={canAccept ? 'Accept this request' : 'Only the lender can accept'}\r\n                >\r\n                  {actionLoading[req.id] ? 'Workingâ€¦' : 'Accept'}\r\n                </button>\r\n\r\n                <button\r\n                  className=\"action-btn\"\r\n                  onClick={() => declineRequest(req)}\r\n                  disabled={!!actionLoading[req.id]}\r\n                >\r\n                  {actionLoading[req.id] ? 'Workingâ€¦' : 'Decline'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <p className=\"mt-8\" style={{ color: 'var(--muted)' }}>\r\n              This is one of your own requests. To lend to someone else, click <em>View</em> to browse\r\n              other usersâ€™ open requests.\r\n            </p>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n/* -------------------------------- Parent -------------------------------- */\r\n\r\nconst MoneySummary = () => {\r\n  const [summary, setSummary] = useState({\r\n    loansGiven: [],\r\n    loansReceived: [],\r\n    myOpenRequests: [],\r\n  });\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [expandedLoans, setExpandedLoans] = useState({});\r\n  const [openSec, setOpenSec] = useState({ open: true, given: true, received: true });\r\n\r\n  const [payLoading, setPayLoading] = useState({});\r\n  const [actionLoading, setActionLoading] = useState({});\r\n  const [profileUserId, setProfileUserId] = useState(null);\r\n  const [threadLoanId, setThreadLoanId] = useState(null);\r\n\r\n  // browse modal state\r\n  const [browseOpen, setBrowseOpen] = useState(false);\r\n  const [browseLoading, setBrowseLoading] = useState(false);\r\n  const [browseItems, setBrowseItems] = useState([]);\r\n\r\n  const navigate = useNavigate();\r\n\r\n  /* ------------------ Fetch helpers (market + direct) ------------------ */\r\n\r\n  // All OPEN market requests, mapped to Borrowing/Lending role\r\n  const fetchMarketOpenRequests = async () => {\r\n    const me = getCurrentUserId();\r\n    if (!me) return [];\r\n\r\n    try {\r\n      const r = await authFetch('/api/loan-requests/open');\r\n      if (r.ok) {\r\n        const raw = await r.json();\r\n        const list = Array.isArray(raw) ? raw : raw?.items || [];\r\n        return list.map((req) => {\r\n          const borrowerId = req.borrowerId || req?.borrower?.id;\r\n          const iAmBorrower = String(borrowerId) === String(me);\r\n          const borrowerName = req?.borrower?.name || (iAmBorrower ? 'You' : 'Borrower');\r\n          return {\r\n            type: 'market',\r\n            id: req.id,\r\n            amount: Number(req.amount),\r\n            duration: Number(req.duration ?? req.months),\r\n            interestRate: Number(req.interestRate ?? req.apr),\r\n            purpose: req.purpose || '',\r\n            createdAt: req.createdAt || null,\r\n            borrowerId,\r\n            borrowerName,\r\n            lenderName: req?.lender?.name || '',\r\n            counterpartyName: iAmBorrower ? (req?.lender?.name || 'â€”') : borrowerName,\r\n            role: iAmBorrower ? 'Borrowing' : 'Lending',\r\n            status: req.status || 'OPEN',\r\n          };\r\n        });\r\n      }\r\n    } catch {}\r\n\r\n    // fallback (borrower-only)\r\n    try {\r\n      const r = await authFetch('/api/loan-requests/mine?status=OPEN');\r\n      if (r.ok) {\r\n        const list = await r.json();\r\n        const items = Array.isArray(list) ? list : Array.isArray(list?.items) ? list.items : [];\r\n        return items\r\n          .filter((it) => (it?.borrowerId || it?.borrower?.id) === me)\r\n          .map((req) => ({\r\n            type: 'market',\r\n            id: req.id,\r\n            amount: Number(req.amount),\r\n            duration: Number(req.duration ?? req.months),\r\n            interestRate: Number(req.interestRate ?? req.apr),\r\n            purpose: req.purpose || '',\r\n            createdAt: req.createdAt || null,\r\n            borrowerName: req?.borrower?.name || 'You',\r\n            borrowerId: req?.borrower?.id || req.borrowerId || me,\r\n            lenderName: req?.lender?.name || '',\r\n            counterpartyName: req?.lender?.name || 'â€”',\r\n            role: 'Borrowing',\r\n            status: req.status || 'OPEN',\r\n          }));\r\n      }\r\n    } catch {}\r\n\r\n    return [];\r\n  };\r\n\r\n  // DIRECT requests (both roles) from consolidated backend view\r\n  const fetchDirectOpenRequests = async () => {\r\n    const me = getCurrentUserId();\r\n    if (!me) return [];\r\n\r\n    try {\r\n      const r = await authFetch('/api/direct-requests/open/mine');\r\n      if (!r.ok) return [];\r\n      const rows = await r.json();\r\n\r\n      return (Array.isArray(rows) ? rows : []).map((d) => {\r\n        const borrowerId = d.borrowerId || d?.borrower?.id;\r\n        const lenderId = d.lenderId || d?.lender?.id;\r\n        const iAmBorrower = String(borrowerId) === String(me);\r\n        const role = iAmBorrower ? 'Borrowing' : 'Lending';\r\n        const counterpartyName = iAmBorrower\r\n          ? d?.lender?.name || 'Lender'\r\n          : d?.borrower?.name || 'Borrower';\r\n\r\n        return {\r\n          type: 'direct',\r\n          id: d.id,\r\n          amount: Number(d.amount),\r\n          duration: Number(d.months ?? d.duration),\r\n          interestRate: Number(d.apr ?? d.interestRate),\r\n          createdAt: d.createdAt || null,\r\n          borrowerId,\r\n          borrowerName: d?.borrower?.name || (iAmBorrower ? 'You' : ''),\r\n          lenderId,\r\n          lenderName: d?.lender?.name || (!iAmBorrower ? 'You' : ''),\r\n          counterpartyName,\r\n          role,\r\n          status: d.status || 'PENDING',\r\n        };\r\n      });\r\n    } catch {\r\n      return [];\r\n    }\r\n  };\r\n\r\n  // What the browse modal shows: market requests from other users\r\n  const fetchOtherUsersMarketRequests = async () => {\r\n    const me = getCurrentUserId();\r\n    setBrowseLoading(true);\r\n    try {\r\n      const r = await authFetch('/api/loan-requests/open');\r\n      const raw = r.ok ? await r.json() : [];\r\n      const items = (Array.isArray(raw) ? raw : raw?.items || []).filter((it) => {\r\n        const borrowerId = it.borrowerId || it?.borrower?.id;\r\n        return borrowerId && String(borrowerId) !== String(me);\r\n      });\r\n      const mapped = items.map((it) => ({\r\n        id: it.id,\r\n        amount: Number(it.amount),\r\n        duration: Number(it.duration ?? it.months),\r\n        createdAt: it.createdAt || null,\r\n        borrowerName: it?.borrower?.name || 'Borrower',\r\n      }));\r\n      setBrowseItems(mapped);\r\n    } catch {\r\n      setBrowseItems([]);\r\n    } finally {\r\n      setBrowseLoading(false);\r\n    }\r\n  };\r\n\r\n  const openBrowse = async () => {\r\n    setBrowseOpen(true);\r\n    await fetchOtherUsersMarketRequests();\r\n  };\r\n\r\n  const fetchSummary = useCallback(async () => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) return;\r\n    setLoading(true);\r\n    try {\r\n      const res = await authFetch('/api/users/my-money-summary');\r\n      let loansGiven = [];\r\n      let loansReceived = [];\r\n      if (res.ok) {\r\n        const data = await res.json();\r\n        loansGiven = Array.isArray(data.loansGiven)\r\n          ? data.loansGiven\r\n          : Array.isArray(data.loansAsLender)\r\n          ? data.loansAsLender\r\n          : [];\r\n        loansReceived = Array.isArray(data.loansReceived)\r\n          ? data.loansReceived\r\n          : Array.isArray(data.loansAsBorrower)\r\n          ? data.loansAsBorrower\r\n          : [];\r\n      }\r\n\r\n      const [marketOpen, directOpen] = await Promise.all([\r\n        fetchMarketOpenRequests(),\r\n        fetchDirectOpenRequests(),\r\n      ]);\r\n\r\n      const myOpenRequests = [...marketOpen, ...directOpen].sort((a, b) => {\r\n        if (a.role === 'Lending' && b.role !== 'Lending') return -1;\r\n        if (b.role === 'Lending' && a.role !== 'Lending') return 1;\r\n        const ta = a.createdAt ? new Date(a.createdAt).getTime() : 0;\r\n        const tb = b.createdAt ? new Date(b.createdAt).getTime() : 0;\r\n        return tb - ta;\r\n      });\r\n\r\n      setSummary({ loansGiven, loansReceived, myOpenRequests });\r\n    } catch (err) {\r\n      console.error('Error fetching money summary:', err);\r\n      setSummary({ loansGiven: [], loansReceived: [], myOpenRequests: [] });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    fetchSummary();\r\n  }, [fetchSummary]);\r\n\r\n  const loanKey = (loan, idx) => loan?.id || loan?._id || String(idx);\r\n\r\n  const toggleLoanDetails = (id) => {\r\n    setExpandedLoans((prev) => ({\r\n      ...(Object.keys(prev).reduce((acc, k) => ({ ...acc, [k]: false }), {})),\r\n      [id]: !prev[id],\r\n    }));\r\n  };\r\n\r\n  const payNext = async (loan) => {\r\n    const key = loanKey(loan);\r\n    const amount = loan?.installmentAmount ?? 0;\r\n    if (!window.confirm(`Pay the next installment (${fmtMoney(amount)})?`)) return;\r\n    try {\r\n      setPayLoading((m) => ({ ...m, [key]: true }));\r\n      const res = await authFetch(`/api/loans/${loan.id || loan._id}/pay-next`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n      });\r\n      const data = await res.json();\r\n      if (!res.ok) throw new Error(data?.error || 'Payment failed');\r\n      const paid = typeof data.amount === 'number' ? data.amount : amount;\r\n      alert(`Payment successful! Amount: ${fmtMoney(paid)}`);\r\n      await fetchSummary();\r\n    } catch (e) {\r\n      alert(e.message);\r\n    } finally {\r\n      setPayLoading((m) => ({ ...m, [key]: false }));\r\n    }\r\n  };\r\n\r\n  /* -------------------- Action endpoints + helpers -------------------- */\r\n\r\n  const actionPaths = {\r\n    market: {\r\n      accept: (id) => [\r\n        `/api/loan-requests/${id}/accept`,\r\n        `/api/loan-requests/${id}/approve`,\r\n        `/api/loan-requests/${id}/respond?action=ACCEPT`,\r\n      ],\r\n      decline: (id) => [\r\n        `/api/loan-requests/${id}/decline`,\r\n        `/api/loan-requests/${id}/reject`,\r\n        `/api/loan-requests/${id}/respond?action=DECLINE`,\r\n      ],\r\n      counter: (id) => [\r\n        `/api/loan-requests/${id}/counter-offer`,\r\n        `/api/loan-requests/${id}/counter`,\r\n        `/api/loan-requests/${id}/respond?action=COUNTER`,\r\n      ],\r\n    },\r\n    direct: {\r\n      accept: (id) => [\r\n        `/api/direct-requests/${id}/accept`,\r\n        `/api/direct-requests/${id}/approve`,\r\n        `/api/direct-requests/${id}/respond?action=ACCEPT`,\r\n      ],\r\n      decline: (id) => [\r\n        `/api/direct-requests/${id}/decline`,\r\n        `/api/direct-requests/${id}/reject`,\r\n        `/api/direct-requests/${id}/respond?action=DECLINE`,\r\n      ],\r\n      counter: (id) => [\r\n        `/api/direct-requests/${id}/counter-offer`,\r\n        `/api/direct-requests/${id}/counter`,\r\n        `/api/direct-requests/${id}/respond?action=COUNTER`,\r\n      ],\r\n    },\r\n  };\r\n\r\n  async function tryVerbs(url, body) {\r\n    const optionsBase = {\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: body ? JSON.stringify(body) : undefined,\r\n    };\r\n    const verbs = ['POST', 'PUT', 'PATCH'];\r\n    let lastErr = null;\r\n    for (const method of verbs) {\r\n      try {\r\n        const r = await authFetch(url, { method, ...optionsBase });\r\n        if (r.ok) return r;\r\n        const txt = await r.text().catch(() => '');\r\n        lastErr = new Error(`${r.status} ${r.statusText}${txt ? ` â€¢ ${txt}` : ''}`);\r\n      } catch (e) {\r\n        lastErr = e;\r\n      }\r\n    }\r\n    throw lastErr || new Error('All methods failed');\r\n  }\r\n\r\n  const callAction = async (type, id, which, body) => {\r\n    setActionLoading((m) => ({ ...m, [id]: true }));\r\n    try {\r\n      const urls = actionPaths[type]?.[which]?.(id) || [];\r\n      if (!urls.length) throw new Error(`Unknown action: ${type}.${which}`);\r\n\r\n      const supersetBody = body\r\n        ? {\r\n            ...body,\r\n            amount: body.amount ?? body.value ?? undefined,\r\n            months: body.months ?? body.duration ?? undefined,\r\n            duration: body.duration ?? body.months ?? undefined,\r\n            interestRate: body.interestRate ?? body.apr ?? undefined,\r\n            apr: body.apr ?? body.interestRate ?? undefined,\r\n          }\r\n        : undefined;\r\n\r\n      let ok = false;\r\n      let lastError = null;\r\n\r\n      for (const url of urls) {\r\n        try {\r\n          await tryVerbs(url, supersetBody);\r\n          ok = true;\r\n          break;\r\n        } catch (e) {\r\n          lastError = e;\r\n        }\r\n      }\r\n\r\n      if (!ok) throw lastError || new Error('No endpoint accepted this action');\r\n      await fetchSummary();\r\n    } catch (e) {\r\n      console.error(e);\r\n      alert(`Action failed:\\n${e.message || e}`);\r\n    } finally {\r\n      setActionLoading((m) => ({ ...m, [id]: false }));\r\n    }\r\n  };\r\n\r\n  const acceptRequest  = (req) => callAction(req.type, req.id, 'accept');\r\n  const declineRequest = (req) => callAction(req.type, req.id, 'decline');\r\n  const submitCounter  = (req, proposal) => callAction(req.type, req.id, 'counter', proposal);\r\n\r\n  /* ------------------------------- Renderers ------------------------------- */\r\n\r\n  const renderLoanCard = (loan, isLender, idx) => {\r\n    const key = loanKey(loan, idx);\r\n    const isExpanded = !!expandedLoans[key];\r\n    const otherParty = isLender ? loan.borrowerName : loan.lenderName;\r\n\r\n    const canPay =\r\n      !isLender &&\r\n      typeof loan.installmentAmount === 'number' &&\r\n      loan.installmentAmount > 0 &&\r\n      !!loan.nextDueDate;\r\n\r\n    const badgeClass =\r\n      (loan.status || '').toUpperCase() === 'FUNDED'\r\n        ? 'ms-badge ms-badge--ok'\r\n        : 'ms-badge ms-badge--warn';\r\n\r\n    const fundedDate =\r\n      loan.fundedDate ? new Date(loan.fundedDate).toLocaleDateString() : 'â€”';\r\n\r\n    return (\r\n      <div className=\"ms-card\" key={key}>\r\n        <div className=\"ms-card-row\" style={ROW_GRID}>\r\n          <div>\r\n            <div className=\"ms-label\">{isLender ? 'Borrower' : 'Lender'}</div>\r\n            <div className=\"ms-value-strong\">{otherParty || 'Unknown'}</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"ms-label\">Amount</div>\r\n            <div className=\"ms-value-strong\">{fmtMoney(loan.amount)}</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"ms-label\">Funded Date</div>\r\n            <div className=\"ms-value-strong\">{fundedDate}</div>\r\n          </div>\r\n          <div style={{ justifySelf: 'end' }}>\r\n            <span className={badgeClass}>{loan.status || 'â€”'}</span>\r\n          </div>\r\n          <div style={{ justifySelf: 'end', display: 'flex', gap: 8 }}>\r\n            <button\r\n              onClick={() => setThreadLoanId(loan.id || loan._id)}\r\n              className=\"action-btn\"\r\n              title=\"Open conversation\"\r\n            >\r\n              ðŸ’¬ Messages\r\n            </button>\r\n            <button onClick={() => toggleLoanDetails(key)} className=\"action-btn\" title=\"View contract\">\r\n              {isExpanded ? 'ðŸ”½ Hide' : 'ðŸ“„ View'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {isExpanded && (\r\n          <div className=\"ms-details\">\r\n            {loan.status && (\r\n              <p className=\"mt-6\">\r\n                <strong>Status:</strong> {loan.status}\r\n              </p>\r\n            )}\r\n            <p className=\"mt-6\">\r\n              <strong>Interest Rate:</strong>{' '}\r\n              {typeof loan.interestRate === 'number' ? `${loan.interestRate}%` : 'â€”'}\r\n            </p>\r\n            <p className=\"mt-6\">\r\n              <strong>Duration:</strong>{' '}\r\n              {typeof loan.duration === 'number' ? `${loan.duration} months` : 'â€”'}\r\n            </p>\r\n            <p className=\"mt-6\">\r\n              <strong>Next Due Date:</strong>{' '}\r\n              {loan.nextDueDate ? new Date(loan.nextDueDate).toLocaleDateString() : 'â€”'}\r\n            </p>\r\n            <p className=\"mt-6\">\r\n              <strong>Installment (this period):</strong> {fmtMoney(loan.installmentAmount)}\r\n            </p>\r\n\r\n            {isLender && typeof loan.amountCollected === 'number' && (\r\n              <p className=\"mt-6\">\r\n                <strong>Amount collected on loan:</strong> {fmtMoney(loan.amountCollected)}\r\n              </p>\r\n            )}\r\n\r\n            {!isLender && canPay && (\r\n              <div className=\"mt-6\">\r\n                <button\r\n                  className=\"action-btn primary\"\r\n                  onClick={() => payNext(loan)}\r\n                  disabled={!!payLoading[key]}\r\n                  title=\"Pay next installment\"\r\n                >\r\n                  {payLoading[key] ? 'Processingâ€¦' : 'ðŸ’³ Make Payment'}\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  /* ------------------------------- Render ------------------------------- */\r\n\r\n  if (loading) return <p className=\"ms-loading ms-container\">Loading money summary...</p>;\r\n\r\n  const given    = Array.isArray(summary.loansGiven) ? summary.loansGiven : [];\r\n  const received = Array.isArray(summary.loansReceived) ? summary.loansReceived : [];\r\n  const myOpen   = Array.isArray(summary.myOpenRequests) ? summary.myOpenRequests : [];\r\n\r\n  return (\r\n    <div className=\"ms-container\">\r\n      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n        <h2 className=\"ms-heading\">ðŸ’µ My Money Summary</h2>\r\n        <button className=\"action-btn\" onClick={openBrowse} title=\"See open requests from others\">\r\n          Browse Open Requests\r\n        </button>\r\n      </div>\r\n\r\n      {/* Section: Open Requests */}\r\n      <div className=\"ms-section\">\r\n        <button\r\n          className=\"ms-section-head\"\r\n          onClick={() => setOpenSec((s) => ({ ...s, open: !s.open }))}\r\n          aria-expanded={openSec.open}\r\n        >\r\n          <div className=\"ms-subheading\">My Open Loan Requests</div>\r\n          <div className=\"ms-caret\">{openSec.open ? 'â–¾' : 'â–¸'}</div>\r\n        </button>\r\n        {openSec.open && (\r\n          <div className=\"ms-section-body\">\r\n            {myOpen.length === 0 ? (\r\n              <p className=\"ms-empty\">You have no open requests.</p>\r\n            ) : (\r\n              myOpen.map((req) => (\r\n                <OpenRequestRow\r\n                  key={req.id}\r\n                  req={req}\r\n                  isExpanded={!!expandedLoans[req.id]}\r\n                  onView={() => (req.role === 'Borrowing' ? openBrowse() : toggleLoanDetails(req.id))}\r\n                  actionLoading={actionLoading}\r\n                  submitCounter={submitCounter}\r\n                  acceptRequest={acceptRequest}\r\n                  declineRequest={declineRequest}\r\n                />\r\n              ))\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Section: Loans Given */}\r\n      <div className=\"ms-section\">\r\n        <button\r\n          className=\"ms-section-head\"\r\n          onClick={() => setOpenSec((s) => ({ ...s, given: !s.given }))}\r\n          aria-expanded={openSec.given}\r\n        >\r\n          <div className=\"ms-subheading\">Loans Given (I'm the Lender)</div>\r\n          <div className=\"ms-caret\">{openSec.given ? 'â–¾' : 'â–¸'}</div>\r\n        </button>\r\n        {openSec.given && (\r\n          <div className=\"ms-section-body\">\r\n            {given.length === 0 ? (\r\n              <p className=\"ms-empty\">No loans given yet.</p>\r\n            ) : (\r\n              given.map((loan, idx) => renderLoanCard(loan, true, idx))\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Section: Loans Received */}\r\n      <div className=\"ms-section\">\r\n        <button\r\n          className=\"ms-section-head\"\r\n          onClick={() => setOpenSec((s) => ({ ...s, received: !s.received }))}\r\n          aria-expanded={openSec.received}\r\n        >\r\n          <div className=\"ms-subheading\">Loans Received (I'm the Borrower)</div>\r\n          <div className=\"ms-caret\">{openSec.received ? 'â–¾' : 'â–¸'}</div>\r\n        </button>\r\n        {openSec.received && (\r\n          <div className=\"ms-section-body\">\r\n            {received.length === 0 ? (\r\n              <p className=\"ms-empty\">No loans received yet.</p>\r\n            ) : (\r\n              received.map((loan, idx) => renderLoanCard(loan, false, idx))\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Modals */}\r\n      {profileUserId && (\r\n        <UserProfileModal userId={profileUserId} onClose={() => setProfileUserId(null)} />\r\n      )}\r\n      {threadLoanId && (\r\n        <LoanThreadModal loanId={threadLoanId} onClose={() => setThreadLoanId(null)} />\r\n      )}\r\n\r\n      <BrowseRequestsModal\r\n        open={browseOpen}\r\n        onClose={() => setBrowseOpen(false)}\r\n        items={browseItems}\r\n        loading={browseLoading}\r\n        onRefresh={fetchOtherUsersMarketRequests}\r\n        navigate={navigate}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MoneySummary;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}